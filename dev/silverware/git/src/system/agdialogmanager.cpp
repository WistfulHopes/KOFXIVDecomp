#include "program files (x86)/microsoft visual studio 14.0/vc/include/xtr1common"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/string"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vcruntime_typeinfo.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/stdlib.h"
#include "dev/silverware/git/sdk/filesystem/agdirectory.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/ios"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xlocnum"
#include "dev/silverware/git/sdk/memory/agbuffer.h"
#include "dev/silverware/git/sdk/agstream.h"
#include "dev/silverware/git/sdk/memory/agallocators.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/stdexcept"
#include "dev/silverware/git/sdk/system/agsystemmanager.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/exception"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/type_traits"
#include "dev/silverware/git/sdk/system/agsystemconfig.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xtree"
#include "dev/silverware/git/sdk/util/agjsondata.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/thr/xthread"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xstddef"
#include "dev/silverware/git/sdk/agreferencecount.h"
#include "dev/silverware/git/sdk/system/agusermanager.h"
#include "dev/silverware/git/sdk/util/ageventdispatcher.h"
#include "dev/silverware/git/sdk/agmutex.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xatomic0.h"
#include "dev/silverware/git/sdk/agscopedlock.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/system_error"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wio.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wstring.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/map"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/tuple"
#include "dev/silverware/git/sdk/input/agcontrollercomponent.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xutility"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/utility"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/thread"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/time.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/memory"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/iosfwd"
#include "dev/silverware/git/sdk/util/agdebugchannels.h"
#include "dev/silverware/git/sdk/util/agperformancecounter.h"
#include "dev/silverware/git/sdk/agclock.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xlocinfo"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/mutex"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/chrono"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xiosbase"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/ctype.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xlocale"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/string.h"
#include "dev/silverware/git/sdk/system/agsysteminfo.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_memory.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_memcpy_s.h"
#include "dev/silverware/git/sdk/agthreadpool.h"
#include "dev/silverware/git/sdk/agcondition.inl"
#include "dev/silverware/git/sdk/agreferencecountinl.h"
#include "dev/silverware/git/sdk/util/agservice.h"
#include "dev/silverware/git/sdk/agsemaphore.h"
#include "dev/silverware/git/sdk/agmath.h"
#include "dev/silverware/git/sdk/agthread.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vector"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/malloc.h"
#include "dev/silverware/git/sdk/filesystem/agfile.h"
#include "dev/silverware/git/sdk/agcondition.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/cmath"
#include "dev/silverware/git/sdk/util/agservicecommand.inl"
#include "dev/silverware/git/sdk/agconditionvariable.h"
#include "dev/silverware/git/sdk/platforms/pc/system/agpcsysteminfo.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/math.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/condition_variable"
#include "dev/silverware/git/sdk/filesystem/agmount.h"
#include "dev/silverware/git/sdk/agmemorypool.h"
#include "dev/silverware/git/sdk/filesystem/agpath.h"
#include "dev/silverware/git/sdk/agmutex.inl"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/sys/stat.h"
#include "dev/silverware/git/sdk/agpointerinl.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xstring"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xmemory0"
#include "dev/silverware/git/sdk/util/agdelegate.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/stdio.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wstdio.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vcruntime_new.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_stdio_config.h"
#include "dev/silverware/git/sdk/util/agservicecommand.h"
#include "dev/silverware/git/sdk/agreferenceinl.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/wchar.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wconio.h"
#include "dev/silverware/git/sdk/agsingleton.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vcruntime_exception.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/limits"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wtime.h"
#include "dev/silverware/git/sdk/agconditionvariable.inl"
#include "dev/silverware/git/sdk/agsemaphore.inl"
#include "dev/silverware/git/sdk/system/agdialogmanager.h"
#include "dev/silverware/git/sdk/input/agcontroller.h"
#include "dev/silverware/git/sdk/system/aguser.h"
#include "dev/silverware/git/sdk/agreferencedobjectinl.h"
#include "dev/silverware/git/sdk/agpointer.h"
#include "dev/silverware/git/sdk/agreferencedobject.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xfacet"
#include "dev/silverware/git/sdk/util/agworkerpool.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/list"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/functional"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xmemory"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vadefs.h"
#include "dev/silverware/git/sdk/agstring.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xtgmath.h"

std::piecewise_construct_t std::piecewise_construct; // 0x14086AF25
typedef AgDefaultDialogManager AgPlatformDialogManager;
AgDialogManager::AgDialogManager(); // 0x14067FBC0
AgDialogManager::~AgDialogManager(); // 0x14067FCB0
void AgDialogManager::onShutdown(const AgShutdownEvent & evt); // 0x1406801B0
AgPointer<AgDialog> AgDialogManager::showSaveErrorDialog(AgPointer<AgUser> user, const AgMountErrorEvent & error, AgDelegate1<AgPointer<AgDialog>,void> handler); // 0x1406803C0
void AgDialogManager::closeActiveDialog(); // 0x14067FF60
AgDialogManager * AgDialogManager::createSingleton(); // 0x140680120
long AgDialogManager::onSingletonExit(); // 0x1400482A0
AgPointer<AgDialog> AgDialogManager::queueDialog(AgPointer<AgDialog> dialog); // 0x140680300//decompilation failure at 14086AF25!
void __fastcall std::_Destroy_range<std::allocator<AgPointer<AgDialog>>,AgPointer<AgDialog> *>(
        AgPointer<AgDialog> *_First,
        AgPointer<AgDialog> *_Last,
        std::_Wrap_alloc<std::allocator<AgPointer<AgDialog> > > *_Al)
{
  AgPointer<AgDialog> *v4; // rbx

  if ( _First != _Last )
  {
    v4 = _First;
    do
      AgPointer<AgDialog>::~AgPointer<AgDialog>(v4++);
    while ( v4 != _Last );
  }
}

AgPointer<AgDialog> *__fastcall std::_Uninitialized_move_al_unchecked1<AgPointer<AgDialog> *,AgPointer<AgDialog> *,std::allocator<AgPointer<AgDialog>>>(
        AgPointer<AgDialog> *_First,
        AgPointer<AgDialog> *_Last,
        AgPointer<AgDialog> *_Dest,
        std::_Wrap_alloc<std::allocator<AgPointer<AgDialog> > > *_Al)
{
  while ( _First != _Last )
  {
    if ( _Dest )
    {
      *_Dest = *_First;
      _First->m_ref = 0i64;
      _First->m_ptr = 0i64;
    }
    ++_Dest;
    ++_First;
  }
  return _Dest;
}

void __fastcall AgPointer<AgBuffer<AgAllocator<1>>>::AgPointer<AgBuffer<AgAllocator<1>>>(
        AgPointer<AgPlayer> *this,
        const AgPointer<AgPlayer> *rhs)
{
  AgReferenceCount *m_ref; // rsi
  int m_strongCount; // ebx

  this->m_ref = 0i64;
  this->m_ptr = 0i64;
  m_ref = rhs->m_ref;
  if ( rhs->m_ref )
  {
    m_strongCount = m_ref->m_strongCount;
    if ( m_ref->m_strongCount )
    {
      while ( AgAtomicCompareExchange(&m_ref->m_strongCount, m_strongCount, m_strongCount + 1) != m_strongCount )
      {
        m_strongCount = m_ref->m_strongCount;
        if ( !m_ref->m_strongCount )
          return;
      }
      if ( m_strongCount != -1 )
      {
        this->m_ref = rhs->m_ref;
        this->m_ptr = rhs->m_ptr;
      }
    }
  }
}

void __fastcall AgDialogManager::AgDialogManager(AgDialogManager *this)
{
  AgSingleton<AgSystemManager> *v2; // rbx
  AgDelegate1<AgShutdownEvent const &,void> _Val; // [rsp+38h] [rbp-20h] BYREF

  this->__vftable = (AgDialogManager_vtbl *)&AgSingleton<AgDialogManager>::`vftable';
  this->__vftable = (AgDialogManager_vtbl *)&AgDialogManager::`vftable';
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_mutex);
  this->m_activeDialog._Mypair._Myval2._Myfirst = 0i64;
  this->m_activeDialog._Mypair._Myval2._Mylast = 0i64;
  this->m_activeDialog._Mypair._Myval2._Myend = 0i64;
  v2 = AgSingleton<AgSystemManager>::ms_instance + 65;
  _Val.m_Closure.m_pFunction = (void (__fastcall *)(detail::GenericClass *))AgDialogManager::onShutdown;
  _Val.m_Closure.m_pthis = (detail::GenericClass *)this;
  EnterCriticalSection((LPCRITICAL_SECTION)&AgSingleton<AgSystemManager>::ms_instance[65]);
  std::vector<AgDelegate1<AgShutdownEvent const &,void>>::push_back(
    (std::vector<AgDelegate1<AgShutdownEvent const &,void>> *)&v2[5],
    &_Val);
  LeaveCriticalSection((LPCRITICAL_SECTION)v2);
}

void __fastcall AgSingleton<AgDialogManager>::~AgSingleton<AgDialogManager>(AgSingleton<AgDialogManager> *this)
{
  this->__vftable = (AgSingleton<AgDialogManager>_vtbl *)&AgSingleton<AgDialogManager>::`vftable';
}

void __fastcall std::vector<AgPointer<AgDialog>>::~vector<AgPointer<AgDialog>>(std::vector<AgPointer<AgDialog>> *this)
{
  std::vector<AgPointer<AgDialog>>::_Tidy(this);
}

void __fastcall AgDialogManager::~AgDialogManager(AgDialogManager *this)
{
  AgDelegate1<AgShutdownEvent const &,void> v2; // [rsp+28h] [rbp-20h] BYREF

  this->__vftable = (AgDialogManager_vtbl *)&AgDialogManager::`vftable';
  v2.m_Closure.m_pFunction = (void (__fastcall *)(detail::GenericClass *))AgDialogManager::onShutdown;
  v2.m_Closure.m_pthis = (detail::GenericClass *)this;
  AgEventDispatcherBase<AgShutdownEvent>::unbind(
    (AgEventDispatcherBase<AgShutdownEvent> *)&AgSingleton<AgSystemManager>::ms_instance[65],
    &v2);
  std::vector<AgPointer<AgDialog>>::_Tidy(&this->m_activeDialog);
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_mutex);
  this->__vftable = (AgDialogManager_vtbl *)&AgSingleton<AgDialogManager>::`vftable';
}

void __fastcall std::vector<AgPointer<AgDialog>>::_Reallocate(
        std::vector<AgPointer<AgDialog>> *this,
        unsigned __int64 _Count)
{
  AgPointer<AgDialog> *v4; // r12
  AgPointer<AgDialog> *Mylast; // r14
  AgPointer<AgDialog> *Myfirst; // rbx
  signed __int64 v7; // rsi

  v4 = (AgPointer<AgDialog> *)std::allocator<AgDelegate1<AgShutdownEvent const &,void>>::allocate(
                                (std::allocator<AgDelegate1<AgShutdownEvent const &,void> > *)this,
                                _Count);
  std::_Uninitialized_move_al_unchecked1<AgPointer<AgDialog> *,AgPointer<AgDialog> *,std::allocator<AgPointer<AgDialog>>>(
    this->_Mypair._Myval2._Myfirst,
    this->_Mypair._Myval2._Mylast,
    v4,
    (std::_Wrap_alloc<std::allocator<AgPointer<AgDialog> > > *)this);
  Mylast = this->_Mypair._Myval2._Mylast;
  Myfirst = this->_Mypair._Myval2._Myfirst;
  v7 = (char *)Mylast - (char *)this->_Mypair._Myval2._Myfirst;
  if ( this->_Mypair._Myval2._Myfirst )
  {
    for ( ; Myfirst != Mylast; ++Myfirst )
      AgPointer<AgDialog>::~AgPointer<AgDialog>(Myfirst);
    std::_Wrap_alloc<std::allocator<AgDelegate1<AgSuspendingEvent const &,void>>>::deallocate(
      (std::_Wrap_alloc<std::allocator<AgDelegate1<AgUserUpdatedEvent const &,void> > > *)this,
      (AgDelegate1<AgUserUpdatedEvent const &,void> *)this->_Mypair._Myval2._Myfirst,
      this->_Mypair._Myval2._Myend - this->_Mypair._Myval2._Myfirst);
  }
  this->_Mypair._Myval2._Myend = &v4[_Count];
  this->_Mypair._Myval2._Mylast = (AgPointer<AgDialog> *)((char *)v4 + (v7 & 0xFFFFFFFFFFFFFFF0ui64));
  this->_Mypair._Myval2._Myfirst = v4;
}

void __fastcall std::vector<AgPointer<AgDialog>>::_Reserve(
        std::vector<AgPointer<AgDialog>> *this,
        unsigned __int64 _Count)
{
  AgPointer<AgDialog> *Myend; // r10
  AgPointer<AgDialog> *Mylast; // r8
  AgPointer<AgDialog> *Myfirst; // rcx
  __int64 v6; // r8
  unsigned __int64 v7; // rdx
  unsigned __int64 v8; // r10
  unsigned __int64 v9; // rcx

  Myend = this->_Mypair._Myval2._Myend;
  Mylast = this->_Mypair._Myval2._Mylast;
  if ( Myend - Mylast < _Count )
  {
    Myfirst = this->_Mypair._Myval2._Myfirst;
    v6 = Mylast - Myfirst;
    if ( 0xFFFFFFFFFFFFFFFi64 - v6 < _Count )
      std::_Xlength_error("vector<T> too long");
    v7 = v6 + _Count;
    v8 = Myend - Myfirst;
    v9 = 0i64;
    if ( 0xFFFFFFFFFFFFFFFi64 - (v8 >> 1) >= v8 )
      v9 = v8 + (v8 >> 1);
    if ( v9 >= v7 )
      v7 = v9;
    std::vector<AgPointer<AgDialog>>::_Reallocate(this, v7);
  }
}

void __fastcall std::vector<AgPointer<AgDialog>>::_Tidy(std::vector<AgPointer<AgDialog>> *this)
{
  AgPointer<AgDialog> *Myfirst; // rbx
  AgPointer<AgDialog> *i; // rdi

  Myfirst = this->_Mypair._Myval2._Myfirst;
  if ( this->_Mypair._Myval2._Myfirst )
  {
    for ( i = this->_Mypair._Myval2._Mylast; Myfirst != i; ++Myfirst )
      AgPointer<AgDialog>::~AgPointer<AgDialog>(Myfirst);
    std::_Wrap_alloc<std::allocator<AgDelegate1<AgSuspendingEvent const &,void>>>::deallocate(
      (std::_Wrap_alloc<std::allocator<AgDelegate1<AgUserUpdatedEvent const &,void> > > *)this,
      (AgDelegate1<AgUserUpdatedEvent const &,void> *)this->_Mypair._Myval2._Myfirst,
      this->_Mypair._Myval2._Myend - this->_Mypair._Myval2._Myfirst);
    this->_Mypair._Myval2._Myfirst = 0i64;
    this->_Mypair._Myval2._Mylast = 0i64;
    this->_Mypair._Myval2._Myend = 0i64;
  }
}

AgDelegate1<AgShutdownEvent const &,void> *__fastcall std::allocator<AgDelegate1<AgShutdownEvent const &,void>>::allocate(
        std::allocator<AgDelegate1<AgShutdownEvent const &,void> > *this,
        unsigned __int64 _Count)
{
  AgDelegate1<AgShutdownEvent const &,void> *result; // rax
  unsigned __int64 v3; // rdx
  void (__fastcall *v4)(detail::GenericClass *); // rax
  void (__fastcall *v5)(detail::GenericClass *); // rcx

  if ( !_Count )
    return 0i64;
  if ( _Count > 0xFFFFFFFFFFFFFFFi64 )
    std::_Xbad_alloc();
  v3 = 16 * _Count;
  if ( v3 < 0x1000 )
  {
    result = (AgDelegate1<AgShutdownEvent const &,void> *)operator new(v3);
    if ( !result )
      invalid_parameter_noinfo_noreturn();
  }
  else
  {
    if ( v3 + 39 <= v3 )
      std::_Xbad_alloc();
    v4 = (void (__fastcall *)(detail::GenericClass *))operator new(v3 + 39);
    v5 = v4;
    if ( !v4 )
      invalid_parameter_noinfo_noreturn();
    result = (AgDelegate1<AgShutdownEvent const &,void> *)(((unsigned __int64)v4 + 39) & 0xFFFFFFFFFFFFFFE0ui64);
    result[-1].m_Closure.m_pFunction = v5;
  }
  return result;
}

void __fastcall AgDialogManager::closeActiveDialog(AgDialogManager *this)
{
  AgMutex *p_m_mutex; // rdi
  AgPointer<AgDialog> *Myfirst; // rcx
  AgDialog *m_ptr; // rax

  p_m_mutex = &this->m_mutex;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_mutex);
  if ( this->m_activeDialog._Mypair._Myval2._Myfirst != this->m_activeDialog._Mypair._Myval2._Mylast )
  {
    Myfirst = this->m_activeDialog._Mypair._Myval2._Myfirst;
    m_ptr = Myfirst->m_ptr;
    if ( m_ptr->m_status != AgDialogStatus_Canceled && m_ptr->m_status != AgDialogStatus_Completed )
      m_ptr->close(Myfirst->m_ptr);
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)p_m_mutex);
}

AgPointer<AgDialog> *__fastcall AgDialogManager::createErrorDialog(
        AgDialogManager *this,
        AgPointer<AgDialog> *result,
        AgPointer<AgUser> *user,
        AgSilverwareError error,
        unsigned __int64 internalError,
        AgDelegate1<AgPointer<AgDialog>,void> *handler)
{
  result->m_ref = 0i64;
  result->m_ptr = 0i64;
  AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)user);
  return result;
}

AgPointer<AgDialog> *__fastcall AgDialogManager::createHelpDialog(
        AgDialogManager *this,
        AgPointer<AgDialog> *result,
        AgPointer<AgUser> *user,
        AgDelegate1<AgPointer<AgDialog>,void> *handler)
{
  result->m_ref = 0i64;
  result->m_ptr = 0i64;
  AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)user);
  return result;
}

AgPointer<AgDialog> *__fastcall AgDialogManager::createSaveErrorDialog(
        AgDialogManager *this,
        AgPointer<AgDialog> *result,
        AgPointer<AgUser> *user,
        const AgMountErrorEvent *error,
        AgDelegate1<AgPointer<AgDialog>,void> *handler)
{
  result->m_ref = 0i64;
  result->m_ptr = 0i64;
  AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)user);
  return result;
}

AgPointer<AgDialog> *__fastcall AgDialogManager::createSignInDialog(
        AgDialogManager *this,
        AgPointer<AgDialog> *result,
        AgPointer<AgUser> *user,
        AgDelegate1<AgPointer<AgDialog>,void> *handler)
{
  result->m_ref = 0i64;
  result->m_ptr = 0i64;
  AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)user);
  return result;
}

void __fastcall AgDialogManager::createSingleton()
{
  AgDefaultDialogManager *v0; // rax

  v0 = (AgDefaultDialogManager *)operator new(0x48ui64);
  if ( v0 )
    AgDefaultDialogManager::AgDefaultDialogManager(v0);
}

AgPointer<AgDialog> *__fastcall AgDialogManager::createUserSelectDialog(
        AgDialogManager *this,
        AgPointer<AgDialog> *result,
        AgPointer<AgController> *controller,
        unsigned int flags,
        AgDelegate1<AgPointer<AgDialog>,void> *handler)
{
  result->m_ref = 0i64;
  result->m_ptr = 0i64;
  AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)controller);
  return result;
}

void __fastcall std::_Wrap_alloc<std::allocator<AgDelegate1<AgSuspendingEvent const &,void>>>::deallocate(
        std::_Wrap_alloc<std::allocator<AgDelegate1<AgUserUpdatedEvent const &,void> > > *this,
        AgDelegate1<AgUserUpdatedEvent const &,void> *_Ptr,
        unsigned __int64 _Count)
{
  void (__fastcall *m_pFunction)(detail::GenericClass *); // rax
  char *v4; // rdx

  if ( _Count > 0xFFFFFFFFFFFFFFFi64 )
    invalid_parameter_noinfo_noreturn();
  if ( 16 * _Count >= 0x1000 )
  {
    if ( ((unsigned __int8)_Ptr & 0x1F) != 0 )
      invalid_parameter_noinfo_noreturn();
    m_pFunction = _Ptr[-1].m_Closure.m_pFunction;
    if ( (AgDelegate1<AgUserUpdatedEvent const &,void> *)m_pFunction >= _Ptr )
      invalid_parameter_noinfo_noreturn();
    v4 = (char *)((char *)_Ptr - (char *)m_pFunction);
    if ( (unsigned __int64)v4 < 8 )
      invalid_parameter_noinfo_noreturn();
    if ( (unsigned __int64)v4 > 0x27 )
      invalid_parameter_noinfo_noreturn();
    _Ptr = (AgDelegate1<AgUserUpdatedEvent const &,void> *)m_pFunction;
  }
  operator delete(_Ptr);
}

void __fastcall AgDialogManager::onShutdown(AgDialogManager *this, const AgShutdownEvent *evt)
{
  AgMutex *p_m_mutex; // rbp
  AgPointer<AgDialog> *Mylast; // rdi
  AgPointer<AgDialog> *i; // rbx

  p_m_mutex = &this->m_mutex;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_mutex);
  AgDialogManager::closeActiveDialog(this);
  Mylast = this->m_activeDialog._Mypair._Myval2._Mylast;
  for ( i = this->m_activeDialog._Mypair._Myval2._Myfirst; i != Mylast; ++i )
    AgPointer<AgDialog>::~AgPointer<AgDialog>(i);
  this->m_activeDialog._Mypair._Myval2._Mylast = this->m_activeDialog._Mypair._Myval2._Myfirst;
  LeaveCriticalSection((LPCRITICAL_SECTION)p_m_mutex);
}

__int64 __fastcall AgUser::isSignedIn(Concurrency::details::ThreadInternalContext *this)
{
  return 1i64;
}

void __fastcall std::vector<AgPointer<AgDialog>>::push_back(
        std::vector<AgPointer<AgDialog>> *this,
        const AgPointer<AgDialog> *_Val)
{
  AgPointer<AgDialog> *Mylast; // rax
  AgPointer<AgDialog> *Myfirst; // rcx
  signed __int64 v6; // rdi
  AgPointer<AgDialog> *v7; // rcx
  const AgPointer<AgPlayer> *v8; // rdi
  AgPointer<AgDialog> *v9; // rcx

  Mylast = this->_Mypair._Myval2._Mylast;
  if ( _Val >= Mylast || (Myfirst = this->_Mypair._Myval2._Myfirst, Myfirst > _Val) )
  {
    if ( Mylast == this->_Mypair._Myval2._Myend )
      std::vector<AgPointer<AgDialog>>::_Reserve(this, 1ui64);
    v9 = this->_Mypair._Myval2._Mylast;
    if ( v9 )
      AgPointer<AgBuffer<AgAllocator<1>>>::AgPointer<AgBuffer<AgAllocator<1>>>(
        (AgPointer<AgPlayer> *)v9,
        (const AgPointer<AgPlayer> *)_Val);
  }
  else
  {
    v6 = (char *)_Val - (char *)Myfirst;
    if ( Mylast == this->_Mypair._Myval2._Myend )
      std::vector<AgPointer<AgDialog>>::_Reserve(this, 1ui64);
    v7 = this->_Mypair._Myval2._Mylast;
    v8 = (const AgPointer<AgPlayer> *)((char *)this->_Mypair._Myval2._Myfirst + (v6 & 0xFFFFFFFFFFFFFFF0ui64));
    if ( v7 )
      AgPointer<AgBuffer<AgAllocator<1>>>::AgPointer<AgBuffer<AgAllocator<1>>>((AgPointer<AgPlayer> *)v7, v8);
  }
  ++this->_Mypair._Myval2._Mylast;
}

AgPointer<AgDialog> *__fastcall AgDialogManager::queueDialog(
        AgDialogManager *this,
        AgPointer<AgDialog> *result,
        AgPointer<AgDialog> *dialog)
{
  AgMutex *p_m_mutex; // rbp
  std::vector<AgPointer<AgDialog>> *p_m_activeDialog; // rcx
  AgPointer<AgDialog> *Myfirst; // rdi
  AgPointer<AgDialog> *Mylast; // rbx

  p_m_mutex = &this->m_mutex;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_mutex);
  if ( dialog->m_ptr )
  {
    p_m_activeDialog = &this->m_activeDialog;
    Myfirst = this->m_activeDialog._Mypair._Myval2._Myfirst;
    Mylast = this->m_activeDialog._Mypair._Myval2._Mylast;
    std::vector<AgPointer<AgDialog>>::push_back(p_m_activeDialog, dialog);
    if ( Myfirst == Mylast )
      dialog->m_ptr->open(dialog->m_ptr);
  }
  result->m_ref = dialog->m_ref;
  result->m_ptr = dialog->m_ptr;
  dialog->m_ref = 0i64;
  dialog->m_ptr = 0i64;
  LeaveCriticalSection((LPCRITICAL_SECTION)p_m_mutex);
  AgPointer<AgDialog>::~AgPointer<AgDialog>(dialog);
  return result;
}

AgPointer<AgDialog> *__fastcall AgDialogManager::showSaveErrorDialog(
        AgDialogManager *this,
        AgPointer<AgDialog> *result,
        AgPointer<AgUser> *user,
        const AgMountErrorEvent *error,
        AgDelegate1<AgPointer<AgDialog>,void> *handler)
{
  AgMutex *p_m_mutex; // rdi
  __int64 v10; // rax
  AgPointer<AgDialog> *v11; // rax
  AgDelegate1<AgPointer<AgDialog>,void> v13; // [rsp+58h] [rbp-60h] BYREF
  AgPointer<AgPlayer> v14; // [rsp+68h] [rbp-50h] BYREF
  char v15[64]; // [rsp+78h] [rbp-40h] BYREF

  p_m_mutex = &this->m_mutex;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_mutex);
  AgPointer<AgBuffer<AgAllocator<1>>>::AgPointer<AgBuffer<AgAllocator<1>>>(&v14, (const AgPointer<AgPlayer> *)user);
  v13 = *handler;
  v11 = (AgPointer<AgDialog> *)((__int64 (__fastcall *)(AgDialogManager *, char *, __int64, const AgMountErrorEvent *, AgDelegate1<AgPointer<AgDialog>,void> *))this->createSaveErrorDialog)(
                                 this,
                                 v15,
                                 v10,
                                 error,
                                 &v13);
  AgDialogManager::queueDialog(this, result, v11);
  LeaveCriticalSection((LPCRITICAL_SECTION)p_m_mutex);
  AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)user);
  return result;
}

