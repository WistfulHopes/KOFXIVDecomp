#include "program files (x86)/microsoft visual studio 14.0/vc/include/xlocnum"
#include "dev/silverware/git/src/platforms/shared/services/agdefaultleaderboardmanager.h"
#include "dev/silverware/git/src/platforms/shared/services/agdefaultleaderboard.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xiosbase"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xlocale"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/tuple"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xlocinfo"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/ctype.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xtgmath.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xtr1common"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/stdlib.h"
#include "dev/silverware/git/sdk/agreferencecount.h"
#include "dev/silverware/git/sdk/agringbuffer.h"
#include "dev/silverware/git/sdk/agmath.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xstddef"
#include "dev/silverware/git/sdk/agcondition.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/mutex"
#include "dev/silverware/git/sdk/filesystem/agfile.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/chrono"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/limits"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/map"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xtree"
#include "dev/silverware/git/sdk/system/agsysteminfo.h"
#include "dev/silverware/git/sdk/filesystem/agmount.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/time.h"
#include "dev/silverware/git/sdk/filesystem/agpath.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/thread"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/utility"
#include "dev/silverware/git/sdk/agconditionvariable.inl"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/memory"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xmemory"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/thr/xthread"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/iosfwd"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/stdio.h"
#include "dev/silverware/git/sdk/input/agcontrollerbuttoncomponent.h"
#include "dev/silverware/git/sdk/system/agplayermanager.h"
#include "dev/silverware/git/sdk/platforms/pc/system/agpcsysteminfo.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/type_traits"
#include "dev/silverware/git/sdk/memory/agallocators.h"
#include "dev/silverware/git/sdk/agsingleton.h"
#include "dev/silverware/git/sdk/agreferencecountinl.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wconio.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_stdio_config.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xatomic0.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/functional"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xstring"
#include "dev/silverware/git/sdk/system/agusermanager.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xmemory0"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/exception"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/malloc.h"
#include "dev/silverware/git/sdk/agstream.h"
#include "dev/silverware/git/sdk/agcondition.inl"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vcruntime_new.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/cmath"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wstring.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/math.h"
#include "dev/silverware/git/sdk/agmemorypool.h"
#include "dev/silverware/git/sdk/agpointerinl.h"
#include "dev/silverware/git/sdk/util/agservicecommand.h"
#include "dev/silverware/git/sdk/util/agdelegate.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xfacet"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wstdio.h"
#include "dev/silverware/git/sdk/util/agperformancecounter.h"
#include "dev/silverware/git/sdk/agclock.h"
#include "dev/silverware/git/sdk/agreferenceinl.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/sys/stat.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vector"
#include "dev/silverware/git/sdk/system/agplayer.h"
#include "dev/silverware/git/sdk/input/agcontroller.h"
#include "dev/silverware/git/sdk/input/agcontrollercomponent.h"
#include "dev/silverware/git/sdk/services/agleaderboardranking.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vcruntime_typeinfo.h"
#include "dev/silverware/git/sdk/system/agprofilemanager.h"
#include "dev/silverware/git/sdk/system/agprofile.h"
#include "dev/silverware/git/sdk/services/agleaderboard.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xutility"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/wchar.h"
#include "dev/silverware/git/sdk/system/aguser.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_memcpy_s.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/list"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/string.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_memory.h"
#include "dev/silverware/git/sdk/filesystem/agdirectory.h"
#include "dev/silverware/git/sdk/agthreadpool.h"
#include "dev/silverware/git/sdk/agsemaphore.h"
#include "dev/silverware/git/sdk/agsemaphore.inl"
#include "dev/silverware/git/sdk/agconditionvariable.h"
#include "dev/silverware/git/sdk/agthread.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/condition_variable"
#include "dev/silverware/git/sdk/services/agleaderboardmanager.h"
#include "dev/silverware/git/sdk/util/agservice.h"
#include "dev/silverware/git/sdk/agreferencedobjectinl.h"
#include "dev/silverware/git/sdk/agpointer.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vcruntime_exception.h"
#include "dev/silverware/git/sdk/agreferencedobject.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wtime.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wio.h"
#include "dev/silverware/git/sdk/memory/agbuffer.h"
#include "dev/silverware/git/sdk/util/agdebugchannels.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vadefs.h"
#include "dev/silverware/git/sdk/agstring.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/system_error"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/string"
#include "dev/silverware/git/sdk/agmutex.inl"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/stdexcept"
#include "dev/silverware/git/sdk/agmutex.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/ios"
#include "dev/silverware/git/sdk/agscopedlock.h"

AgLeaderboardManager * AgLeaderboardManager::createSingleton(); // 0x140684D60
AgPointer<AgLeaderboard> AgLeaderboardManager::open(AgStringRef name); // 0x140686370
void AgLeaderboardManager::_queueStoreRanking(AgStringRef leaderboardName, const AgLeaderboardRanking & score, AgPointer<AgUser> user, long retryCount); // 0x140684AB0
class CompleteStoreRankingPredicate
{
public:
	CompleteStoreRankingPredicate(long, long);
	long operator()(AgLeaderboardManager::StoreRankingEntry &);
private:
	long m_requestId; // 0x0
	long m_result; // 0x4
};
void AgLeaderboardManager::update(); // 0x140686CB0
long AgLeaderboardManager::onSingletonInit(); // 0x140686340
long AgLeaderboardManager::onSingletonExit(); // 0x1406862E0
class SerializeStoreQueuePredicate
{
public:
	SerializeStoreQueuePredicate(SerializeStoreQueuePredicate &);
	SerializeStoreQueuePredicate(const SerializeStoreQueuePredicate &);
	SerializeStoreQueuePredicate(AgPointer<AgStream>);
	long operator()(const AgLeaderboardManager::StoreRankingEntry &);
private:
	AgPointer<AgStream> m_stream; // 0x0
public:
	~SerializeStoreQueuePredicate();
	SerializeStoreQueuePredicate & operator=(SerializeStoreQueuePredicate &);
	SerializeStoreQueuePredicate & operator=(const SerializeStoreQueuePredicate &);
};
std::piecewise_construct_t std::piecewise_construct; // 0x14086BAC8
typedef AgPointer<AgLeaderboardRankingList> AgLeaderboardRankingListPtr;
typedef AgDefaultLeaderboardManager AgPlatformLeaderboardManager;
typedef AgPointer<AgFile> AgFileStreamPtr;
AgLeaderboardManager::StoreRankingEntry::StoreRankingEntry(const AgLeaderboardManager::StoreRankingEntry & __that); // 0x140683590
AgLeaderboardManager::StoreRankingEntry::StoreRankingEntry(); // 0x140683640
AgRingBuffer<AgLeaderboardManager::StoreRankingEntry>::~AgRingBuffer<AgLeaderboardManager::StoreRankingEntry>(); // 0x140683840
long SerializeStoreQueuePredicate::operator()(const AgLeaderboardManager::StoreRankingEntry & entry); // 0x140684240
std::map<unsigned int,AgLeaderboard::RankingData,std::less<unsigned int>,std::allocator<std::pair<unsigned int const ,AgLeaderboard::RankingData> > >::~map<unsigned int,AgLeaderboard::RankingData,std::less<unsigned int>,std::allocator<std::pair<unsigned int const ,AgLeaderboard::RankingData> > >(); // 0x140683A40
std::map<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const ,unsigned int> > >::~map<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const ,unsigned int> > >(); // 0x140683A80
std::map<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > >::~map<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > >(); // 0x140683AC0
std::pair<AgStringKey const ,unsigned int>::~pair<AgStringKey const ,unsigned int>(); // 0x140683B00
std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >::~pair<AgStringKey const ,AgPointer<AgLeaderboard> >(); // 0x140683B20
AgLeaderboardRanking::~AgLeaderboardRanking(); // 0x140683CF0
AgLeaderboard::RankingData::~RankingData(); // 0x140683D20
SerializeStoreQueuePredicate::~SerializeStoreQueuePredicate(); // 0x140683D60
AgLeaderboardManager::StoreRankingEntry::~StoreRankingEntry(); // 0x140683D80
long AgLeaderboardManager::serialize(AgPointer<AgStream> stream); // 0x140686970
long AgLeaderboardManager::deserialize(AgPointer<AgStream> stream); // 0x140684DB0//decompilation failure at 14086BAC8!
void __fastcall ____0__QEAVAgStringKey____Z__V___pair___CBVAgStringKey__V__AgPointer_VAgLeaderboard_____std__QEAA_Upiecewise_construct_t_1_V__tuple___QEAVAgStringKey___1_V__tuple___V_1__Z(
        std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > *this,
        std::piecewise_construct_t __formal,
        std::tuple<AgStringKey &&> _Val1,
        std::tuple<> _Val2)
{
  AgStringRef *v5; // rbx
  AgStringRef v6; // [rsp+28h] [rbp-20h] BYREF

  v5 = *(AgStringRef **)&_Val1._Myfirst._Val->m_string.m_length;
  AgString::AgString(&this->first.m_string, *(const AgString **)&_Val1._Myfirst._Val->m_string.m_length);
  this->first.m_stringRef = v5[1];
  if ( (unsigned int)AgString::getLength(&this->first.m_string) )
  {
    AgStringRef::AgStringRef(&v6, &this->first.m_string);
    this->first.m_stringRef = v6;
  }
  this->second.m_ref = 0i64;
  this->second.m_ptr = 0i64;
}

std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *__fastcall std::_Tree_comp_alloc<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::_Buynode<std::piecewise_construct_t const &,std::tuple<AgStringKey &&>,std::tuple<>>(
        std::_Tree_comp_alloc<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const ,unsigned int> >,0> > *this,
        const std::piecewise_construct_t *<_Val_0>,
        std::tuple<AgStringKey &&> *<_Val_1>,
        std::tuple<> *<_Val_2>)
{
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *v9; // [rsp+30h] [rbp-18h]

  v9 = std::_Tree_comp_alloc<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::_Buynode0(this);
  *(_WORD *)&v9->_Color = 0;
  std::_Wrap_alloc<std::allocator<std::_Tree_node<std::pair<AgStringKey const,unsigned int>,void *>>>::construct<std::pair<AgStringKey const,unsigned int>,std::piecewise_construct_t const &,std::tuple<AgStringKey &&>,std::tuple<>>(
    (std::_Wrap_alloc<std::allocator<std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> > > *)this,
    &v9->_Myval,
    <_Val_0>,
    <_Val_1>,
    <_Val_2>);
  return v9;
}

std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *__fastcall std::_Tree_comp_alloc<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::_Buynode<std::piecewise_construct_t const &,std::tuple<AgStringKey &&>,std::tuple<>>(
        std::_Tree_comp_alloc<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > >,0> > *this,
        const std::piecewise_construct_t *<_Val_0>,
        std::tuple<AgStringKey &&> *<_Val_1>,
        std::tuple<> *<_Val_2>)
{
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v6; // rbx
  char v8; // [rsp+20h] [rbp-38h] BYREF
  std::tuple<AgStringKey &&> _Val1; // [rsp+28h] [rbp-30h] BYREF
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v10; // [rsp+30h] [rbp-28h]
  __int64 v11; // [rsp+38h] [rbp-20h]
  std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > *p_Myval; // [rsp+40h] [rbp-18h]
  std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > *v13; // [rsp+48h] [rbp-10h]

  v11 = -2i64;
  v6 = std::_Tree_comp_alloc<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::_Buynode0(this);
  v10 = v6;
  *(_WORD *)&v6->_Color = 0;
  p_Myval = &v6->_Myval;
  v13 = &v6->_Myval;
  if ( v6 != (std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *)-32i64 )
  {
    _Val1._Myfirst._Val = <_Val_1>->_Myfirst._Val;
    ____0__QEAVAgStringKey____Z__V___pair___CBVAgStringKey__V__AgPointer_VAgLeaderboard_____std__QEAA_Upiecewise_construct_t_1_V__tuple___QEAVAgStringKey___1_V__tuple___V_1__Z(
      &v6->_Myval,
      *<_Val_0>,
      (std::tuple<AgStringKey &&>)&_Val1,
      (std::tuple<>)&v8);
  }
  return v6;
}

std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > > *__fastcall std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::_Insert_at<std::pair<AgStringKey const,unsigned int> &,std::_Tree_node<std::pair<AgStringKey const,unsigned int>,void *> *>(
        std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const ,unsigned int> >,0> > *this,
        std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > > *result,
        bool _Addleft,
        std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *_Wherenode,
        std::pair<AgStringKey const ,unsigned int> *_Val,
        std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *_Node)
{
  unsigned __int64 Mysize; // rax
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *Myhead; // rax
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *v10; // rax
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *Parent; // rcx
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *v12; // r8
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *Left; // rdx
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *Right; // rdx
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *v15; // rdx
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *v16; // rcx
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *v17; // rdx
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *v18; // r8
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *v19; // rcx
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *v20; // rcx
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *v21; // rdx
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *v22; // rcx
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *v23; // rcx
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *v24; // rcx

  Mysize = this->_Mypair._Myval2._Myval2._Mysize;
  if ( Mysize >= 0x38E38E38E38E38Di64 )
  {
    AgString::~AgString(&_Node->_Myval.first.m_string, (unsigned __int64)result);
    operator delete(_Node);
    std::_Xlength_error("map/set<T> too long");
  }
  this->_Mypair._Myval2._Myval2._Mysize = Mysize + 1;
  _Node->_Parent = _Wherenode;
  if ( _Wherenode == this->_Mypair._Myval2._Myval2._Myhead )
  {
    this->_Mypair._Myval2._Myval2._Myhead->_Parent = _Node;
    this->_Mypair._Myval2._Myval2._Myhead->_Left = _Node;
    Myhead = this->_Mypair._Myval2._Myval2._Myhead;
LABEL_9:
    Myhead->_Right = _Node;
    goto LABEL_10;
  }
  if ( !_Addleft )
  {
    _Wherenode->_Right = _Node;
    Myhead = this->_Mypair._Myval2._Myval2._Myhead;
    if ( _Wherenode != this->_Mypair._Myval2._Myval2._Myhead->_Right )
      goto LABEL_10;
    goto LABEL_9;
  }
  _Wherenode->_Left = _Node;
  if ( _Wherenode == this->_Mypair._Myval2._Myval2._Myhead->_Left )
    this->_Mypair._Myval2._Myval2._Myhead->_Left = _Node;
LABEL_10:
  v10 = _Node;
  while ( !v10->_Parent->_Color )
  {
    Parent = v10->_Parent;
    v12 = Parent->_Parent;
    Left = v12->_Left;
    if ( Parent == v12->_Left )
    {
      Right = v12->_Right;
      if ( Right->_Color )
      {
        if ( v10 == Parent->_Right )
        {
          v10 = v10->_Parent;
          v15 = Parent->_Right;
          Parent->_Right = v15->_Left;
          if ( !v15->_Left->_Isnil )
            v15->_Left->_Parent = Parent;
          v15->_Parent = Parent->_Parent;
          if ( Parent == this->_Mypair._Myval2._Myval2._Myhead->_Parent )
          {
            this->_Mypair._Myval2._Myval2._Myhead->_Parent = v15;
          }
          else
          {
            v16 = Parent->_Parent;
            if ( v10 == v16->_Left )
              v16->_Left = v15;
            else
              v16->_Right = v15;
          }
          v15->_Left = v10;
          v10->_Parent = v15;
        }
        v10->_Parent->_Color = 1;
        v10->_Parent->_Parent->_Color = 0;
        v17 = v10->_Parent->_Parent;
        v18 = v17->_Left;
        v17->_Left = v17->_Left->_Right;
        v19 = v18->_Right;
        if ( !v19->_Isnil )
          v19->_Parent = v17;
        v18->_Parent = v17->_Parent;
        if ( v17 == this->_Mypair._Myval2._Myval2._Myhead->_Parent )
        {
          this->_Mypair._Myval2._Myval2._Myhead->_Parent = v18;
        }
        else
        {
          v20 = v17->_Parent;
          if ( v17 == v20->_Right )
            v20->_Right = v18;
          else
            v20->_Left = v18;
        }
        v18->_Right = v17;
LABEL_50:
        v17->_Parent = v18;
        continue;
      }
      Parent->_Color = 1;
      Right->_Color = 1;
      v10->_Parent->_Parent->_Color = 0;
      v10 = v10->_Parent->_Parent;
    }
    else
    {
      if ( Left->_Color )
      {
        if ( v10 == Parent->_Left )
        {
          v10 = v10->_Parent;
          v21 = Parent->_Left;
          Parent->_Left = Parent->_Left->_Right;
          v22 = v21->_Right;
          if ( !v22->_Isnil )
            v22->_Parent = v10;
          v21->_Parent = v10->_Parent;
          if ( v10 == this->_Mypair._Myval2._Myval2._Myhead->_Parent )
          {
            this->_Mypair._Myval2._Myval2._Myhead->_Parent = v21;
          }
          else
          {
            v23 = v10->_Parent;
            if ( v10 == v23->_Right )
              v23->_Right = v21;
            else
              v23->_Left = v21;
          }
          v21->_Right = v10;
          v10->_Parent = v21;
        }
        v10->_Parent->_Color = 1;
        v10->_Parent->_Parent->_Color = 0;
        v17 = v10->_Parent->_Parent;
        v18 = v17->_Right;
        v17->_Right = v18->_Left;
        if ( !v18->_Left->_Isnil )
          v18->_Left->_Parent = v17;
        v18->_Parent = v17->_Parent;
        if ( v17 == this->_Mypair._Myval2._Myval2._Myhead->_Parent )
        {
          this->_Mypair._Myval2._Myval2._Myhead->_Parent = v18;
        }
        else
        {
          v24 = v17->_Parent;
          if ( v17 == v24->_Left )
            v24->_Left = v18;
          else
            v24->_Right = v18;
        }
        v18->_Left = v17;
        goto LABEL_50;
      }
      Parent->_Color = 1;
      Left->_Color = 1;
      v10->_Parent->_Parent->_Color = 0;
      v10 = v10->_Parent->_Parent;
    }
  }
  this->_Mypair._Myval2._Myval2._Myhead->_Parent->_Color = 1;
  result->_Ptr = _Node;
  return result;
}

std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > > *__fastcall std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::_Insert_at<std::pair<AgStringKey const,AgPointer<AgLeaderboard>> &,std::_Tree_node<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>,void *> *>(
        std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > >,0> > *this,
        std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > > *result,
        bool _Addleft,
        std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *_Wherenode,
        std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > *_Val,
        std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *_Node)
{
  unsigned __int64 Mysize; // rax
  unsigned __int64 v9; // rdx
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *Myhead; // rax
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v11; // rax
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *Parent; // rcx
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v13; // r8
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *Left; // rdx
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *Right; // rdx
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v16; // rdx
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v17; // rcx
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v18; // rdx
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v19; // r8
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v20; // rcx
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v21; // rcx
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v22; // rdx
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v23; // rcx
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v24; // rcx
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v25; // rcx

  Mysize = this->_Mypair._Myval2._Myval2._Mysize;
  if ( Mysize >= 0x333333333333332i64 )
  {
    AgPointer<AgLeaderboard>::~AgPointer<AgLeaderboard>(&_Node->_Myval.second);
    AgString::~AgString(&_Node->_Myval.first.m_string, v9);
    operator delete(_Node);
    std::_Xlength_error("map/set<T> too long");
  }
  this->_Mypair._Myval2._Myval2._Mysize = Mysize + 1;
  _Node->_Parent = _Wherenode;
  if ( _Wherenode == this->_Mypair._Myval2._Myval2._Myhead )
  {
    this->_Mypair._Myval2._Myval2._Myhead->_Parent = _Node;
    this->_Mypair._Myval2._Myval2._Myhead->_Left = _Node;
    Myhead = this->_Mypair._Myval2._Myval2._Myhead;
LABEL_9:
    Myhead->_Right = _Node;
    goto LABEL_10;
  }
  if ( !_Addleft )
  {
    _Wherenode->_Right = _Node;
    Myhead = this->_Mypair._Myval2._Myval2._Myhead;
    if ( _Wherenode != this->_Mypair._Myval2._Myval2._Myhead->_Right )
      goto LABEL_10;
    goto LABEL_9;
  }
  _Wherenode->_Left = _Node;
  if ( _Wherenode == this->_Mypair._Myval2._Myval2._Myhead->_Left )
    this->_Mypair._Myval2._Myval2._Myhead->_Left = _Node;
LABEL_10:
  v11 = _Node;
  while ( !v11->_Parent->_Color )
  {
    Parent = v11->_Parent;
    v13 = Parent->_Parent;
    Left = v13->_Left;
    if ( Parent == v13->_Left )
    {
      Right = v13->_Right;
      if ( Right->_Color )
      {
        if ( v11 == Parent->_Right )
        {
          v11 = v11->_Parent;
          v16 = Parent->_Right;
          Parent->_Right = v16->_Left;
          if ( !v16->_Left->_Isnil )
            v16->_Left->_Parent = Parent;
          v16->_Parent = Parent->_Parent;
          if ( Parent == this->_Mypair._Myval2._Myval2._Myhead->_Parent )
          {
            this->_Mypair._Myval2._Myval2._Myhead->_Parent = v16;
          }
          else
          {
            v17 = Parent->_Parent;
            if ( v11 == v17->_Left )
              v17->_Left = v16;
            else
              v17->_Right = v16;
          }
          v16->_Left = v11;
          v11->_Parent = v16;
        }
        v11->_Parent->_Color = 1;
        v11->_Parent->_Parent->_Color = 0;
        v18 = v11->_Parent->_Parent;
        v19 = v18->_Left;
        v18->_Left = v18->_Left->_Right;
        v20 = v19->_Right;
        if ( !v20->_Isnil )
          v20->_Parent = v18;
        v19->_Parent = v18->_Parent;
        if ( v18 == this->_Mypair._Myval2._Myval2._Myhead->_Parent )
        {
          this->_Mypair._Myval2._Myval2._Myhead->_Parent = v19;
        }
        else
        {
          v21 = v18->_Parent;
          if ( v18 == v21->_Right )
            v21->_Right = v19;
          else
            v21->_Left = v19;
        }
        v19->_Right = v18;
LABEL_50:
        v18->_Parent = v19;
        continue;
      }
      Parent->_Color = 1;
      Right->_Color = 1;
      v11->_Parent->_Parent->_Color = 0;
      v11 = v11->_Parent->_Parent;
    }
    else
    {
      if ( Left->_Color )
      {
        if ( v11 == Parent->_Left )
        {
          v11 = v11->_Parent;
          v22 = Parent->_Left;
          Parent->_Left = Parent->_Left->_Right;
          v23 = v22->_Right;
          if ( !v23->_Isnil )
            v23->_Parent = v11;
          v22->_Parent = v11->_Parent;
          if ( v11 == this->_Mypair._Myval2._Myval2._Myhead->_Parent )
          {
            this->_Mypair._Myval2._Myval2._Myhead->_Parent = v22;
          }
          else
          {
            v24 = v11->_Parent;
            if ( v11 == v24->_Right )
              v24->_Right = v22;
            else
              v24->_Left = v22;
          }
          v22->_Right = v11;
          v11->_Parent = v22;
        }
        v11->_Parent->_Color = 1;
        v11->_Parent->_Parent->_Color = 0;
        v18 = v11->_Parent->_Parent;
        v19 = v18->_Right;
        v18->_Right = v19->_Left;
        if ( !v19->_Left->_Isnil )
          v19->_Left->_Parent = v18;
        v19->_Parent = v18->_Parent;
        if ( v18 == this->_Mypair._Myval2._Myval2._Myhead->_Parent )
        {
          this->_Mypair._Myval2._Myval2._Myhead->_Parent = v19;
        }
        else
        {
          v25 = v18->_Parent;
          if ( v18 == v25->_Left )
            v25->_Left = v19;
          else
            v25->_Right = v19;
        }
        v19->_Left = v18;
        goto LABEL_50;
      }
      Parent->_Color = 1;
      Left->_Color = 1;
      v11->_Parent->_Parent->_Color = 0;
      v11 = v11->_Parent->_Parent;
    }
  }
  this->_Mypair._Myval2._Myval2._Myhead->_Parent->_Color = 1;
  result->_Ptr = _Node;
  return result;
}

std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > > *__fastcall std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::_Insert_hint<std::pair<AgStringKey const,unsigned int> &,std::_Tree_node<std::pair<AgStringKey const,unsigned int>,void *> *>(
        std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const ,unsigned int> >,0> > *this,
        std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > > *result,
        std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > > _Where,
        std::pair<AgStringKey const ,unsigned int> *_Val,
        std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *_Newnode)
{
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *Myhead; // rcx
  AgStringRef *p_m_stringRef; // r12
  AgStringRef *v11; // rdi
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *Ptr; // rax
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *Right; // rcx
  std::_Tree_node<std::pair<__int64 const ,AgPointer<AgUser> >,void *> *Parent; // rdx
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *v15; // rdi
  std::_Tree_node<std::pair<__int64 const ,AgPointer<AgUser> >,void *> *v16; // rbx
  std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<__int64 const ,AgPointer<AgUser> > > > > v17; // [rsp+30h] [rbp-48h] BYREF
  __int64 v18; // [rsp+38h] [rbp-40h]
  std::pair<std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > >,bool> resulta; // [rsp+40h] [rbp-38h] BYREF

  v18 = -2i64;
  v17._Ptr = 0i64;
  if ( !this->_Mypair._Myval2._Myval2._Mysize )
  {
    std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::_Insert_at<std::pair<AgStringKey const,unsigned int> &,std::_Tree_node<std::pair<AgStringKey const,unsigned int>,void *> *>(
      this,
      result,
      1,
      this->_Mypair._Myval2._Myval2._Myhead,
      _Val,
      _Newnode);
    return result;
  }
  Myhead = this->_Mypair._Myval2._Myval2._Myhead;
  if ( _Where._Ptr == Myhead->_Left )
  {
    if ( operator<(&_Val->first.m_stringRef, &_Where._Ptr->_Myval.first.m_stringRef) )
    {
      std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::_Insert_at<std::pair<AgStringKey const,unsigned int> &,std::_Tree_node<std::pair<AgStringKey const,unsigned int>,void *> *>(
        this,
        result,
        1,
        _Where._Ptr,
        _Val,
        _Newnode);
      return result;
    }
    goto LABEL_33;
  }
  if ( _Where._Ptr == Myhead )
  {
    if ( operator<(&Myhead->_Right->_Myval.first.m_stringRef, &_Val->first.m_stringRef) )
    {
      std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::_Insert_at<std::pair<AgStringKey const,unsigned int> &,std::_Tree_node<std::pair<AgStringKey const,unsigned int>,void *> *>(
        this,
        result,
        0,
        this->_Mypair._Myval2._Myval2._Myhead->_Right,
        _Val,
        _Newnode);
      return result;
    }
    goto LABEL_33;
  }
  p_m_stringRef = &_Val->first.m_stringRef;
  v11 = &_Val->first.m_stringRef;
  if ( operator<(&_Val->first.m_stringRef, &_Where._Ptr->_Myval.first.m_stringRef) )
  {
    Ptr = _Where._Ptr;
    v17._Ptr = (std::_Tree_node<std::pair<__int64 const ,AgPointer<AgUser> >,void *> *)_Where._Ptr;
    if ( _Where._Ptr->_Isnil )
    {
      Right = _Where._Ptr->_Right;
    }
    else
    {
      Right = _Where._Ptr->_Left;
      if ( _Where._Ptr->_Left->_Isnil )
      {
        while ( 1 )
        {
          Parent = (std::_Tree_node<std::pair<__int64 const ,AgPointer<AgUser> >,void *> *)Ptr->_Parent;
          if ( Parent->_Isnil
            || Ptr != (std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *)Parent->_Left )
          {
            break;
          }
          Ptr = Ptr->_Parent;
          v17._Ptr = Parent;
        }
        Right = Ptr;
        if ( !Ptr->_Isnil )
          Right = Ptr->_Parent;
      }
      else
      {
        while ( !Right->_Right->_Isnil )
          Right = Right->_Right;
      }
    }
    v17._Ptr = (std::_Tree_node<std::pair<__int64 const ,AgPointer<AgUser> >,void *> *)Right;
    p_m_stringRef = &_Val->first.m_stringRef;
    if ( operator<(&Right->_Myval.first.m_stringRef, &_Val->first.m_stringRef) )
    {
      if ( v17._Ptr->_Right->_Isnil )
        std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::_Insert_at<std::pair<AgStringKey const,unsigned int> &,std::_Tree_node<std::pair<AgStringKey const,unsigned int>,void *> *>(
          this,
          result,
          0,
          (std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *)v17._Ptr,
          _Val,
          _Newnode);
      else
        std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::_Insert_at<std::pair<AgStringKey const,unsigned int> &,std::_Tree_node<std::pair<AgStringKey const,unsigned int>,void *> *>(
          this,
          result,
          1,
          _Where._Ptr,
          _Val,
          _Newnode);
      return result;
    }
  }
  if ( !operator<(&_Where._Ptr->_Myval.first.m_stringRef, v11) )
    goto LABEL_33;
  v15 = _Where._Ptr;
  v17._Ptr = (std::_Tree_node<std::pair<__int64 const ,AgPointer<AgUser> >,void *> *)_Where._Ptr;
  v16 = (std::_Tree_node<std::pair<__int64 const ,AgPointer<AgUser> >,void *> *)this->_Mypair._Myval2._Myval2._Myhead;
  if ( std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>>>::operator++(&v17)->_Ptr != v16 )
  {
    if ( operator<(p_m_stringRef, (const AgStringRef *)&v17._Ptr->_Myval.second.m_ptr) )
    {
      v15 = _Where._Ptr;
      goto LABEL_29;
    }
LABEL_33:
    result->_Ptr = (std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *)std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::_Insert_nohint<std::pair<AgStringKey const,unsigned int> &,std::_Tree_node<std::pair<AgStringKey const,unsigned int>,void *> *>(
                                                                                           this,
                                                                                           &resulta,
                                                                                           0,
                                                                                           _Val,
                                                                                           _Newnode)->first;
    return result;
  }
LABEL_29:
  if ( v15->_Right->_Isnil )
    std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::_Insert_at<std::pair<AgStringKey const,unsigned int> &,std::_Tree_node<std::pair<AgStringKey const,unsigned int>,void *> *>(
      this,
      result,
      0,
      v15,
      _Val,
      _Newnode);
  else
    std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::_Insert_at<std::pair<AgStringKey const,unsigned int> &,std::_Tree_node<std::pair<AgStringKey const,unsigned int>,void *> *>(
      this,
      result,
      1,
      (std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *)v17._Ptr,
      _Val,
      _Newnode);
  return result;
}

std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > > *__fastcall std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::_Insert_hint<std::pair<AgStringKey const,AgPointer<AgLeaderboard>> &,std::_Tree_node<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>,void *> *>(
        std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > >,0> > *this,
        std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > > *result,
        std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > > _Where,
        std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > *_Val,
        std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *_Newnode)
{
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *Myhead; // rcx
  AgStringRef *p_m_stringRef; // r12
  AgStringRef *v11; // rdi
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *Ptr; // rax
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *Right; // rcx
  std::_Tree_node<std::pair<__int64 const ,AgPointer<AgUser> >,void *> *Parent; // rdx
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v15; // rdi
  std::_Tree_node<std::pair<__int64 const ,AgPointer<AgUser> >,void *> *v16; // rbx
  std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<__int64 const ,AgPointer<AgUser> > > > > v17; // [rsp+30h] [rbp-48h] BYREF
  __int64 v18; // [rsp+38h] [rbp-40h]
  std::pair<std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > >,bool> resulta; // [rsp+40h] [rbp-38h] BYREF

  v18 = -2i64;
  v17._Ptr = 0i64;
  if ( !this->_Mypair._Myval2._Myval2._Mysize )
  {
    std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::_Insert_at<std::pair<AgStringKey const,AgPointer<AgLeaderboard>> &,std::_Tree_node<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>,void *> *>(
      this,
      result,
      1,
      this->_Mypair._Myval2._Myval2._Myhead,
      _Val,
      _Newnode);
    return result;
  }
  Myhead = this->_Mypair._Myval2._Myval2._Myhead;
  if ( _Where._Ptr == Myhead->_Left )
  {
    if ( operator<(&_Val->first.m_stringRef, &_Where._Ptr->_Myval.first.m_stringRef) )
    {
      std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::_Insert_at<std::pair<AgStringKey const,AgPointer<AgLeaderboard>> &,std::_Tree_node<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>,void *> *>(
        this,
        result,
        1,
        _Where._Ptr,
        _Val,
        _Newnode);
      return result;
    }
    goto LABEL_33;
  }
  if ( _Where._Ptr == Myhead )
  {
    if ( operator<(&Myhead->_Right->_Myval.first.m_stringRef, &_Val->first.m_stringRef) )
    {
      std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::_Insert_at<std::pair<AgStringKey const,AgPointer<AgLeaderboard>> &,std::_Tree_node<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>,void *> *>(
        this,
        result,
        0,
        this->_Mypair._Myval2._Myval2._Myhead->_Right,
        _Val,
        _Newnode);
      return result;
    }
    goto LABEL_33;
  }
  p_m_stringRef = &_Val->first.m_stringRef;
  v11 = &_Val->first.m_stringRef;
  if ( operator<(&_Val->first.m_stringRef, &_Where._Ptr->_Myval.first.m_stringRef) )
  {
    Ptr = _Where._Ptr;
    v17._Ptr = (std::_Tree_node<std::pair<__int64 const ,AgPointer<AgUser> >,void *> *)_Where._Ptr;
    if ( _Where._Ptr->_Isnil )
    {
      Right = _Where._Ptr->_Right;
    }
    else
    {
      Right = _Where._Ptr->_Left;
      if ( _Where._Ptr->_Left->_Isnil )
      {
        while ( 1 )
        {
          Parent = (std::_Tree_node<std::pair<__int64 const ,AgPointer<AgUser> >,void *> *)Ptr->_Parent;
          if ( Parent->_Isnil
            || Ptr != (std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *)Parent->_Left )
          {
            break;
          }
          Ptr = Ptr->_Parent;
          v17._Ptr = Parent;
        }
        Right = Ptr;
        if ( !Ptr->_Isnil )
          Right = Ptr->_Parent;
      }
      else
      {
        while ( !Right->_Right->_Isnil )
          Right = Right->_Right;
      }
    }
    v17._Ptr = (std::_Tree_node<std::pair<__int64 const ,AgPointer<AgUser> >,void *> *)Right;
    p_m_stringRef = &_Val->first.m_stringRef;
    if ( operator<(&Right->_Myval.first.m_stringRef, &_Val->first.m_stringRef) )
    {
      if ( v17._Ptr->_Right->_Isnil )
        std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::_Insert_at<std::pair<AgStringKey const,AgPointer<AgLeaderboard>> &,std::_Tree_node<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>,void *> *>(
          this,
          result,
          0,
          (std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *)v17._Ptr,
          _Val,
          _Newnode);
      else
        std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::_Insert_at<std::pair<AgStringKey const,AgPointer<AgLeaderboard>> &,std::_Tree_node<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>,void *> *>(
          this,
          result,
          1,
          _Where._Ptr,
          _Val,
          _Newnode);
      return result;
    }
  }
  if ( !operator<(&_Where._Ptr->_Myval.first.m_stringRef, v11) )
    goto LABEL_33;
  v15 = _Where._Ptr;
  v17._Ptr = (std::_Tree_node<std::pair<__int64 const ,AgPointer<AgUser> >,void *> *)_Where._Ptr;
  v16 = (std::_Tree_node<std::pair<__int64 const ,AgPointer<AgUser> >,void *> *)this->_Mypair._Myval2._Myval2._Myhead;
  if ( std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>>>::operator++(&v17)->_Ptr != v16 )
  {
    if ( operator<(p_m_stringRef, (const AgStringRef *)&v17._Ptr->_Myval.second.m_ptr) )
    {
      v15 = _Where._Ptr;
      goto LABEL_29;
    }
LABEL_33:
    result->_Ptr = (std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *)std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::_Insert_nohint<std::pair<AgStringKey const,AgPointer<AgLeaderboard>> &,std::_Tree_node<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>,void *> *>(this, &resulta, 0, _Val, _Newnode)->first;
    return result;
  }
LABEL_29:
  if ( v15->_Right->_Isnil )
    std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::_Insert_at<std::pair<AgStringKey const,AgPointer<AgLeaderboard>> &,std::_Tree_node<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>,void *> *>(
      this,
      result,
      0,
      v15,
      _Val,
      _Newnode);
  else
    std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::_Insert_at<std::pair<AgStringKey const,AgPointer<AgLeaderboard>> &,std::_Tree_node<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>,void *> *>(
      this,
      result,
      1,
      (std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *)v17._Ptr,
      _Val,
      _Newnode);
  return result;
}

std::pair<std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > >,bool> *__fastcall std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::_Insert_nohint<std::pair<AgStringKey const,unsigned int> &,std::_Tree_node<std::pair<AgStringKey const,unsigned int>,void *> *>(
        std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const ,unsigned int> >,0> > *this,
        std::pair<std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > >,bool> *result,
        bool _Leftish,
        std::pair<AgStringKey const ,unsigned int> *_Val,
        std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *_Newnode)
{
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *Myhead; // rsi
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *Parent; // rbx
  bool v11; // di
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *Right; // rbx
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *v14; // rax
  unsigned __int64 v15; // rdx
  std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > > resulta; // [rsp+40h] [rbp-38h] BYREF

  Myhead = this->_Mypair._Myval2._Myval2._Myhead;
  Parent = this->_Mypair._Myval2._Myval2._Myhead->_Parent;
  v11 = 1;
  while ( !Parent->_Isnil )
  {
    Myhead = Parent;
    if ( _Leftish )
      v11 = !operator<(&Parent->_Myval.first.m_stringRef, &_Val->first.m_stringRef);
    else
      v11 = operator<(&_Val->first.m_stringRef, &Parent->_Myval.first.m_stringRef);
    if ( v11 )
      Parent = Parent->_Left;
    else
      Parent = Parent->_Right;
  }
  Right = Myhead;
  if ( v11 )
  {
    if ( Myhead == this->_Mypair._Myval2._Myval2._Myhead->_Left )
    {
      result->first = (std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > >)std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::_Insert_at<std::pair<AgStringKey const,unsigned int> &,std::_Tree_node<std::pair<AgStringKey const,unsigned int>,void *> *>(this, &resulta, 1, Myhead, _Val, _Newnode)->_Ptr;
      result->second = 1;
      return result;
    }
    if ( Myhead->_Isnil )
    {
      Right = Myhead->_Right;
    }
    else if ( Myhead->_Left->_Isnil )
    {
      while ( 1 )
      {
        v14 = Right->_Parent;
        if ( v14->_Isnil || Right != v14->_Left )
          break;
        Right = Right->_Parent;
      }
      if ( !Right->_Isnil )
        Right = Right->_Parent;
    }
    else
    {
      for ( Right = Myhead->_Left; !Right->_Right->_Isnil; Right = Right->_Right )
        ;
    }
  }
  if ( operator<(&Right->_Myval.first.m_stringRef, &_Val->first.m_stringRef) )
  {
    result->first = (std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > >)std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::_Insert_at<std::pair<AgStringKey const,unsigned int> &,std::_Tree_node<std::pair<AgStringKey const,unsigned int>,void *> *>(this, &resulta, v11, Myhead, _Val, _Newnode)->_Ptr;
    result->second = 1;
  }
  else
  {
    resulta._Ptr = (std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *)&_Newnode->_Myval;
    AgString::~AgString(&_Newnode->_Myval.first.m_string, v15);
    operator delete(_Newnode);
    result->first._Ptr = Right;
    result->second = 0;
  }
  return result;
}

std::pair<std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > >,bool> *__fastcall std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::_Insert_nohint<std::pair<AgStringKey const,AgPointer<AgLeaderboard>> &,std::_Tree_node<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>,void *> *>(
        std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > >,0> > *this,
        std::pair<std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > >,bool> *result,
        bool _Leftish,
        std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > *_Val,
        std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *_Newnode)
{
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *Myhead; // rsi
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *Parent; // rbx
  bool v11; // di
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *Right; // rbx
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v14; // rax
  unsigned __int64 v15; // rdx
  std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > > resulta; // [rsp+40h] [rbp-38h] BYREF

  Myhead = this->_Mypair._Myval2._Myval2._Myhead;
  Parent = this->_Mypair._Myval2._Myval2._Myhead->_Parent;
  v11 = 1;
  while ( !Parent->_Isnil )
  {
    Myhead = Parent;
    if ( _Leftish )
      v11 = !operator<(&Parent->_Myval.first.m_stringRef, &_Val->first.m_stringRef);
    else
      v11 = operator<(&_Val->first.m_stringRef, &Parent->_Myval.first.m_stringRef);
    if ( v11 )
      Parent = Parent->_Left;
    else
      Parent = Parent->_Right;
  }
  Right = Myhead;
  if ( v11 )
  {
    if ( Myhead == this->_Mypair._Myval2._Myval2._Myhead->_Left )
    {
      result->first = (std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > >)std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::_Insert_at<std::pair<AgStringKey const,AgPointer<AgLeaderboard>> &,std::_Tree_node<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>,void *> *>(this, &resulta, 1, Myhead, _Val, _Newnode)->_Ptr;
      result->second = 1;
      return result;
    }
    if ( Myhead->_Isnil )
    {
      Right = Myhead->_Right;
    }
    else if ( Myhead->_Left->_Isnil )
    {
      while ( 1 )
      {
        v14 = Right->_Parent;
        if ( v14->_Isnil || Right != v14->_Left )
          break;
        Right = Right->_Parent;
      }
      if ( !Right->_Isnil )
        Right = Right->_Parent;
    }
    else
    {
      for ( Right = Myhead->_Left; !Right->_Right->_Isnil; Right = Right->_Right )
        ;
    }
  }
  if ( operator<(&Right->_Myval.first.m_stringRef, &_Val->first.m_stringRef) )
  {
    result->first = (std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > >)std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::_Insert_at<std::pair<AgStringKey const,AgPointer<AgLeaderboard>> &,std::_Tree_node<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>,void *> *>(this, &resulta, v11, Myhead, _Val, _Newnode)->_Ptr;
    result->second = 1;
  }
  else
  {
    AgPointer<AgLeaderboard>::~AgPointer<AgLeaderboard>(&_Newnode->_Myval.second);
    AgString::~AgString(&_Newnode->_Myval.first.m_string, v15);
    operator delete(_Newnode);
    result->first._Ptr = Right;
    result->second = 0;
  }
  return result;
}

std::pair<std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > >,bool> *__fastcall std::map<AgStringKey,unsigned int>::_Try_emplace<AgStringKey,>(
        std::map<AgStringKey,unsigned int> *this,
        std::pair<std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > >,bool> *result,
        AgStringKey *_Keyval)
{
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *Myhead; // rdi
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *Parent; // rbx
  std::pair<std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > >,bool> *v8; // rax
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *_Newnode; // rax
  std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > > resulta; // [rsp+60h] [rbp+8h] BYREF
  std::tuple<AgStringKey &&> v11; // [rsp+78h] [rbp+20h] BYREF

  Myhead = this->_Mypair._Myval2._Myval2._Myhead;
  Parent = this->_Mypair._Myval2._Myval2._Myhead->_Parent;
  while ( !Parent->_Isnil )
  {
    if ( operator<(&Parent->_Myval.first.m_stringRef, &_Keyval->m_stringRef) )
    {
      Parent = Parent->_Right;
    }
    else
    {
      Myhead = Parent;
      Parent = Parent->_Left;
    }
  }
  if ( Myhead == this->_Mypair._Myval2._Myval2._Myhead
    || operator<(&_Keyval->m_stringRef, &Myhead->_Myval.first.m_stringRef) )
  {
    v11._Myfirst._Val = _Keyval;
    _Newnode = std::_Tree_comp_alloc<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::_Buynode<std::piecewise_construct_t const &,std::tuple<AgStringKey &&>,std::tuple<>>(
                 this,
                 &std::piecewise_construct_12,
                 &v11,
                 (std::tuple<> *)&resulta);
    std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::_Insert_hint<std::pair<AgStringKey const,unsigned int> &,std::_Tree_node<std::pair<AgStringKey const,unsigned int>,void *> *>(
      this,
      &resulta,
      (std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > >)Myhead,
      &_Newnode->_Myval,
      _Newnode);
    result->first = resulta;
    v8 = result;
    result->second = 1;
  }
  else
  {
    result->second = 0;
    v8 = result;
    result->first._Ptr = Myhead;
  }
  return v8;
}

std::pair<std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > >,bool> *__fastcall std::map<AgStringKey,AgPointer<AgLeaderboard>>::_Try_emplace<AgStringKey,>(
        std::map<AgStringKey,AgPointer<AgLeaderboard>> *this,
        std::pair<std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > >,bool> *result,
        AgStringKey *_Keyval)
{
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *Myhead; // rdi
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *Parent; // rbx
  std::pair<std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > >,bool> *v8; // rax
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *_Newnode; // rax
  std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > > resulta; // [rsp+60h] [rbp+8h] BYREF
  std::tuple<AgStringKey &&> v11; // [rsp+78h] [rbp+20h] BYREF

  Myhead = this->_Mypair._Myval2._Myval2._Myhead;
  Parent = this->_Mypair._Myval2._Myval2._Myhead->_Parent;
  while ( !Parent->_Isnil )
  {
    if ( operator<(&Parent->_Myval.first.m_stringRef, &_Keyval->m_stringRef) )
    {
      Parent = Parent->_Right;
    }
    else
    {
      Myhead = Parent;
      Parent = Parent->_Left;
    }
  }
  if ( Myhead == this->_Mypair._Myval2._Myval2._Myhead
    || operator<(&_Keyval->m_stringRef, &Myhead->_Myval.first.m_stringRef) )
  {
    v11._Myfirst._Val = _Keyval;
    _Newnode = std::_Tree_comp_alloc<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::_Buynode<std::piecewise_construct_t const &,std::tuple<AgStringKey &&>,std::tuple<>>(
                 this,
                 &std::piecewise_construct_12,
                 &v11,
                 (std::tuple<> *)&resulta);
    std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::_Insert_hint<std::pair<AgStringKey const,AgPointer<AgLeaderboard>> &,std::_Tree_node<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>,void *> *>(
      this,
      &resulta,
      (std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > >)Myhead,
      &_Newnode->_Myval,
      _Newnode);
    result->first = resulta;
    v8 = result;
    result->second = 1;
  }
  else
  {
    result->second = 0;
    v8 = result;
    result->first._Ptr = Myhead;
  }
  return v8;
}

void __fastcall std::_Wrap_alloc<std::allocator<std::_Tree_node<std::pair<AgStringKey const,unsigned int>,void *>>>::construct<std::pair<AgStringKey const,unsigned int>,std::piecewise_construct_t const &,std::tuple<AgStringKey &&>,std::tuple<>>(
        std::_Wrap_alloc<std::allocator<std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> > > *this,
        std::pair<AgStringKey const ,unsigned int> *_Ptr,
        const std::piecewise_construct_t *<_Args_0>,
        std::tuple<AgStringKey &&> *<_Args_1>)
{
  AgStringKey *Val; // rbx
  AgStringRef v6; // [rsp+38h] [rbp-20h] BYREF

  if ( _Ptr )
  {
    Val = <_Args_1>->_Myfirst._Val;
    AgString::AgString(&_Ptr->first.m_string, &<_Args_1>->_Myfirst._Val->m_string);
    _Ptr->first.m_stringRef = Val->m_stringRef;
    if ( (unsigned int)AgString::getLength(&_Ptr->first.m_string) )
    {
      AgStringRef::AgStringRef(&v6, &_Ptr->first.m_string);
      _Ptr->first.m_stringRef = v6;
    }
    _Ptr->second = 0;
  }
}

void __fastcall AgReferencedObject::dispose<AgLeaderboardRankingList>(AgLeaderboardRankingList *data)
{
  AgLogger **Myfirst; // rdx

  if ( data )
  {
    Myfirst = (AgLogger **)data->m_scores._Mypair._Myval2._Myfirst;
    if ( Myfirst )
    {
      std::_Wrap_alloc<std::allocator<OGLShader *>>::deallocate(
        (std::allocator<AgLogger *> *)&data->m_scores,
        Myfirst,
        ((char *)data->m_scores._Mypair._Myval2._Myend - (char *)Myfirst) >> 3);
      data->m_scores._Mypair._Myval2._Myfirst = 0i64;
      data->m_scores._Mypair._Myval2._Mylast = 0i64;
      data->m_scores._Mypair._Myval2._Myend = 0i64;
    }
    operator delete(data, 0x28ui64);
  }
}

void __fastcall AgPointer<AgBuffer<AgAllocator<1>>>::AgPointer<AgBuffer<AgAllocator<1>>>(
        AgPointer<AgPlayer> *this,
        const AgPointer<AgPlayer> *rhs)
{
  AgReferenceCount *m_ref; // rsi
  int m_strongCount; // ebx

  this->m_ref = 0i64;
  this->m_ptr = 0i64;
  m_ref = rhs->m_ref;
  if ( rhs->m_ref )
  {
    m_strongCount = m_ref->m_strongCount;
    if ( m_ref->m_strongCount )
    {
      while ( AgAtomicCompareExchange(&m_ref->m_strongCount, m_strongCount, m_strongCount + 1) != m_strongCount )
      {
        m_strongCount = m_ref->m_strongCount;
        if ( !m_ref->m_strongCount )
          return;
      }
      if ( m_strongCount != -1 )
      {
        this->m_ref = rhs->m_ref;
        this->m_ptr = rhs->m_ptr;
      }
    }
  }
}

void __fastcall AgPointer<AgLeaderboard>::AgPointer<AgLeaderboard>(AgPointer<AgLeaderboard> *this, AgLeaderboard *t)
{
  AgReferenceCount *v4; // rax
  int v5; // ecx
  AgReferenceCount *m_refCount; // rsi

  this->m_ref = 0i64;
  this->m_ptr = 0i64;
  if ( t )
  {
    if ( t->m_refCount )
    {
      v5 = 0;
    }
    else
    {
      v4 = (AgReferenceCount *)AgReferenceCount::operator new(0x10ui64);
      v5 = 1;
      if ( v4 )
      {
        v4->m_strongCount = 1;
        v4->m_weakCount = 1;
        v4->m_data = t;
      }
      else
      {
        v4 = 0i64;
      }
      t->m_refCount = v4;
    }
    m_refCount = t->m_refCount;
    if ( !v5 )
      AgReferenceCount::incRef(t->m_refCount);
    this->m_ref = m_refCount;
    this->m_ptr = t;
  }
}

void __fastcall AgLeaderboardManager::AgLeaderboardManager(AgLeaderboardManager *this)
{
  this->__vftable = (AgLeaderboardManager_vtbl *)&AgSingleton<AgLeaderboardManager>::`vftable';
  this->__vftable = (AgLeaderboardManager_vtbl *)&AgLeaderboardManager::`vftable';
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_mutex);
  this->m_leaderboardNames._Mypair._Myval2._Myval2._Myhead = 0i64;
  this->m_leaderboardNames._Mypair._Myval2._Myval2._Mysize = 0i64;
  this->m_leaderboardNames._Mypair._Myval2._Myval2._Myhead = std::_Tree_comp_alloc<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::_Buyheadnode(&this->m_leaderboardNames);
  this->m_leaderboards._Mypair._Myval2._Myval2._Myhead = 0i64;
  this->m_leaderboards._Mypair._Myval2._Myval2._Mysize = 0i64;
  this->m_leaderboards._Mypair._Myval2._Myval2._Myhead = std::_Tree_comp_alloc<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::_Buyheadnode(&this->m_leaderboards);
  this->m_storeQueue.m_read = 0;
  this->m_storeQueue.m_buffer = 0i64;
  this->m_storeQueue.m_sz = 0;
  this->m_storeQueue.m_write = 0;
  this->m_storeCompletion.m_threadPool = 0i64;
  this->m_storeCompletion.m_jobId = 0;
  AgClock::AgClock(&this->m_clock, -1.0);
  this->m_batchCount = 0;
}

void __fastcall AgLeaderboardManager::StoreRankingEntry::StoreRankingEntry(
        AgLeaderboardManager::StoreRankingEntry *this,
        const AgLeaderboardManager::StoreRankingEntry *__that)
{
  this->requestId = __that->requestId;
  this->retryCount = __that->retryCount;
  AgString::AgString(&this->leaderboardName, &__that->leaderboardName);
  AgPointer<AgBuffer<AgAllocator<1>>>::AgPointer<AgBuffer<AgAllocator<1>>>(
    (AgPointer<AgPlayer> *)&this->leaderboard,
    (const AgPointer<AgPlayer> *)&__that->leaderboard);
  this->score.m_profileId = __that->score.m_profileId;
  this->score.m_rank = __that->score.m_rank;
  this->score.m_score = __that->score.m_score;
  AgString::AgString(&this->score.m_comment, &__that->score.m_comment);
  AgPointer<AgBuffer<AgAllocator<1>>>::AgPointer<AgBuffer<AgAllocator<1>>>(
    (AgPointer<AgPlayer> *)&this->score.m_data,
    (const AgPointer<AgPlayer> *)&__that->score.m_data);
  AgPointer<AgBuffer<AgAllocator<1>>>::AgPointer<AgBuffer<AgAllocator<1>>>(
    (AgPointer<AgPlayer> *)&this->user,
    (const AgPointer<AgPlayer> *)&__that->user);
}

void __fastcall AgLeaderboardManager::StoreRankingEntry::StoreRankingEntry(
        AgLeaderboardManager::StoreRankingEntry *this)
{
  AgStringRef *v2; // rax
  AgPointer<AgPlayer> rhs; // [rsp+28h] [rbp-50h] BYREF
  AgStringRef copy; // [rsp+40h] [rbp-38h] BYREF
  AgStringRef v5; // [rsp+50h] [rbp-28h] BYREF

  AgString::AgString(&this->leaderboardName);
  this->leaderboard.m_ref = 0i64;
  this->leaderboard.m_ptr = 0i64;
  rhs = 0i64;
  AgStringRef::AgStringRef(&v5, &pnewText);
  copy = *v2;
  this->score.m_profileId = -1i64;
  this->score.m_rank = 0;
  this->score.m_score = 0i64;
  AgString::AgString(&this->score.m_comment, &copy);
  AgPointer<AgBuffer<AgAllocator<1>>>::AgPointer<AgBuffer<AgAllocator<1>>>(
    (AgPointer<AgPlayer> *)&this->score.m_data,
    &rhs);
  AgPointer<AgBuffer<AgAllocator<1>>>::~AgPointer<AgBuffer<AgAllocator<1>>>((AgPointer<AgBuffer<AgAllocator<1> > > *)&rhs);
  this->user.m_ref = 0i64;
  this->user.m_ptr = 0i64;
}

void __fastcall AgPointer<AgLeaderboard>::~AgPointer<AgLeaderboard>(AgPointer<AgLeaderboard> *this)
{
  AgLeaderboard *m_ptr; // rdi
  AgReferenceCount *m_ref; // rbx
  int v3; // esi

  m_ptr = this->m_ptr;
  this->m_ptr = 0i64;
  m_ref = this->m_ref;
  if ( this->m_ref )
  {
    this->m_ref = 0i64;
    v3 = 0;
    if ( !(unsigned int)AgAtomicDecrement(&m_ref->m_strongCount) )
    {
      if ( !(unsigned int)AgAtomicDecrement(&m_ref->m_weakCount) )
        v3 = 1;
      m_ref->m_data = 0i64;
      if ( m_ptr )
        ((void (__fastcall *)(AgLeaderboard *, __int64))m_ptr->~AgLeaderboard)(m_ptr, 1i64);
      if ( v3 )
        AgReferenceCount::operator delete(m_ref);
    }
  }
}

void __fastcall AgPointer<AgLeaderboardRankingList>::~AgPointer<AgLeaderboardRankingList>(
        AgPointer<AgLeaderboardRankingList> *this)
{
  AgLeaderboardRankingList *m_ptr; // rbp
  AgReferenceCount *m_ref; // rbx
  int v3; // edi

  m_ptr = this->m_ptr;
  this->m_ptr = 0i64;
  m_ref = this->m_ref;
  if ( this->m_ref )
  {
    this->m_ref = 0i64;
    v3 = 0;
    if ( !(unsigned int)AgAtomicDecrement(&m_ref->m_strongCount) )
    {
      if ( !(unsigned int)AgAtomicDecrement(&m_ref->m_weakCount) )
        v3 = 1;
      m_ref->m_data = 0i64;
      AgReferencedObject::dispose<AgLeaderboardRankingList>(m_ptr);
      if ( v3 )
        AgReferenceCount::operator delete(m_ref);
    }
  }
}

void __fastcall AgRingBuffer<AgLeaderboardManager::StoreRankingEntry>::~AgRingBuffer<AgLeaderboardManager::StoreRankingEntry>(
        AgRingBuffer<AgLeaderboardManager::StoreRankingEntry> *this)
{
  AgLeaderboardManager::StoreRankingEntry *m_buffer; // rcx
  _QWORD *p_m_ptr; // rbx

  m_buffer = this->m_buffer;
  if ( m_buffer )
  {
    p_m_ptr = &m_buffer[-1].user.m_ptr;
    `eh vector destructor iterator'(
      m_buffer,
      0x70ui64,
      (unsigned __int64)m_buffer[-1].user.m_ptr,
      (void (__fastcall *)(void *))AgLeaderboardManager::StoreRankingEntry::~StoreRankingEntry);
    operator delete[](p_m_ptr, 112i64 * *p_m_ptr + 8);
  }
  this->m_buffer = 0i64;
}

void __fastcall AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int>::~AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int>(
        AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int> *this)
{
  AgLeaderboardManager::StoreRankingEntry *m_buffer; // rcx
  _QWORD *p_m_ptr; // rbx

  m_buffer = this->m_buffer;
  if ( m_buffer )
  {
    p_m_ptr = &m_buffer[-1].user.m_ptr;
    `eh vector destructor iterator'(
      m_buffer,
      0x70ui64,
      (unsigned __int64)m_buffer[-1].user.m_ptr,
      (void (__fastcall *)(void *))AgLeaderboardManager::StoreRankingEntry::~StoreRankingEntry);
    operator delete[](p_m_ptr, 112i64 * *p_m_ptr + 8);
  }
  this->m_buffer = 0i64;
}

void __fastcall AgSingleton<AgLeaderboardManager>::~AgSingleton<AgLeaderboardManager>(
        AgSingleton<AgLeaderboardManager> *this)
{
  this->__vftable = (AgSingleton<AgLeaderboardManager>_vtbl *)&AgSingleton<AgLeaderboardManager>::`vftable';
}

void __fastcall std::_Tree<std::_Tmap_traits<unsigned int,AgLeaderboard::RankingData,std::less<unsigned int>,std::allocator<std::pair<unsigned int const,AgLeaderboard::RankingData>>,0>>::~_Tree<std::_Tmap_traits<unsigned int,AgLeaderboard::RankingData,std::less<unsigned int>,std::allocator<std::pair<unsigned int const,AgLeaderboard::RankingData>>,0>>(
        std::_Tree<std::_Tmap_traits<unsigned int,AgLeaderboard::RankingData,std::less<unsigned int>,std::allocator<std::pair<unsigned int const ,AgLeaderboard::RankingData> >,0> > *this)
{
  std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<unsigned int const ,AgLeaderboard::RankingData> > > > result; // [rsp+48h] [rbp+10h] BYREF

  std::_Tree<std::_Tmap_traits<unsigned int,AgLeaderboard::RankingData,std::less<unsigned int>,std::allocator<std::pair<unsigned int const,AgLeaderboard::RankingData>>,0>>::erase(
    this,
    &result,
    (std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<unsigned int const ,AgLeaderboard::RankingData> > > >)this->_Mypair._Myval2._Myval2._Myhead->_Left,
    (std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<unsigned int const ,AgLeaderboard::RankingData> > > >)this->_Mypair._Myval2._Myval2._Myhead);
  operator delete(this->_Mypair._Myval2._Myval2._Myhead);
}

void __fastcall std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::~_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>(
        std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const ,unsigned int> >,0> > *this)
{
  std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > > result; // [rsp+48h] [rbp+10h] BYREF

  std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::erase(
    this,
    &result,
    (std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > >)this->_Mypair._Myval2._Myval2._Myhead->_Left,
    (std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > >)this->_Mypair._Myval2._Myval2._Myhead);
  operator delete(this->_Mypair._Myval2._Myval2._Myhead);
}

void __fastcall std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::~_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>(
        std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > >,0> > *this)
{
  std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > > result; // [rsp+48h] [rbp+10h] BYREF

  std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::erase(
    this,
    &result,
    (std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > >)this->_Mypair._Myval2._Myval2._Myhead->_Left,
    (std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > >)this->_Mypair._Myval2._Myval2._Myhead);
  operator delete(this->_Mypair._Myval2._Myval2._Myhead);
}

void __fastcall std::_Tree_comp_alloc<std::_Tmap_traits<unsigned int,AgLeaderboard::RankingData,std::less<unsigned int>,std::allocator<std::pair<unsigned int const,AgLeaderboard::RankingData>>,0>>::~_Tree_comp_alloc<std::_Tmap_traits<unsigned int,AgLeaderboard::RankingData,std::less<unsigned int>,std::allocator<std::pair<unsigned int const,AgLeaderboard::RankingData>>,0>>(
        std::_Tree_comp_alloc<std::_Tmap_traits<unsigned int,AgLeaderboard::RankingData,std::less<unsigned int>,std::allocator<std::pair<unsigned int const ,AgLeaderboard::RankingData> >,0> > *this)
{
  operator delete(this->_Mypair._Myval2._Myval2._Myhead);
}

void __fastcall std::_Tree_comp_alloc<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::~_Tree_comp_alloc<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>(
        std::_Tree_comp_alloc<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const ,unsigned int> >,0> > *this)
{
  operator delete(this->_Mypair._Myval2._Myval2._Myhead);
}

void __fastcall std::_Tree_comp_alloc<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::~_Tree_comp_alloc<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>(
        std::_Tree_comp_alloc<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > >,0> > *this)
{
  operator delete(this->_Mypair._Myval2._Myval2._Myhead);
}

void __fastcall std::map<unsigned int,AgLeaderboard::RankingData>::~map<unsigned int,AgLeaderboard::RankingData>(
        std::map<unsigned int,AgLeaderboard::RankingData> *this)
{
  std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<unsigned int const ,AgLeaderboard::RankingData> > > > result; // [rsp+48h] [rbp+10h] BYREF

  std::_Tree<std::_Tmap_traits<unsigned int,AgLeaderboard::RankingData,std::less<unsigned int>,std::allocator<std::pair<unsigned int const,AgLeaderboard::RankingData>>,0>>::erase(
    this,
    &result,
    (std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<unsigned int const ,AgLeaderboard::RankingData> > > >)this->_Mypair._Myval2._Myval2._Myhead->_Left,
    (std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<unsigned int const ,AgLeaderboard::RankingData> > > >)this->_Mypair._Myval2._Myval2._Myhead);
  operator delete(this->_Mypair._Myval2._Myval2._Myhead);
}

void __fastcall std::map<AgStringKey,unsigned int>::~map<AgStringKey,unsigned int>(
        std::map<AgStringKey,unsigned int> *this)
{
  std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > > result; // [rsp+48h] [rbp+10h] BYREF

  std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::erase(
    this,
    &result,
    (std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > >)this->_Mypair._Myval2._Myval2._Myhead->_Left,
    (std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > >)this->_Mypair._Myval2._Myval2._Myhead);
  operator delete(this->_Mypair._Myval2._Myval2._Myhead);
}

void __fastcall std::map<AgStringKey,AgPointer<AgLeaderboard>>::~map<AgStringKey,AgPointer<AgLeaderboard>>(
        std::map<AgStringKey,AgPointer<AgLeaderboard>> *this)
{
  std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > > result; // [rsp+48h] [rbp+10h] BYREF

  std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::erase(
    this,
    &result,
    (std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > >)this->_Mypair._Myval2._Myval2._Myhead->_Left,
    (std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > >)this->_Mypair._Myval2._Myval2._Myhead);
  operator delete(this->_Mypair._Myval2._Myval2._Myhead);
}

void __fastcall std::pair<AgStringKey const,unsigned int>::~pair<AgStringKey const,unsigned int>(
        std::pair<AgStringKey const ,unsigned int> *this,
        unsigned __int64 a2)
{
  AgString::~AgString(&this->first.m_string, a2);
}

void __fastcall std::pair<AgStringKey const,AgPointer<AgLeaderboard>>::~pair<AgStringKey const,AgPointer<AgLeaderboard>>(
        std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > *this)
{
  unsigned __int64 v2; // rdx

  AgPointer<AgLeaderboard>::~AgPointer<AgLeaderboard>(&this->second);
  AgString::~AgString(&this->first.m_string, v2);
}

void __fastcall std::vector<AgLeaderboardRanking *>::~vector<AgLeaderboardRanking *>(
        std::vector<AgLeaderboardRanking *> *this)
{
  if ( this->_Mypair._Myval2._Myfirst )
  {
    std::_Wrap_alloc<std::allocator<OGLShader *>>::deallocate(
      (std::allocator<AgLogger *> *)this,
      (AgLogger **)this->_Mypair._Myval2._Myfirst,
      this->_Mypair._Myval2._Myend - this->_Mypair._Myval2._Myfirst);
    this->_Mypair._Myval2._Myfirst = 0i64;
    this->_Mypair._Myval2._Mylast = 0i64;
    this->_Mypair._Myval2._Myend = 0i64;
  }
}

void __fastcall AgLeaderboard::~AgLeaderboard(AgLeaderboard *this)
{
  std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<unsigned int const ,AgLeaderboard::RankingData> > > > *p_m_rankings; // rbx
  unsigned __int64 v3; // rdx
  std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<unsigned int const ,AgLeaderboard::RankingData> > > > result; // [rsp+50h] [rbp+18h] BYREF

  this->__vftable = (AgLeaderboard_vtbl *)&AgLeaderboard::`vftable';
  p_m_rankings = (std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<unsigned int const ,AgLeaderboard::RankingData> > > > *)&this->m_rankings;
  std::_Tree<std::_Tmap_traits<unsigned int,AgLeaderboard::RankingData,std::less<unsigned int>,std::allocator<std::pair<unsigned int const,AgLeaderboard::RankingData>>,0>>::erase(
    &this->m_rankings,
    &result,
    (std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<unsigned int const ,AgLeaderboard::RankingData> > > >)p_m_rankings->_Ptr->_Left,
    (std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<unsigned int const ,AgLeaderboard::RankingData> > > >)p_m_rankings->_Ptr);
  operator delete(p_m_rankings->_Ptr);
  AgString::~AgString(&this->m_name, v3);
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_mutex);
}

void __fastcall AgLeaderboardManager::~AgLeaderboardManager(AgLeaderboardManager *this)
{
  AgRingBuffer<AgLeaderboardManager::StoreRankingEntry> *p_m_storeQueue; // rsi
  AgLeaderboardManager::StoreRankingEntry *m_buffer; // rcx
  _QWORD *p_m_ptr; // rbx
  std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > > result; // [rsp+60h] [rbp+18h] BYREF

  this->__vftable = (AgLeaderboardManager_vtbl *)&AgLeaderboardManager::`vftable';
  p_m_storeQueue = &this->m_storeQueue;
  m_buffer = this->m_storeQueue.m_buffer;
  if ( m_buffer )
  {
    p_m_ptr = &m_buffer[-1].user.m_ptr;
    `eh vector destructor iterator'(
      m_buffer,
      0x70ui64,
      (unsigned __int64)m_buffer[-1].user.m_ptr,
      (void (__fastcall *)(void *))AgLeaderboardManager::StoreRankingEntry::~StoreRankingEntry);
    operator delete[](p_m_ptr, 112i64 * *p_m_ptr + 8);
  }
  p_m_storeQueue->m_buffer = 0i64;
  std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::erase(
    &this->m_leaderboards,
    &result,
    (std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > >)this->m_leaderboards._Mypair._Myval2._Myval2._Myhead->_Left,
    (std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > >)this->m_leaderboards._Mypair._Myval2._Myval2._Myhead);
  operator delete(this->m_leaderboards._Mypair._Myval2._Myval2._Myhead);
  std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::erase(
    &this->m_leaderboardNames,
    (std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > > *)&result,
    (std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > >)this->m_leaderboardNames._Mypair._Myval2._Myval2._Myhead->_Left,
    (std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > >)this->m_leaderboardNames._Mypair._Myval2._Myval2._Myhead);
  operator delete(this->m_leaderboardNames._Mypair._Myval2._Myval2._Myhead);
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_mutex);
  this->__vftable = (AgLeaderboardManager_vtbl *)&AgSingleton<AgLeaderboardManager>::`vftable';
}

void __fastcall AgLeaderboardRanking::~AgLeaderboardRanking(AgLeaderboardRanking *this)
{
  unsigned __int64 v2; // rdx

  AgPointer<AgBuffer<AgAllocator<1>>>::~AgPointer<AgBuffer<AgAllocator<1>>>(&this->m_data);
  AgString::~AgString(&this->m_comment, v2);
}

void __fastcall AgLeaderboard::RankingData::~RankingData(AgLeaderboard::RankingData *this)
{
  unsigned __int64 v2; // rdx

  AgPointer<AgBuffer<AgAllocator<1>>>::~AgPointer<AgBuffer<AgAllocator<1>>>(&this->score.m_data);
  AgString::~AgString(&this->score.m_comment, v2);
}

void __fastcall SerializeStoreQueuePredicate::~SerializeStoreQueuePredicate(SerializeStoreQueuePredicate *this)
{
  AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)this);
}

void __fastcall AgLeaderboardManager::StoreRankingEntry::~StoreRankingEntry(
        AgLeaderboardManager::StoreRankingEntry *this)
{
  unsigned __int64 v2; // rdx
  unsigned __int64 v3; // rdx

  AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)&this->user);
  AgPointer<AgBuffer<AgAllocator<1>>>::~AgPointer<AgBuffer<AgAllocator<1>>>(&this->score.m_data);
  AgString::~AgString(&this->score.m_comment, v2);
  AgPointer<AgLeaderboard>::~AgPointer<AgLeaderboard>(&this->leaderboard);
  AgString::~AgString(&this->leaderboardName, v3);
}

void __fastcall AgDefaultLeaderboardManager::operator delete(void *data)
{
  aligned_free(data);
}

AgPointer<AgBuffer<AgAllocator<1> > > *__fastcall AgPointer<AgBuffer<AgAllocator<1>>>::operator=(
        AgPointer<AgBuffer<AgAllocator<1> > > *this,
        const AgPointer<AgBuffer<AgAllocator<1> > > *rhs)
{
  AgReferenceCount *m_ref; // rdi
  int m_strongCount; // ebx
  AgReferenceCount *v6; // rbx
  AgBuffer<AgAllocator<1> > *m_ptr; // rdi
  int v8; // ebp
  AgPointer<AgBuffer<AgAllocator<1> > > v10; // [rsp+28h] [rbp-20h]

  v10 = 0i64;
  m_ref = rhs->m_ref;
  if ( rhs->m_ref )
  {
    m_strongCount = m_ref->m_strongCount;
    if ( m_ref->m_strongCount )
    {
      while ( (unsigned int)AgAtomicCompareExchange(&m_ref->m_strongCount, m_strongCount, m_strongCount + 1) != m_strongCount )
      {
        m_strongCount = m_ref->m_strongCount;
        if ( !m_ref->m_strongCount )
          goto LABEL_8;
      }
      if ( m_strongCount != -1 )
        v10 = *rhs;
    }
  }
LABEL_8:
  v6 = this->m_ref;
  m_ptr = this->m_ptr;
  *this = v10;
  if ( v6 )
  {
    v8 = 0;
    if ( !(unsigned int)AgAtomicDecrement(&v6->m_strongCount) )
    {
      if ( !(unsigned int)AgAtomicDecrement(&v6->m_weakCount) )
        v8 = 1;
      v6->m_data = 0i64;
      if ( m_ptr )
        ((void (__fastcall *)(AgBuffer<AgAllocator<1> > *, __int64))m_ptr->~AgBuffer<AgAllocator<1> >)(m_ptr, 1i64);
      if ( v8 )
        AgReferenceCount::operator delete(v6);
    }
  }
  return this;
}

AgPointer<AgBuffer<AgAllocator<1> > > *__fastcall AgPointer<AgBuffer<AgAllocator<1>>>::operator=(
        AgPointer<AgBuffer<AgAllocator<1> > > *this,
        AgBuffer<AgAllocator<1> > *t)
{
  AgBuffer<AgAllocator<1> > *v2; // rdi
  AgReferenceCount *v4; // rax
  int v5; // eax
  AgReferenceCount *m_refCount; // rbp
  AgReferenceCount *m_ref; // rsi
  AgBuffer<AgAllocator<1> > *m_ptr; // r14
  int v9; // edi

  v2 = t;
  if ( t )
  {
    if ( t->m_refCount )
    {
      v5 = 0;
    }
    else
    {
      v4 = (AgReferenceCount *)AgReferenceCount::operator new(0x10ui64);
      if ( v4 )
      {
        v4->m_strongCount = 1;
        v4->m_weakCount = 1;
        v4->m_data = v2;
      }
      v2->m_refCount = v4;
      v5 = 1;
    }
    m_refCount = v2->m_refCount;
    if ( !v5 )
      AgReferenceCount::incRef(v2->m_refCount);
  }
  else
  {
    v2 = 0i64;
    m_refCount = 0i64;
  }
  m_ref = this->m_ref;
  m_ptr = this->m_ptr;
  this->m_ref = m_refCount;
  this->m_ptr = v2;
  if ( m_ref )
  {
    v9 = 0;
    if ( !(unsigned int)AgAtomicDecrement(&m_ref->m_strongCount) )
    {
      if ( !(unsigned int)AgAtomicDecrement(&m_ref->m_weakCount) )
        v9 = 1;
      m_ref->m_data = 0i64;
      if ( m_ptr )
        ((void (__fastcall *)(AgBuffer<AgAllocator<1> > *, __int64))m_ptr->~AgBuffer<AgAllocator<1> >)(m_ptr, 1i64);
      if ( v9 )
        AgReferenceCount::operator delete(m_ref);
    }
  }
  return this;
}

AgPointer<AgLeaderboard> *__fastcall AgPointer<AgLeaderboard>::operator=(
        AgPointer<AgLeaderboard> *this,
        AgPointer<AgLeaderboard> *rhs)
{
  AgReferenceCount *m_ref; // r8
  AgLeaderboard *m_ptr; // rax
  AgReferenceCount *v5; // rdi
  AgLeaderboard *v6; // rsi
  int v7; // ebp

  m_ref = rhs->m_ref;
  m_ptr = rhs->m_ptr;
  rhs->m_ref = 0i64;
  rhs->m_ptr = 0i64;
  v5 = this->m_ref;
  v6 = this->m_ptr;
  this->m_ref = m_ref;
  this->m_ptr = m_ptr;
  if ( v5 )
  {
    v7 = 0;
    if ( !(unsigned int)AgAtomicDecrement(&v5->m_strongCount) )
    {
      if ( !(unsigned int)AgAtomicDecrement(&v5->m_weakCount) )
        v7 = 1;
      v5->m_data = 0i64;
      if ( v6 )
        ((void (__fastcall *)(AgLeaderboard *, __int64))v6->~AgLeaderboard)(v6, 1i64);
      if ( v7 )
        AgReferenceCount::operator delete(v5);
    }
  }
  return this;
}

AgPointer<AgLeaderboard> *__fastcall AgPointer<AgLeaderboard>::operator=(
        AgPointer<AgLeaderboard> *this,
        const AgPointer<AgLeaderboard> *rhs)
{
  AgReferenceCount *m_ref; // rdi
  int m_strongCount; // ebx
  AgReferenceCount *v6; // rbx
  AgLeaderboard *m_ptr; // rdi
  int v8; // ebp
  AgPointer<AgLeaderboard> v10; // [rsp+28h] [rbp-20h]

  v10 = 0i64;
  m_ref = rhs->m_ref;
  if ( rhs->m_ref )
  {
    m_strongCount = m_ref->m_strongCount;
    if ( m_ref->m_strongCount )
    {
      while ( (unsigned int)AgAtomicCompareExchange(&m_ref->m_strongCount, m_strongCount, m_strongCount + 1) != m_strongCount )
      {
        m_strongCount = m_ref->m_strongCount;
        if ( !m_ref->m_strongCount )
          goto LABEL_8;
      }
      if ( m_strongCount != -1 )
        v10 = *rhs;
    }
  }
LABEL_8:
  v6 = this->m_ref;
  m_ptr = this->m_ptr;
  *this = v10;
  if ( v6 )
  {
    v8 = 0;
    if ( !(unsigned int)AgAtomicDecrement(&v6->m_strongCount) )
    {
      if ( !(unsigned int)AgAtomicDecrement(&v6->m_weakCount) )
        v8 = 1;
      v6->m_data = 0i64;
      if ( m_ptr )
        ((void (__fastcall *)(AgLeaderboard *, __int64))m_ptr->~AgLeaderboard)(m_ptr, 1i64);
      if ( v8 )
        AgReferenceCount::operator delete(v6);
    }
  }
  return this;
}

std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<__int64 const ,AgPointer<AgUser> > > > > *__fastcall std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>>>::operator++(
        std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<__int64 const ,AgPointer<AgUser> > > > > *this)
{
  std::_Tree_node<std::pair<__int64 const ,AgPointer<AgUser> >,void *> *Ptr; // rax
  std::_Tree_node<std::pair<__int64 const ,AgPointer<AgUser> >,void *> *Right; // rcx
  std::_Tree_node<std::pair<__int64 const ,AgPointer<AgUser> >,void *> *j; // rax
  std::_Tree_node<std::pair<__int64 const ,AgPointer<AgUser> >,void *> *i; // rax

  Ptr = this->_Ptr;
  if ( this->_Ptr->_Isnil )
    return this;
  Right = Ptr->_Right;
  if ( Right->_Isnil )
  {
    for ( i = Ptr->_Parent; !i->_Isnil; i = i->_Parent )
    {
      if ( this->_Ptr != i->_Right )
        break;
      this->_Ptr = i;
    }
    this->_Ptr = i;
    return this;
  }
  for ( j = Right->_Left; !j->_Isnil; j = j->_Left )
    Right = j;
  this->_Ptr = Right;
  return this;
}

__int64 __fastcall SerializeStoreQueuePredicate::operator()(
        SerializeStoreQueuePredicate *this,
        const AgLeaderboardManager::StoreRankingEntry *entry)
{
  AgStream *m_ptr; // rdi
  AgStream_vtbl *v5; // rsi
  int v6; // ebx
  __ExceptionPtr *CString; // rax
  AgStream *v8; // rdi
  AgStream_vtbl *v9; // rsi
  int v10; // ebx
  __ExceptionPtr *v11; // rax
  AgBuffer<AgAllocator<1> > *v12; // rax
  AgBuffer<AgAllocator<1> > *v13; // rdi
  unsigned __int64 v14; // rdx
  AgBuffer<AgAllocator<1> > *v15; // rsi
  AgReferenceCount *m_ref; // rdi
  int v17; // er14
  __int64 v19[3]; // [rsp+20h] [rbp-58h] BYREF
  AgPointer<AgBuffer<AgAllocator<1> > > result; // [rsp+38h] [rbp-40h] BYREF
  AgStringRef v21; // [rsp+48h] [rbp-30h] BYREF
  std::shared_ptr<__ExceptionPtr> v22[2]; // [rsp+58h] [rbp-20h] BYREF
  unsigned __int64 size; // [rsp+B0h] [rbp+38h] BYREF
  int IsStopping; // [rsp+B8h] [rbp+40h] BYREF
  int v25; // [rsp+C0h] [rbp+48h] BYREF
  int retryCount; // [rsp+C8h] [rbp+50h] BYREF

  v19[1] = -2i64;
  AgStringRef::AgStringRef(&v21, &entry->leaderboardName);
  IsStopping = AgSimpleThreadHost::getThreadIsStopping((Concurrency::details::ThreadProxyFactory<Concurrency::details::FreeThreadProxy> *)&v21);
  this->m_stream.m_ptr->write(this->m_stream.m_ptr, (const unsigned __int8 *)&IsStopping, 4u);
  m_ptr = this->m_stream.m_ptr;
  v5 = m_ptr->__vftable;
  v6 = IsStopping;
  CString = AgStringRef::getCString((std::shared_ptr<__ExceptionPtr> *)&v21);
  v5->write(m_ptr, (const unsigned __int8 *)CString, v6 + 1);
  v19[0] = entry->score.m_score;
  this->m_stream.m_ptr->write(this->m_stream.m_ptr, (const unsigned __int8 *)v19, 8u);
  AgStringRef::AgStringRef((AgStringRef *)v22, &entry->score.m_comment);
  v25 = AgSimpleThreadHost::getThreadIsStopping((Concurrency::details::ThreadProxyFactory<Concurrency::details::FreeThreadProxy> *)v22);
  this->m_stream.m_ptr->write(this->m_stream.m_ptr, (const unsigned __int8 *)&v25, 4u);
  v8 = this->m_stream.m_ptr;
  v9 = v8->__vftable;
  v10 = v25;
  v11 = AgStringRef::getCString(v22);
  v9->write(v8, (const unsigned __int8 *)v11, v10 + 1);
  AgLeaderboardRanking::getData(&entry->score, &result);
  LODWORD(size) = result.m_ptr->m_size;
  this->m_stream.m_ptr->write(this->m_stream.m_ptr, (const unsigned __int8 *)&size, 4u);
  v12 = (AgBuffer<AgAllocator<1> > *)operator new(0x30ui64);
  v13 = v12;
  v19[2] = (__int64)v12;
  if ( v12 )
  {
    v14 = (unsigned int)size;
    v12->m_refCount = 0i64;
    v12->__vftable = (AgBuffer<AgAllocator<1> >_vtbl *)&AgBuffer<AgAllocator<1>>::`vftable';
    v12->m_data = 0i64;
    v12->m_size = 0i64;
    v12->m_alignment = 0i64;
    v12->m_flags = 7;
    AgBuffer<AgAllocator<1>>::reset(v12, v14);
  }
  else
  {
    v13 = 0i64;
  }
  AgPointer<AgBuffer<AgAllocator<1>>>::operator=(&result, v13);
  this->m_stream.m_ptr->write(this->m_stream.m_ptr, result.m_ptr->m_data, size);
  retryCount = entry->retryCount;
  this->m_stream.m_ptr->write(this->m_stream.m_ptr, (const unsigned __int8 *)&retryCount, 4u);
  v15 = result.m_ptr;
  result.m_ptr = 0i64;
  m_ref = result.m_ref;
  if ( result.m_ref )
  {
    result.m_ref = 0i64;
    v17 = 0;
    if ( !(unsigned int)AgAtomicDecrement(&m_ref->m_strongCount) )
    {
      if ( !(unsigned int)AgAtomicDecrement(&m_ref->m_weakCount) )
        v17 = 1;
      m_ref->m_data = 0i64;
      if ( v15 )
        ((void (__fastcall *)(AgBuffer<AgAllocator<1> > *, __int64))v15->~AgBuffer<AgAllocator<1> >)(v15, 1i64);
      if ( v17 )
        AgReferenceCount::operator delete(m_ref);
    }
  }
  return 1i64;
}

std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *__fastcall std::_Tree_comp_alloc<std::_Tmap_traits<unsigned int,AgLeaderboard::RankingData,std::less<unsigned int>,std::allocator<std::pair<unsigned int const,AgLeaderboard::RankingData>>,0>>::_Buyheadnode(
        std::_Tree_comp_alloc<std::_Tmap_traits<unsigned int,AgLeaderboard::RankingData,std::less<unsigned int>,std::allocator<std::pair<unsigned int const ,AgLeaderboard::RankingData> >,0> > *this)
{
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *result; // rax

  result = (std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *)operator new(0x68ui64);
  if ( !result )
    invalid_parameter_noinfo_noreturn();
  result->_Left = result;
  if ( result != (std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *)-8i64 )
    result->_Parent = result;
  if ( result != (std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *)-16i64 )
    result->_Right = result;
  *(_WORD *)&result->_Color = 257;
  return result;
}

std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *__fastcall std::_Tree_comp_alloc<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::_Buyheadnode(
        std::_Tree_comp_alloc<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const ,unsigned int> >,0> > *this)
{
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *result; // rax

  result = (std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *)operator new(0x48ui64);
  if ( !result )
    invalid_parameter_noinfo_noreturn();
  result->_Left = result;
  if ( result != (std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *)-8i64 )
    result->_Parent = result;
  if ( result != (std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *)-16i64 )
    result->_Right = result;
  *(_WORD *)&result->_Color = 257;
  return result;
}

std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *__fastcall std::_Tree_comp_alloc<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::_Buyheadnode(
        std::_Tree_comp_alloc<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > >,0> > *this)
{
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *result; // rax

  result = (std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *)operator new(0x50ui64);
  if ( !result )
    invalid_parameter_noinfo_noreturn();
  result->_Left = result;
  if ( result != (std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *)-8i64 )
    result->_Parent = result;
  if ( result != (std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *)-16i64 )
    result->_Right = result;
  *(_WORD *)&result->_Color = 257;
  return result;
}

std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> **__fastcall std::_Tree_comp_alloc<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::_Buynode0(
        std::_Tree_comp_alloc<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const ,unsigned int> >,0> > *this)
{
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> **v2; // rdx

  v2 = (std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> **)operator new(0x48ui64);
  if ( !v2 )
    invalid_parameter_noinfo_noreturn();
  *v2 = this->_Mypair._Myval2._Myval2._Myhead;
  if ( v2 != (std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> **)-8i64 )
    v2[1] = this->_Mypair._Myval2._Myval2._Myhead;
  if ( v2 != (std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> **)-16i64 )
    v2[2] = this->_Mypair._Myval2._Myval2._Myhead;
  return v2;
}

std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> **__fastcall std::_Tree_comp_alloc<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::_Buynode0(
        std::_Tree_comp_alloc<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > >,0> > *this)
{
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> **v2; // rdx

  v2 = (std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> **)operator new(0x50ui64);
  if ( !v2 )
    invalid_parameter_noinfo_noreturn();
  *v2 = this->_Mypair._Myval2._Myval2._Myhead;
  if ( v2 != (std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> **)-8i64 )
    v2[1] = this->_Mypair._Myval2._Myval2._Myhead;
  if ( v2 != (std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> **)-16i64 )
    v2[2] = this->_Mypair._Myval2._Myval2._Myhead;
  return v2;
}

void __fastcall std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::_Destroy_if_not_nil(
        std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const ,unsigned int> >,0> > *this,
        std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *_Newnode)
{
  AgString::~AgString(&_Newnode->_Myval.first.m_string, (unsigned __int64)_Newnode);
  operator delete(_Newnode);
}

void __fastcall std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::_Destroy_if_not_nil(
        std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > >,0> > *this,
        std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *_Newnode)
{
  std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > *p_Myval; // rbx
  unsigned __int64 v4; // rdx

  p_Myval = &_Newnode->_Myval;
  AgPointer<AgLeaderboard>::~AgPointer<AgLeaderboard>(&_Newnode->_Myval.second);
  AgString::~AgString(&p_Myval->first.m_string, v4);
  operator delete(_Newnode);
}

void __fastcall std::_Tree<std::_Tmap_traits<unsigned int,AgLeaderboard::RankingData,std::less<unsigned int>,std::allocator<std::pair<unsigned int const,AgLeaderboard::RankingData>>,0>>::_Erase(
        std::_Tree<std::_Tmap_traits<unsigned int,AgLeaderboard::RankingData,std::less<unsigned int>,std::allocator<std::pair<unsigned int const ,AgLeaderboard::RankingData> >,0> > *this,
        std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *_Rootnode)
{
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *v2; // rsi
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *i; // rdi
  unsigned __int64 v5; // rdx

  v2 = _Rootnode;
  for ( i = _Rootnode; !i->_Isnil; v2 = i )
  {
    std::_Tree<std::_Tmap_traits<unsigned int,AgLeaderboard::RankingData,std::less<unsigned int>,std::allocator<std::pair<unsigned int const,AgLeaderboard::RankingData>>,0>>::_Erase(
      this,
      i->_Right);
    i = i->_Left;
    AgPointer<AgBuffer<AgAllocator<1>>>::~AgPointer<AgBuffer<AgAllocator<1>>>(&v2->_Myval.second.score.m_data);
    AgString::~AgString(&v2->_Myval.second.score.m_comment, v5);
    operator delete(v2);
  }
}

void __fastcall std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::_Erase(
        std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const ,unsigned int> >,0> > *this,
        std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *_Rootnode)
{
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *v2; // rdi
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *i; // rbx
  unsigned __int64 v5; // rdx

  v2 = _Rootnode;
  for ( i = _Rootnode; !i->_Isnil; v2 = i )
  {
    std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::_Erase(
      this,
      i->_Right);
    i = i->_Left;
    AgString::~AgString(&v2->_Myval.first.m_string, v5);
    operator delete(v2);
  }
}

void __fastcall std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::_Erase(
        std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > >,0> > *this,
        std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *_Rootnode)
{
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v2; // rsi
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *i; // rbx
  unsigned __int64 v5; // rdx

  v2 = _Rootnode;
  for ( i = _Rootnode; !i->_Isnil; v2 = i )
  {
    std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::_Erase(
      this,
      i->_Right);
    i = i->_Left;
    AgPointer<AgLeaderboard>::~AgPointer<AgLeaderboard>(&v2->_Myval.second);
    AgString::~AgString(&v2->_Myval.first.m_string, v5);
    operator delete(v2);
  }
}

void __fastcall std::_Tree<std::_Tmap_traits<AgControllerUID,FighterOperationMapper,std::less<AgControllerUID>,std::allocator<std::pair<AgControllerUID const,FighterOperationMapper>>,0>>::_Lrotate(
        std::_Tree<std::_Tmap_traits<AgStringRef,AgJsonNode,std::less<AgStringRef>,std::allocator<std::pair<AgStringRef const ,AgJsonNode> >,0> > *this,
        std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *_Wherenode)
{
  std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *Right; // r8
  std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *Parent; // rax

  Right = _Wherenode->_Right;
  _Wherenode->_Right = Right->_Left;
  if ( !Right->_Left->_Isnil )
    Right->_Left->_Parent = _Wherenode;
  Right->_Parent = _Wherenode->_Parent;
  if ( _Wherenode == this->_Mypair._Myval2._Myval2._Myhead->_Parent )
  {
    this->_Mypair._Myval2._Myval2._Myhead->_Parent = Right;
    Right->_Left = _Wherenode;
    _Wherenode->_Parent = Right;
  }
  else
  {
    Parent = _Wherenode->_Parent;
    if ( _Wherenode == Parent->_Left )
      Parent->_Left = Right;
    else
      Parent->_Right = Right;
    Right->_Left = _Wherenode;
    _Wherenode->_Parent = Right;
  }
}

void __fastcall std::_Tree<std::_Tmap_traits<enum AgControllerComponentType,std::list<AgControllerComponent *>,std::less<enum AgControllerComponentType>,std::allocator<std::pair<enum AgControllerComponentType const,std::list<AgControllerComponent *>>>,0>>::_Rrotate(
        std::_Tree<std::_Tmap_traits<AgStringRef,AgJsonNode,std::less<AgStringRef>,std::allocator<std::pair<AgStringRef const ,AgJsonNode> >,0> > *this,
        std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *_Wherenode)
{
  std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *Left; // r8
  std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *Right; // rax
  std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *Parent; // rax

  Left = _Wherenode->_Left;
  _Wherenode->_Left = _Wherenode->_Left->_Right;
  Right = Left->_Right;
  if ( !Right->_Isnil )
    Right->_Parent = _Wherenode;
  Left->_Parent = _Wherenode->_Parent;
  if ( _Wherenode == this->_Mypair._Myval2._Myval2._Myhead->_Parent )
  {
    this->_Mypair._Myval2._Myval2._Myhead->_Parent = Left;
    Left->_Right = _Wherenode;
    _Wherenode->_Parent = Left;
  }
  else
  {
    Parent = _Wherenode->_Parent;
    if ( _Wherenode == Parent->_Right )
      Parent->_Right = Left;
    else
      Parent->_Left = Left;
    Left->_Right = _Wherenode;
    _Wherenode->_Parent = Left;
  }
}

AgPointer<AgLeaderboard> *__fastcall AgDefaultLeaderboardManager::_create(
        AgDefaultLeaderboardManager *this,
        AgPointer<AgLeaderboard> *result,
        AgStringRef *name)
{
  char *v5; // rax
  char *v6; // rdi
  AgStringRef copy; // [rsp+30h] [rbp-28h] BYREF

  v5 = (char *)operator new(0x60ui64);
  v6 = v5;
  if ( v5 )
  {
    copy = *name;
    *((_QWORD *)v5 + 1) = 0i64;
    *(_QWORD *)v5 = &AgLeaderboard::`vftable';
    InitializeCriticalSection((LPCRITICAL_SECTION)(v5 + 16));
    AgString::AgString((AgString *)(v6 + 56), &copy);
    *((_DWORD *)v6 + 18) = 0;
    copy.m_text = v6 + 80;
    *((_QWORD *)v6 + 10) = 0i64;
    *((_QWORD *)v6 + 11) = 0i64;
    *((_QWORD *)v6 + 10) = std::_Tree_comp_alloc<std::_Tmap_traits<unsigned int,AgLeaderboard::RankingData,std::less<unsigned int>,std::allocator<std::pair<unsigned int const,AgLeaderboard::RankingData>>,0>>::_Buyheadnode(
                             (std::_Tree_comp_alloc<std::_Tmap_traits<unsigned int,AgLeaderboard::RankingData,std::less<unsigned int>,std::allocator<std::pair<unsigned int const ,AgLeaderboard::RankingData> >,0> > *)v6
                           + 5);
    *(_QWORD *)v6 = &AgDefaultLeaderboard::`vftable';
  }
  else
  {
    v6 = 0i64;
  }
  AgPointer<AgLeaderboard>::AgPointer<AgLeaderboard>(result, (AgLeaderboard *)v6);
  return result;
}

void __fastcall AgLeaderboardManager::_queueStoreRanking(
        AgLeaderboardManager *this,
        AgStringRef *leaderboardName,
        const AgLeaderboardRanking *score,
        AgPointer<AgUser> *user,
        int retryCount)
{
  AgMutex *p_m_mutex; // r15
  AgLeaderboardManager::StoreRankingEntry *v10; // rax
  unsigned __int64 v11; // rdx
  unsigned __int64 v12; // rdx
  unsigned __int64 v13; // rdx
  unsigned __int64 v14; // rdx
  AgLeaderboardManager::StoreRankingEntry __that; // [rsp+30h] [rbp-D0h] BYREF
  AgLeaderboardManager::StoreRankingEntry items; // [rsp+A0h] [rbp-60h] BYREF
  __int64 v17; // [rsp+110h] [rbp+10h]
  AgLeaderboardManager::StoreRankingEntry v18; // [rsp+118h] [rbp+18h] BYREF

  v17 = -2i64;
  p_m_mutex = &this->m_mutex;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_mutex);
  AgLeaderboardManager::StoreRankingEntry::StoreRankingEntry(&__that);
  __that.requestId = this->m_requestId;
  this->m_requestId = __that.requestId + 1;
  __that.retryCount = retryCount;
  AgString::operator=(&__that.leaderboardName, leaderboardName);
  __that.score.m_profileId = score->m_profileId;
  __that.score.m_rank = score->m_rank;
  __that.score.m_score = score->m_score;
  AgString::operator=(&__that.score.m_comment, &score->m_comment);
  AgPointer<AgBuffer<AgAllocator<1>>>::operator=(&__that.score.m_data, &score->m_data);
  AgPointer<AgUser>::operator=(&__that.user, user);
  items.requestId = __that.requestId;
  items.retryCount = __that.retryCount;
  AgString::AgString(&items.leaderboardName, &__that.leaderboardName);
  AgPointer<AgBuffer<AgAllocator<1>>>::AgPointer<AgBuffer<AgAllocator<1>>>(
    (AgPointer<AgPlayer> *)&items.leaderboard,
    (const AgPointer<AgPlayer> *)&__that.leaderboard);
  items.score.m_profileId = __that.score.m_profileId;
  items.score.m_rank = __that.score.m_rank;
  items.score.m_score = __that.score.m_score;
  AgString::AgString(&items.score.m_comment, &__that.score.m_comment);
  AgPointer<AgBuffer<AgAllocator<1>>>::AgPointer<AgBuffer<AgAllocator<1>>>(
    (AgPointer<AgPlayer> *)&items.score.m_data,
    (const AgPointer<AgPlayer> *)&__that.score.m_data);
  AgPointer<AgBuffer<AgAllocator<1>>>::AgPointer<AgBuffer<AgAllocator<1>>>(
    (AgPointer<AgPlayer> *)&items.user,
    (const AgPointer<AgPlayer> *)&__that.user);
  if ( !AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int>::push(&this->m_storeQueue, &items) )
  {
    AgLeaderboardManager::StoreRankingEntry::StoreRankingEntry(&items);
    AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int>::pop(&this->m_storeQueue, &items, 1u);
    AgTrace("Replacing old queued store ranking entry");
    AgLeaderboardManager::StoreRankingEntry::StoreRankingEntry(&v18, &__that);
    AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int>::push(&this->m_storeQueue, v10);
    AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)&items.user);
    AgPointer<AgBuffer<AgAllocator<1>>>::~AgPointer<AgBuffer<AgAllocator<1>>>(&items.score.m_data);
    AgString::~AgString(&items.score.m_comment, v11);
    AgPointer<AgLeaderboard>::~AgPointer<AgLeaderboard>(&items.leaderboard);
    AgString::~AgString(&items.leaderboardName, v12);
  }
  this->m_cacheStoreQueue = 1;
  AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)&__that.user);
  AgPointer<AgBuffer<AgAllocator<1>>>::~AgPointer<AgBuffer<AgAllocator<1>>>(&__that.score.m_data);
  AgString::~AgString(&__that.score.m_comment, v13);
  AgPointer<AgLeaderboard>::~AgPointer<AgLeaderboard>(&__that.leaderboard);
  AgString::~AgString(&__that.leaderboardName, v14);
  LeaveCriticalSection((LPCRITICAL_SECTION)p_m_mutex);
  AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)user);
}

AgJobCompletion *__fastcall AgDefaultLeaderboard::_storeRankingAsync(
        AgDefaultLeaderboard *this,
        AgJobCompletion *result,
        int requestId,
        const AgLeaderboardRanking *score,
        AgPointer<AgUser> *user)
{
  result->m_threadPool = 0i64;
  result->m_jobId = 0;
  AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)user);
  return result;
}

AgLeaderboardManager *__fastcall AgLeaderboardManager::createSingleton()
{
  AgLeaderboardManager *v0; // rax
  _QWORD *v1; // rbx

  v0 = (AgLeaderboardManager *)aligned_malloc(0x180ui64, 0x40ui64);
  v1 = &v0->__vftable;
  if ( !v0 )
    return 0i64;
  AgLeaderboardManager::AgLeaderboardManager(v0);
  *v1 = &AgDefaultLeaderboardManager::`vftable';
  return (AgLeaderboardManager *)v1;
}

void __fastcall std::_Wrap_alloc<std::allocator<OGLShader *>>::deallocate(
        std::allocator<AgLogger *> *this,
        AgLogger **_Ptr,
        unsigned __int64 _Count)
{
  AgLogger **v3; // rax
  char *v4; // rdx

  if ( _Count > 0x1FFFFFFFFFFFFFFFi64 )
    invalid_parameter_noinfo_noreturn();
  if ( 8 * _Count >= 0x1000 )
  {
    if ( ((unsigned __int8)_Ptr & 0x1F) != 0 )
      invalid_parameter_noinfo_noreturn();
    v3 = (AgLogger **)*(_Ptr - 1);
    if ( v3 >= _Ptr )
      invalid_parameter_noinfo_noreturn();
    v4 = (char *)((char *)_Ptr - (char *)v3);
    if ( (unsigned __int64)v4 < 8 )
      invalid_parameter_noinfo_noreturn();
    if ( (unsigned __int64)v4 > 0x27 )
      invalid_parameter_noinfo_noreturn();
    _Ptr = v3;
  }
  operator delete(_Ptr);
}

__int64 __fastcall AgLeaderboardManager::deserialize(AgLeaderboardManager *this, AgPointer<AgStream> *stream)
{
  AgLeaderboardManager *v3; // r13
  int v4; // er14
  unsigned int v5; // er12
  AgStream *m_ptr; // rdi
  AgStream_vtbl *v7; // rsi
  unsigned int v8; // ebx
  char *CString; // rax
  AgStringRef *v10; // rax
  unsigned int v11; // ebx
  unsigned __int64 v12; // rdx
  unsigned __int64 v13; // rdx
  unsigned int v14; // er12
  AgStream *v15; // rdi
  AgStream_vtbl *v16; // rsi
  unsigned int v17; // ebx
  char *v18; // rax
  AgStream *v19; // rdi
  AgStream_vtbl *v20; // rsi
  unsigned int v21; // ebx
  char *v22; // rax
  AgBuffer<AgAllocator<1> > *v23; // rax
  AgBuffer<AgAllocator<1> > *v24; // rbx
  unsigned __int64 v25; // rdi
  unsigned __int8 *v26; // rax
  AgReferenceCount *m_ref; // rbx
  int m_strongCount; // edi
  AgStringRef *v29; // rax
  volatile int *v30; // rdi
  int v31; // ebx
  AgStringRef *v32; // rax
  unsigned __int64 v33; // rdx
  unsigned __int64 v34; // rdx
  AgBuffer<AgAllocator<1> > *v35; // rdi
  unsigned __int64 v36; // rdx
  unsigned int v38; // [rsp+30h] [rbp-D0h] BYREF
  unsigned int v39; // [rsp+34h] [rbp-CCh] BYREF
  unsigned int size; // [rsp+38h] [rbp-C8h] BYREF
  unsigned int size_4; // [rsp+3Ch] [rbp-C4h] BYREF
  AgPointer<AgBuffer<AgAllocator<1> > > v42; // [rsp+40h] [rbp-C0h] BYREF
  unsigned int v43; // [rsp+50h] [rbp-B0h] BYREF
  volatile int *value[2]; // [rsp+58h] [rbp-A8h] BYREF
  int v45; // [rsp+68h] [rbp-98h] BYREF
  AgString str; // [rsp+70h] [rbp-90h] BYREF
  AgString v47; // [rsp+80h] [rbp-80h] BYREF
  AgString v48; // [rsp+90h] [rbp-70h] BYREF
  __int64 v49; // [rsp+A0h] [rbp-60h] BYREF
  int v50; // [rsp+A8h] [rbp-58h]
  AgMutex *p_m_mutex; // [rsp+B0h] [rbp-50h]
  AgPointer<AgUser> v52; // [rsp+B8h] [rbp-48h] BYREF
  AgLeaderboardRanking v53; // [rsp+C8h] [rbp-38h] BYREF
  AgStringKey v54; // [rsp+100h] [rbp+0h] BYREF
  __int64 v55; // [rsp+120h] [rbp+20h]
  volatile int **v56; // [rsp+128h] [rbp+28h]
  AgBuffer<AgAllocator<1> > *v57; // [rsp+130h] [rbp+30h]
  AgPointer<AgUser> *v58; // [rsp+138h] [rbp+38h]
  volatile int **v59; // [rsp+140h] [rbp+40h]
  AgStringRef copy; // [rsp+150h] [rbp+50h] BYREF
  std::pair<std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > >,bool> result; // [rsp+160h] [rbp+60h] BYREF
  AgStringRef v62; // [rsp+170h] [rbp+70h] BYREF
  AgStringRef v63; // [rsp+180h] [rbp+80h] BYREF
  __int128 v64; // [rsp+190h] [rbp+90h]
  AgStringRef v65; // [rsp+1A0h] [rbp+A0h] BYREF
  AgStringRef v66; // [rsp+1B0h] [rbp+B0h] BYREF
  AgStringRef v67; // [rsp+1C0h] [rbp+C0h] BYREF
  unsigned int length; // [rsp+230h] [rbp+130h] BYREF
  unsigned int v70; // [rsp+238h] [rbp+138h] BYREF

  v55 = -2i64;
  v3 = this;
  v4 = 0;
  v70 = 0;
  stream->m_ptr->read(stream->m_ptr, (unsigned __int8 *)&v70, 4u);
  size_4 = 0;
  stream->m_ptr->read(stream->m_ptr, (unsigned __int8 *)&size_4, 4u);
  v5 = 0;
  if ( v70 )
  {
    do
    {
      AgString::AgString(&str);
      length = 0;
      stream->m_ptr->read(stream->m_ptr, (unsigned __int8 *)&length, 4u);
      AgString::setLength(&str, length);
      m_ptr = stream->m_ptr;
      v7 = m_ptr->__vftable;
      v8 = length;
      CString = AgString::getCString(&str);
      v7->read(m_ptr, (unsigned __int8 *)CString, v8 + 1);
      v43 = 0;
      stream->m_ptr->read(stream->m_ptr, (unsigned __int8 *)&v43, 4u);
      AgStringRef::AgStringRef(&v65, &str);
      copy = *v10;
      v11 = v43;
      v50 = 0;
      p_m_mutex = &v3->m_mutex;
      EnterCriticalSection((LPCRITICAL_SECTION)&v3->m_mutex);
      v50 = 1;
      AgString::AgString(&v54.m_string, &copy);
      AgStringRef::AgStringRef(&v54.m_stringRef, &v54.m_string);
      std::map<AgStringKey,unsigned int>::_Try_emplace<AgStringKey,>(&v3->m_leaderboardNames, &result, &v54);
      result.first._Ptr->_Myval.second = v11;
      AgString::~AgString(&v54.m_string, v12);
      LeaveCriticalSection((LPCRITICAL_SECTION)&v3->m_mutex);
      v50 = 0;
      AgString::~AgString(&str, v13);
      ++v5;
    }
    while ( v5 < v70 );
    v3 = this;
    v4 = 0;
  }
  v14 = 0;
  if ( size_4 )
  {
    v56 = value;
    do
    {
      AgString::AgString(&v48);
      v38 = 0;
      stream->m_ptr->read(stream->m_ptr, (unsigned __int8 *)&v38, 4u);
      AgString::setLength(&v48, v38);
      v15 = stream->m_ptr;
      v16 = v15->__vftable;
      v17 = v38;
      v18 = AgString::getCString(&v48);
      v16->read(v15, (unsigned __int8 *)v18, v17 + 1);
      stream->m_ptr->read(stream->m_ptr, (unsigned __int8 *)&v49, 8u);
      AgString::AgString(&v47);
      v39 = 0;
      stream->m_ptr->read(stream->m_ptr, (unsigned __int8 *)&v39, 4u);
      AgString::setLength(&v47, v39);
      v19 = stream->m_ptr;
      v20 = v19->__vftable;
      v21 = v39;
      v22 = AgString::getCString(&v47);
      v20->read(v19, (unsigned __int8 *)v22, v21 + 1);
      v42 = 0i64;
      size = 0;
      stream->m_ptr->read(stream->m_ptr, (unsigned __int8 *)&size, 4u);
      v23 = (AgBuffer<AgAllocator<1> > *)operator new(0x30ui64);
      v24 = v23;
      v57 = v23;
      if ( v23 )
      {
        v25 = size;
        v23->m_refCount = 0i64;
        v23->__vftable = (AgBuffer<AgAllocator<1> >_vtbl *)&AgBuffer<AgAllocator<1>>::`vftable';
        v23->m_data = 0i64;
        v23->m_size = 0i64;
        v23->m_alignment = 0i64;
        v23->m_flags = 7;
        if ( v25 )
          v26 = (unsigned __int8 *)AgAllocator<1>::allocate(&v23->m_allocator, (unsigned int)v25);
        else
          v26 = 0i64;
        v24->m_data = v26;
        v24->m_size = v25;
      }
      else
      {
        v24 = 0i64;
      }
      AgPointer<AgBuffer<AgAllocator<1>>>::operator=(&v42, v24);
      stream->m_ptr->read(stream->m_ptr, v42.m_ptr->m_data, size);
      v64 = 0i64;
      stream->m_ptr->read(stream->m_ptr, (unsigned __int8 *)&v45, 4u);
      v58 = &v52;
      v59 = value;
      v52 = 0i64;
      *(_OWORD *)value = 0i64;
      m_ref = v42.m_ref;
      if ( v42.m_ref )
      {
        m_strongCount = v42.m_ref->m_strongCount;
        if ( v42.m_ref->m_strongCount )
        {
          while ( 1 )
          {
            m_ref = v42.m_ref;
            if ( (unsigned int)AgAtomicCompareExchange(&v42.m_ref->m_strongCount, m_strongCount, m_strongCount + 1) == m_strongCount )
              break;
            m_strongCount = m_ref->m_strongCount;
            if ( !m_ref->m_strongCount )
              goto LABEL_19;
          }
          if ( m_strongCount != -1 )
          {
            value[0] = &m_ref->m_strongCount;
            value[1] = (volatile int *)v42.m_ptr;
          }
        }
        else
        {
LABEL_19:
          m_ref = v42.m_ref;
        }
      }
      AgStringRef::AgStringRef(&v66, &v47);
      v62 = *v29;
      v53.m_profileId = -1i64;
      v53.m_rank = 0;
      v53.m_score = v49;
      AgString::AgString(&v53.m_comment, &v62);
      v53.m_data = 0i64;
      v30 = value[0];
      if ( value[0] )
      {
        v31 = *value[0];
        if ( *value[0] )
        {
          while ( (unsigned int)AgAtomicCompareExchange(v30, v31, v31 + 1) != v31 )
          {
            v31 = *v30;
            if ( !*v30 )
              goto LABEL_27;
          }
          if ( v31 != -1 )
            v53.m_data = *(AgPointer<AgBuffer<AgAllocator<1> > > *)value;
        }
LABEL_27:
        m_ref = v42.m_ref;
      }
      AgPointer<AgBuffer<AgAllocator<1>>>::~AgPointer<AgBuffer<AgAllocator<1>>>((AgPointer<AgBuffer<AgAllocator<1> > > *)value);
      AgStringRef::AgStringRef(&v67, &v48);
      v63 = *v32;
      AgLeaderboardManager::_queueStoreRanking(v3, &v63, &v53, &v52, v45);
      AgPointer<AgBuffer<AgAllocator<1>>>::~AgPointer<AgBuffer<AgAllocator<1>>>(&v53.m_data);
      AgString::~AgString(&v53.m_comment, v33);
      *((_QWORD *)&v64 + 1) = 0i64;
      v35 = v42.m_ptr;
      v42.m_ptr = 0i64;
      if ( m_ref )
      {
        v42.m_ref = 0i64;
        if ( !(unsigned int)AgAtomicDecrement(&m_ref->m_strongCount) )
        {
          if ( !(unsigned int)AgAtomicDecrement(&m_ref->m_weakCount) )
            v4 = 1;
          m_ref->m_data = 0i64;
          if ( v35 )
            ((void (__fastcall *)(AgBuffer<AgAllocator<1> > *, __int64))v35->~AgBuffer<AgAllocator<1> >)(v35, 1i64);
          if ( v4 )
            AgReferenceCount::operator delete(m_ref);
        }
        v4 = 0;
      }
      AgString::~AgString(&v47, v34);
      AgString::~AgString(&v48, v36);
      ++v14;
    }
    while ( v14 < size_4 );
  }
  AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)stream);
  return 1i64;
}

std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<unsigned int const ,AgLeaderboard::RankingData> > > > *__fastcall std::_Tree<std::_Tmap_traits<unsigned int,AgLeaderboard::RankingData,std::less<unsigned int>,std::allocator<std::pair<unsigned int const,AgLeaderboard::RankingData>>,0>>::erase(
        std::_Tree<std::_Tmap_traits<unsigned int,AgLeaderboard::RankingData,std::less<unsigned int>,std::allocator<std::pair<unsigned int const ,AgLeaderboard::RankingData> >,0> > *this,
        std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<unsigned int const ,AgLeaderboard::RankingData> > > > *result,
        std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<unsigned int const ,AgLeaderboard::RankingData> > > > _First,
        std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<unsigned int const ,AgLeaderboard::RankingData> > > > _Last)
{
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *Myhead; // rdx
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *v7; // rax
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *Left; // rcx
  std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<unsigned int const ,AgLeaderboard::RankingData> > > > *v9; // rax
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *v10; // rax
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *Right; // rdx
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *j; // rcx
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *i; // rcx
  std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<unsigned int const ,AgLeaderboard::RankingData> > > > resulta; // [rsp+30h] [rbp+8h] BYREF
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *v15; // [rsp+40h] [rbp+18h]
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *Ptr; // [rsp+48h] [rbp+20h]

  Ptr = _Last._Ptr;
  v15 = _First._Ptr;
  Myhead = this->_Mypair._Myval2._Myval2._Myhead;
  if ( _First._Ptr == this->_Mypair._Myval2._Myval2._Myhead->_Left && _Last._Ptr == Myhead )
  {
    std::_Tree<std::_Tmap_traits<unsigned int,AgLeaderboard::RankingData,std::less<unsigned int>,std::allocator<std::pair<unsigned int const,AgLeaderboard::RankingData>>,0>>::_Erase(
      this,
      Myhead->_Parent);
    this->_Mypair._Myval2._Myval2._Myhead->_Parent = this->_Mypair._Myval2._Myval2._Myhead;
    this->_Mypair._Myval2._Myval2._Myhead->_Left = this->_Mypair._Myval2._Myval2._Myhead;
    this->_Mypair._Myval2._Myval2._Myhead->_Right = this->_Mypair._Myval2._Myval2._Myhead;
    v7 = this->_Mypair._Myval2._Myval2._Myhead;
    this->_Mypair._Myval2._Myval2._Mysize = 0i64;
    Left = v7->_Left;
    v9 = result;
    result->_Ptr = Left;
  }
  else
  {
    if ( _First._Ptr != _Last._Ptr )
    {
      do
      {
        v10 = _First._Ptr;
        if ( !_First._Ptr->_Isnil )
        {
          Right = _First._Ptr->_Right;
          if ( Right->_Isnil )
          {
            for ( i = _First._Ptr->_Parent; !i->_Isnil; i = i->_Parent )
            {
              if ( _First._Ptr != i->_Right )
                break;
              v15 = i;
              _First._Ptr = i;
            }
            v15 = i;
          }
          else
          {
            for ( j = Right->_Left; !j->_Isnil; j = j->_Left )
              Right = j;
            v15 = Right;
          }
        }
        std::_Tree<std::_Tmap_traits<unsigned int,AgLeaderboard::RankingData,std::less<unsigned int>,std::allocator<std::pair<unsigned int const,AgLeaderboard::RankingData>>,0>>::erase(
          this,
          &resulta,
          (std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<unsigned int const ,AgLeaderboard::RankingData> > > >)v10);
        _First._Ptr = v15;
      }
      while ( v15 != Ptr );
    }
    v9 = result;
    result->_Ptr = _First._Ptr;
  }
  return v9;
}

std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<unsigned int const ,AgLeaderboard::RankingData> > > > *__fastcall std::_Tree<std::_Tmap_traits<unsigned int,AgLeaderboard::RankingData,std::less<unsigned int>,std::allocator<std::pair<unsigned int const,AgLeaderboard::RankingData>>,0>>::erase(
        std::_Tree<std::_Tmap_traits<unsigned int,AgLeaderboard::RankingData,std::less<unsigned int>,std::allocator<std::pair<unsigned int const ,AgLeaderboard::RankingData> >,0> > *this,
        std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<unsigned int const ,AgLeaderboard::RankingData> > > > *result,
        std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<unsigned int const ,AgLeaderboard::RankingData> > > > _Where)
{
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *v5; // rsi
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *Right; // rax
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *j; // rax
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *i; // rax
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *Left; // rdi
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *Parent; // rbx
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *v11; // rcx
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *k; // rax
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *v13; // rcx
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *m; // rax
  std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<unsigned int const ,AgLeaderboard::RankingData> > > > *v15; // rax
  char Color; // cl
  bool n; // zf
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *v18; // rdx
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *v19; // r8
  std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *v20; // rcx
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *v21; // rcx
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *v22; // rax
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *v23; // rcx
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *v24; // rax
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *v25; // rax
  unsigned __int64 v26; // rdx
  unsigned __int64 Mysize; // rax
  std::_Tree_node<std::pair<unsigned int const ,AgLeaderboard::RankingData>,void *> *Ptr; // [rsp+60h] [rbp+18h]

  Ptr = _Where._Ptr;
  v5 = _Where._Ptr;
  if ( !_Where._Ptr->_Isnil )
  {
    Right = _Where._Ptr->_Right;
    if ( Right->_Isnil )
    {
      for ( i = _Where._Ptr->_Parent; !i->_Isnil; i = i->_Parent )
      {
        if ( _Where._Ptr != i->_Right )
          break;
        _Where._Ptr = i;
      }
      _Where._Ptr = i;
      Ptr = i;
    }
    else
    {
      _Where._Ptr = _Where._Ptr->_Right;
      for ( j = Right->_Left; !j->_Isnil; j = j->_Left )
        _Where._Ptr = j;
      Ptr = _Where._Ptr;
    }
  }
  if ( v5->_Left->_Isnil )
  {
    Left = v5->_Right;
  }
  else if ( v5->_Right->_Isnil )
  {
    Left = v5->_Left;
  }
  else
  {
    Left = _Where._Ptr->_Right;
    if ( _Where._Ptr != v5 )
    {
      v5->_Left->_Parent = _Where._Ptr;
      _Where._Ptr->_Left = v5->_Left;
      if ( _Where._Ptr == v5->_Right )
      {
        Parent = _Where._Ptr;
      }
      else
      {
        Parent = _Where._Ptr->_Parent;
        if ( !Left->_Isnil )
          Left->_Parent = Parent;
        Parent->_Left = Left;
        _Where._Ptr->_Right = v5->_Right;
        v5->_Right->_Parent = _Where._Ptr;
      }
      if ( this->_Mypair._Myval2._Myval2._Myhead->_Parent == v5 )
      {
        this->_Mypair._Myval2._Myval2._Myhead->_Parent = _Where._Ptr;
      }
      else
      {
        v15 = (std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<unsigned int const ,AgLeaderboard::RankingData> > > > *)v5->_Parent;
        if ( v15->_Ptr == v5 )
          v15->_Ptr = _Where._Ptr;
        else
          v15[2]._Ptr = _Where._Ptr;
      }
      _Where._Ptr->_Parent = v5->_Parent;
      Color = _Where._Ptr->_Color;
      _Where._Ptr->_Color = v5->_Color;
      v5->_Color = Color;
      goto LABEL_45;
    }
  }
  Parent = v5->_Parent;
  if ( !Left->_Isnil )
    Left->_Parent = Parent;
  if ( this->_Mypair._Myval2._Myval2._Myhead->_Parent == v5 )
  {
    this->_Mypair._Myval2._Myval2._Myhead->_Parent = Left;
  }
  else if ( Parent->_Left == v5 )
  {
    Parent->_Left = Left;
  }
  else
  {
    Parent->_Right = Left;
  }
  if ( this->_Mypair._Myval2._Myval2._Myhead->_Left == v5 )
  {
    if ( Left->_Isnil )
    {
      v11 = Parent;
    }
    else
    {
      v11 = Left;
      for ( k = Left->_Left; !k->_Isnil; k = k->_Left )
        v11 = k;
    }
    this->_Mypair._Myval2._Myval2._Myhead->_Left = v11;
  }
  if ( this->_Mypair._Myval2._Myval2._Myhead->_Right == v5 )
  {
    if ( Left->_Isnil )
    {
      v13 = Parent;
    }
    else
    {
      v13 = Left;
      for ( m = Left->_Right; !m->_Isnil; m = m->_Right )
        v13 = m;
    }
    this->_Mypair._Myval2._Myval2._Myhead->_Right = v13;
  }
LABEL_45:
  if ( v5->_Color != 1 )
    goto LABEL_84;
  for ( n = Left == this->_Mypair._Myval2._Myval2._Myhead->_Parent;
        !n;
        n = v18 == this->_Mypair._Myval2._Myval2._Myhead->_Parent )
  {
    v18 = Parent;
    v19 = Parent;
    if ( Left->_Color != 1 )
      break;
    v20 = (std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *)Parent->_Left;
    if ( Left == Parent->_Left )
    {
      v20 = (std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *)Parent->_Right;
      if ( !v20->_Color )
      {
        v20->_Color = 1;
        Parent->_Color = 0;
        v21 = Parent->_Right;
        Parent->_Right = v21->_Left;
        if ( !v21->_Left->_Isnil )
          v21->_Left->_Parent = Parent;
        v21->_Parent = Parent->_Parent;
        if ( Parent == this->_Mypair._Myval2._Myval2._Myhead->_Parent )
        {
          this->_Mypair._Myval2._Myval2._Myhead->_Parent = v21;
        }
        else
        {
          v22 = Parent->_Parent;
          if ( Parent == v22->_Left )
            v22->_Left = v21;
          else
            v22->_Right = v21;
        }
        v21->_Left = Parent;
        Parent->_Parent = v21;
        v20 = (std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *)Parent->_Right;
      }
      if ( !v20->_Isnil )
      {
        if ( v20->_Left->_Color != 1 || v20->_Right->_Color != 1 )
        {
          if ( v20->_Right->_Color == 1 )
          {
            v20->_Left->_Color = 1;
            v20->_Color = 0;
            std::_Tree<std::_Tmap_traits<enum AgControllerComponentType,std::list<AgControllerComponent *>,std::less<enum AgControllerComponentType>,std::allocator<std::pair<enum AgControllerComponentType const,std::list<AgControllerComponent *>>>,0>>::_Rrotate(
              (std::_Tree<std::_Tmap_traits<AgStringRef,AgJsonNode,std::less<AgStringRef>,std::allocator<std::pair<AgStringRef const ,AgJsonNode> >,0> > *)this,
              v20);
            v20 = (std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *)Parent->_Right;
          }
          v20->_Color = Parent->_Color;
          Parent->_Color = 1;
          v20->_Right->_Color = 1;
          std::_Tree<std::_Tmap_traits<AgControllerUID,FighterOperationMapper,std::less<AgControllerUID>,std::allocator<std::pair<AgControllerUID const,FighterOperationMapper>>,0>>::_Lrotate(
            (std::_Tree<std::_Tmap_traits<AgStringRef,AgJsonNode,std::less<AgStringRef>,std::allocator<std::pair<AgStringRef const ,AgJsonNode> >,0> > *)this,
            (std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *)Parent);
          break;
        }
LABEL_75:
        v20->_Color = 0;
      }
    }
    else
    {
      if ( !v20->_Color )
      {
        v20->_Color = 1;
        Parent->_Color = 0;
        v23 = Parent->_Left;
        Parent->_Left = Parent->_Left->_Right;
        v24 = v23->_Right;
        if ( !v24->_Isnil )
          v24->_Parent = Parent;
        v23->_Parent = Parent->_Parent;
        if ( Parent == this->_Mypair._Myval2._Myval2._Myhead->_Parent )
        {
          this->_Mypair._Myval2._Myval2._Myhead->_Parent = v23;
        }
        else
        {
          v25 = Parent->_Parent;
          if ( Parent == v25->_Right )
            v25->_Right = v23;
          else
            v25->_Left = v23;
        }
        v23->_Right = Parent;
        Parent->_Parent = v23;
        v20 = (std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *)Parent->_Left;
      }
      if ( !v20->_Isnil )
      {
        if ( v20->_Right->_Color != 1 || v20->_Left->_Color != 1 )
        {
          if ( v20->_Left->_Color == 1 )
          {
            v20->_Right->_Color = 1;
            v20->_Color = 0;
            std::_Tree<std::_Tmap_traits<AgControllerUID,FighterOperationMapper,std::less<AgControllerUID>,std::allocator<std::pair<AgControllerUID const,FighterOperationMapper>>,0>>::_Lrotate(
              (std::_Tree<std::_Tmap_traits<AgStringRef,AgJsonNode,std::less<AgStringRef>,std::allocator<std::pair<AgStringRef const ,AgJsonNode> >,0> > *)this,
              v20);
            v20 = (std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *)Parent->_Left;
          }
          v20->_Color = Parent->_Color;
          Parent->_Color = 1;
          v20->_Left->_Color = 1;
          std::_Tree<std::_Tmap_traits<enum AgControllerComponentType,std::list<AgControllerComponent *>,std::less<enum AgControllerComponentType>,std::allocator<std::pair<enum AgControllerComponentType const,std::list<AgControllerComponent *>>>,0>>::_Rrotate(
            (std::_Tree<std::_Tmap_traits<AgStringRef,AgJsonNode,std::less<AgStringRef>,std::allocator<std::pair<AgStringRef const ,AgJsonNode> >,0> > *)this,
            (std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *)Parent);
          break;
        }
        goto LABEL_75;
      }
    }
    Parent = Parent->_Parent;
    Left = v19;
  }
  Left->_Color = 1;
LABEL_84:
  AgPointer<AgBuffer<AgAllocator<1>>>::~AgPointer<AgBuffer<AgAllocator<1>>>(&v5->_Myval.second.score.m_data);
  AgString::~AgString(&v5->_Myval.second.score.m_comment, v26);
  operator delete(v5);
  Mysize = this->_Mypair._Myval2._Myval2._Mysize;
  if ( Mysize )
    this->_Mypair._Myval2._Myval2._Mysize = Mysize - 1;
  result->_Ptr = Ptr;
  return result;
}

std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > > *__fastcall std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::erase(
        std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const ,unsigned int> >,0> > *this,
        std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > > *result,
        std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > > _First,
        std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > > _Last)
{
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *Myhead; // rdx
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *v7; // rax
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *Left; // rcx
  std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > > *v9; // rax
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *v10; // rax
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *Right; // rdx
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *j; // rcx
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *i; // rcx
  std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > > resulta; // [rsp+30h] [rbp+8h] BYREF
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *v15; // [rsp+40h] [rbp+18h]
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *Ptr; // [rsp+48h] [rbp+20h]

  Ptr = _Last._Ptr;
  v15 = _First._Ptr;
  Myhead = this->_Mypair._Myval2._Myval2._Myhead;
  if ( _First._Ptr == this->_Mypair._Myval2._Myval2._Myhead->_Left && _Last._Ptr == Myhead )
  {
    std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::_Erase(
      this,
      Myhead->_Parent);
    this->_Mypair._Myval2._Myval2._Myhead->_Parent = this->_Mypair._Myval2._Myval2._Myhead;
    this->_Mypair._Myval2._Myval2._Myhead->_Left = this->_Mypair._Myval2._Myval2._Myhead;
    this->_Mypair._Myval2._Myval2._Myhead->_Right = this->_Mypair._Myval2._Myval2._Myhead;
    v7 = this->_Mypair._Myval2._Myval2._Myhead;
    this->_Mypair._Myval2._Myval2._Mysize = 0i64;
    Left = v7->_Left;
    v9 = result;
    result->_Ptr = Left;
  }
  else
  {
    if ( _First._Ptr != _Last._Ptr )
    {
      do
      {
        v10 = _First._Ptr;
        if ( !_First._Ptr->_Isnil )
        {
          Right = _First._Ptr->_Right;
          if ( Right->_Isnil )
          {
            for ( i = _First._Ptr->_Parent; !i->_Isnil; i = i->_Parent )
            {
              if ( _First._Ptr != i->_Right )
                break;
              v15 = i;
              _First._Ptr = i;
            }
            v15 = i;
          }
          else
          {
            for ( j = Right->_Left; !j->_Isnil; j = j->_Left )
              Right = j;
            v15 = Right;
          }
        }
        std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::erase(
          this,
          &resulta,
          (std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > >)v10);
        _First._Ptr = v15;
      }
      while ( v15 != Ptr );
    }
    v9 = result;
    result->_Ptr = _First._Ptr;
  }
  return v9;
}

std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > > *__fastcall std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,unsigned int>>,0>>::erase(
        std::_Tree<std::_Tmap_traits<AgStringKey,unsigned int,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const ,unsigned int> >,0> > *this,
        std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > > *result,
        std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > > _Where)
{
  std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > > *v3; // r15
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *v5; // rsi
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *Right; // rax
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *j; // rax
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *i; // rax
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *Left; // rdi
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *Parent; // rbx
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *v11; // rcx
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *k; // rax
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *v13; // rcx
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *m; // rax
  std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > > *v15; // rax
  char Color; // cl
  bool n; // zf
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *v18; // r8
  std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *v19; // rcx
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *v20; // rcx
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *v21; // rax
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *v22; // rcx
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *v23; // rax
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *v24; // rax
  unsigned __int64 Mysize; // rax
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *Ptr; // [rsp+60h] [rbp+18h]

  Ptr = _Where._Ptr;
  v3 = result;
  v5 = _Where._Ptr;
  if ( !_Where._Ptr->_Isnil )
  {
    Right = _Where._Ptr->_Right;
    if ( Right->_Isnil )
    {
      for ( i = _Where._Ptr->_Parent; !i->_Isnil; i = i->_Parent )
      {
        if ( _Where._Ptr != i->_Right )
          break;
        _Where._Ptr = i;
      }
      _Where._Ptr = i;
      Ptr = i;
    }
    else
    {
      _Where._Ptr = _Where._Ptr->_Right;
      for ( j = Right->_Left; !j->_Isnil; j = j->_Left )
        _Where._Ptr = j;
      Ptr = _Where._Ptr;
    }
  }
  if ( v5->_Left->_Isnil )
  {
    Left = v5->_Right;
  }
  else if ( v5->_Right->_Isnil )
  {
    Left = v5->_Left;
  }
  else
  {
    Left = _Where._Ptr->_Right;
    if ( _Where._Ptr != v5 )
    {
      v5->_Left->_Parent = _Where._Ptr;
      _Where._Ptr->_Left = v5->_Left;
      if ( _Where._Ptr == v5->_Right )
      {
        Parent = _Where._Ptr;
      }
      else
      {
        Parent = _Where._Ptr->_Parent;
        if ( !Left->_Isnil )
          Left->_Parent = Parent;
        Parent->_Left = Left;
        _Where._Ptr->_Right = v5->_Right;
        v5->_Right->_Parent = _Where._Ptr;
      }
      if ( this->_Mypair._Myval2._Myval2._Myhead->_Parent == v5 )
      {
        this->_Mypair._Myval2._Myval2._Myhead->_Parent = _Where._Ptr;
      }
      else
      {
        v15 = (std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > > *)v5->_Parent;
        if ( v15->_Ptr == v5 )
          v15->_Ptr = _Where._Ptr;
        else
          v15[2]._Ptr = _Where._Ptr;
      }
      _Where._Ptr->_Parent = v5->_Parent;
      Color = _Where._Ptr->_Color;
      _Where._Ptr->_Color = v5->_Color;
      v5->_Color = Color;
      goto LABEL_45;
    }
  }
  Parent = v5->_Parent;
  if ( !Left->_Isnil )
    Left->_Parent = Parent;
  if ( this->_Mypair._Myval2._Myval2._Myhead->_Parent == v5 )
  {
    this->_Mypair._Myval2._Myval2._Myhead->_Parent = Left;
  }
  else if ( Parent->_Left == v5 )
  {
    Parent->_Left = Left;
  }
  else
  {
    Parent->_Right = Left;
  }
  if ( this->_Mypair._Myval2._Myval2._Myhead->_Left == v5 )
  {
    if ( Left->_Isnil )
    {
      v11 = Parent;
    }
    else
    {
      v11 = Left;
      for ( k = Left->_Left; !k->_Isnil; k = k->_Left )
        v11 = k;
    }
    this->_Mypair._Myval2._Myval2._Myhead->_Left = v11;
  }
  result = (std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > > *)this->_Mypair._Myval2._Myval2._Myhead;
  if ( this->_Mypair._Myval2._Myval2._Myhead->_Right == v5 )
  {
    if ( Left->_Isnil )
    {
      v13 = Parent;
    }
    else
    {
      v13 = Left;
      for ( m = Left->_Right; !m->_Isnil; m = m->_Right )
        v13 = m;
    }
    result[2]._Ptr = v13;
  }
LABEL_45:
  if ( v5->_Color != 1 )
    goto LABEL_84;
  for ( n = Left == this->_Mypair._Myval2._Myval2._Myhead->_Parent;
        !n;
        n = result == (std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > > *)this->_Mypair._Myval2._Myval2._Myhead->_Parent )
  {
    result = (std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,unsigned int> > > > *)Parent;
    v18 = Parent;
    if ( Left->_Color != 1 )
      break;
    v19 = (std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *)Parent->_Left;
    if ( Left == Parent->_Left )
    {
      v19 = (std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *)Parent->_Right;
      if ( !v19->_Color )
      {
        v19->_Color = 1;
        Parent->_Color = 0;
        v20 = Parent->_Right;
        Parent->_Right = v20->_Left;
        if ( !v20->_Left->_Isnil )
          v20->_Left->_Parent = Parent;
        v20->_Parent = Parent->_Parent;
        if ( Parent == this->_Mypair._Myval2._Myval2._Myhead->_Parent )
        {
          this->_Mypair._Myval2._Myval2._Myhead->_Parent = v20;
        }
        else
        {
          v21 = Parent->_Parent;
          if ( Parent == v21->_Left )
            v21->_Left = v20;
          else
            v21->_Right = v20;
        }
        v20->_Left = Parent;
        Parent->_Parent = v20;
        v19 = (std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *)Parent->_Right;
      }
      if ( !v19->_Isnil )
      {
        if ( v19->_Left->_Color != 1 || v19->_Right->_Color != 1 )
        {
          if ( v19->_Right->_Color == 1 )
          {
            v19->_Left->_Color = 1;
            v19->_Color = 0;
            std::_Tree<std::_Tmap_traits<enum AgControllerComponentType,std::list<AgControllerComponent *>,std::less<enum AgControllerComponentType>,std::allocator<std::pair<enum AgControllerComponentType const,std::list<AgControllerComponent *>>>,0>>::_Rrotate(
              (std::_Tree<std::_Tmap_traits<AgStringRef,AgJsonNode,std::less<AgStringRef>,std::allocator<std::pair<AgStringRef const ,AgJsonNode> >,0> > *)this,
              v19);
            v19 = (std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *)Parent->_Right;
          }
          v19->_Color = Parent->_Color;
          Parent->_Color = 1;
          v19->_Right->_Color = 1;
          std::_Tree<std::_Tmap_traits<AgControllerUID,FighterOperationMapper,std::less<AgControllerUID>,std::allocator<std::pair<AgControllerUID const,FighterOperationMapper>>,0>>::_Lrotate(
            (std::_Tree<std::_Tmap_traits<AgStringRef,AgJsonNode,std::less<AgStringRef>,std::allocator<std::pair<AgStringRef const ,AgJsonNode> >,0> > *)this,
            (std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *)Parent);
          break;
        }
LABEL_75:
        v19->_Color = 0;
      }
    }
    else
    {
      if ( !v19->_Color )
      {
        v19->_Color = 1;
        Parent->_Color = 0;
        v22 = Parent->_Left;
        Parent->_Left = Parent->_Left->_Right;
        v23 = v22->_Right;
        if ( !v23->_Isnil )
          v23->_Parent = Parent;
        v22->_Parent = Parent->_Parent;
        if ( Parent == this->_Mypair._Myval2._Myval2._Myhead->_Parent )
        {
          this->_Mypair._Myval2._Myval2._Myhead->_Parent = v22;
        }
        else
        {
          v24 = Parent->_Parent;
          if ( Parent == v24->_Right )
            v24->_Right = v22;
          else
            v24->_Left = v22;
        }
        v22->_Right = Parent;
        Parent->_Parent = v22;
        v19 = (std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *)Parent->_Left;
      }
      if ( !v19->_Isnil )
      {
        if ( v19->_Right->_Color != 1 || v19->_Left->_Color != 1 )
        {
          if ( v19->_Left->_Color == 1 )
          {
            v19->_Right->_Color = 1;
            v19->_Color = 0;
            std::_Tree<std::_Tmap_traits<AgControllerUID,FighterOperationMapper,std::less<AgControllerUID>,std::allocator<std::pair<AgControllerUID const,FighterOperationMapper>>,0>>::_Lrotate(
              (std::_Tree<std::_Tmap_traits<AgStringRef,AgJsonNode,std::less<AgStringRef>,std::allocator<std::pair<AgStringRef const ,AgJsonNode> >,0> > *)this,
              v19);
            v19 = (std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *)Parent->_Left;
          }
          v19->_Color = Parent->_Color;
          Parent->_Color = 1;
          v19->_Left->_Color = 1;
          std::_Tree<std::_Tmap_traits<enum AgControllerComponentType,std::list<AgControllerComponent *>,std::less<enum AgControllerComponentType>,std::allocator<std::pair<enum AgControllerComponentType const,std::list<AgControllerComponent *>>>,0>>::_Rrotate(
            (std::_Tree<std::_Tmap_traits<AgStringRef,AgJsonNode,std::less<AgStringRef>,std::allocator<std::pair<AgStringRef const ,AgJsonNode> >,0> > *)this,
            (std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *)Parent);
          break;
        }
        goto LABEL_75;
      }
    }
    Parent = Parent->_Parent;
    Left = v18;
  }
  Left->_Color = 1;
LABEL_84:
  AgString::~AgString(&v5->_Myval.first.m_string, (unsigned __int64)result);
  operator delete(v5);
  Mysize = this->_Mypair._Myval2._Myval2._Mysize;
  if ( Mysize )
    this->_Mypair._Myval2._Myval2._Mysize = Mysize - 1;
  v3->_Ptr = Ptr;
  return v3;
}

std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > > *__fastcall std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::erase(
        std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > >,0> > *this,
        std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > > *result,
        std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > > _First,
        std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > > _Last)
{
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *Myhead; // rdx
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v7; // rax
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *Left; // rcx
  std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > > *v9; // rax
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v10; // rax
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *Right; // rdx
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *j; // rcx
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *i; // rcx
  std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > > resulta; // [rsp+30h] [rbp+8h] BYREF
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v15; // [rsp+40h] [rbp+18h]
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *Ptr; // [rsp+48h] [rbp+20h]

  Ptr = _Last._Ptr;
  v15 = _First._Ptr;
  Myhead = this->_Mypair._Myval2._Myval2._Myhead;
  if ( _First._Ptr == this->_Mypair._Myval2._Myval2._Myhead->_Left && _Last._Ptr == Myhead )
  {
    std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::_Erase(
      this,
      Myhead->_Parent);
    this->_Mypair._Myval2._Myval2._Myhead->_Parent = this->_Mypair._Myval2._Myval2._Myhead;
    this->_Mypair._Myval2._Myval2._Myhead->_Left = this->_Mypair._Myval2._Myval2._Myhead;
    this->_Mypair._Myval2._Myval2._Myhead->_Right = this->_Mypair._Myval2._Myval2._Myhead;
    v7 = this->_Mypair._Myval2._Myval2._Myhead;
    this->_Mypair._Myval2._Myval2._Mysize = 0i64;
    Left = v7->_Left;
    v9 = result;
    result->_Ptr = Left;
  }
  else
  {
    if ( _First._Ptr != _Last._Ptr )
    {
      do
      {
        v10 = _First._Ptr;
        if ( !_First._Ptr->_Isnil )
        {
          Right = _First._Ptr->_Right;
          if ( Right->_Isnil )
          {
            for ( i = _First._Ptr->_Parent; !i->_Isnil; i = i->_Parent )
            {
              if ( _First._Ptr != i->_Right )
                break;
              v15 = i;
              _First._Ptr = i;
            }
            v15 = i;
          }
          else
          {
            for ( j = Right->_Left; !j->_Isnil; j = j->_Left )
              Right = j;
            v15 = Right;
          }
        }
        std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::erase(
          this,
          &resulta,
          (std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > >)v10);
        _First._Ptr = v15;
      }
      while ( v15 != Ptr );
    }
    v9 = result;
    result->_Ptr = _First._Ptr;
  }
  return v9;
}

std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > > *__fastcall std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::erase(
        std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > >,0> > *this,
        std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > > *result,
        std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > > _Where)
{
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v5; // rsi
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *Right; // rax
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *j; // rax
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *i; // rax
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *Left; // rdi
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *Parent; // rbx
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v11; // rcx
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *k; // rax
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v13; // rcx
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *m; // rax
  std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > > *v15; // rax
  char Color; // cl
  bool n; // zf
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v18; // rdx
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v19; // r8
  std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *v20; // rcx
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v21; // rcx
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v22; // rax
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v23; // rcx
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v24; // rax
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v25; // rax
  unsigned __int64 v26; // rdx
  unsigned __int64 Mysize; // rax
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *Ptr; // [rsp+60h] [rbp+18h]

  Ptr = _Where._Ptr;
  v5 = _Where._Ptr;
  if ( !_Where._Ptr->_Isnil )
  {
    Right = _Where._Ptr->_Right;
    if ( Right->_Isnil )
    {
      for ( i = _Where._Ptr->_Parent; !i->_Isnil; i = i->_Parent )
      {
        if ( _Where._Ptr != i->_Right )
          break;
        _Where._Ptr = i;
      }
      _Where._Ptr = i;
      Ptr = i;
    }
    else
    {
      _Where._Ptr = _Where._Ptr->_Right;
      for ( j = Right->_Left; !j->_Isnil; j = j->_Left )
        _Where._Ptr = j;
      Ptr = _Where._Ptr;
    }
  }
  if ( v5->_Left->_Isnil )
  {
    Left = v5->_Right;
  }
  else if ( v5->_Right->_Isnil )
  {
    Left = v5->_Left;
  }
  else
  {
    Left = _Where._Ptr->_Right;
    if ( _Where._Ptr != v5 )
    {
      v5->_Left->_Parent = _Where._Ptr;
      _Where._Ptr->_Left = v5->_Left;
      if ( _Where._Ptr == v5->_Right )
      {
        Parent = _Where._Ptr;
      }
      else
      {
        Parent = _Where._Ptr->_Parent;
        if ( !Left->_Isnil )
          Left->_Parent = Parent;
        Parent->_Left = Left;
        _Where._Ptr->_Right = v5->_Right;
        v5->_Right->_Parent = _Where._Ptr;
      }
      if ( this->_Mypair._Myval2._Myval2._Myhead->_Parent == v5 )
      {
        this->_Mypair._Myval2._Myval2._Myhead->_Parent = _Where._Ptr;
      }
      else
      {
        v15 = (std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > > *)v5->_Parent;
        if ( v15->_Ptr == v5 )
          v15->_Ptr = _Where._Ptr;
        else
          v15[2]._Ptr = _Where._Ptr;
      }
      _Where._Ptr->_Parent = v5->_Parent;
      Color = _Where._Ptr->_Color;
      _Where._Ptr->_Color = v5->_Color;
      v5->_Color = Color;
      goto LABEL_45;
    }
  }
  Parent = v5->_Parent;
  if ( !Left->_Isnil )
    Left->_Parent = Parent;
  if ( this->_Mypair._Myval2._Myval2._Myhead->_Parent == v5 )
  {
    this->_Mypair._Myval2._Myval2._Myhead->_Parent = Left;
  }
  else if ( Parent->_Left == v5 )
  {
    Parent->_Left = Left;
  }
  else
  {
    Parent->_Right = Left;
  }
  if ( this->_Mypair._Myval2._Myval2._Myhead->_Left == v5 )
  {
    if ( Left->_Isnil )
    {
      v11 = Parent;
    }
    else
    {
      v11 = Left;
      for ( k = Left->_Left; !k->_Isnil; k = k->_Left )
        v11 = k;
    }
    this->_Mypair._Myval2._Myval2._Myhead->_Left = v11;
  }
  if ( this->_Mypair._Myval2._Myval2._Myhead->_Right == v5 )
  {
    if ( Left->_Isnil )
    {
      v13 = Parent;
    }
    else
    {
      v13 = Left;
      for ( m = Left->_Right; !m->_Isnil; m = m->_Right )
        v13 = m;
    }
    this->_Mypair._Myval2._Myval2._Myhead->_Right = v13;
  }
LABEL_45:
  if ( v5->_Color != 1 )
    goto LABEL_84;
  for ( n = Left == this->_Mypair._Myval2._Myval2._Myhead->_Parent;
        !n;
        n = v18 == this->_Mypair._Myval2._Myval2._Myhead->_Parent )
  {
    v18 = Parent;
    v19 = Parent;
    if ( Left->_Color != 1 )
      break;
    v20 = (std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *)Parent->_Left;
    if ( Left == Parent->_Left )
    {
      v20 = (std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *)Parent->_Right;
      if ( !v20->_Color )
      {
        v20->_Color = 1;
        Parent->_Color = 0;
        v21 = Parent->_Right;
        Parent->_Right = v21->_Left;
        if ( !v21->_Left->_Isnil )
          v21->_Left->_Parent = Parent;
        v21->_Parent = Parent->_Parent;
        if ( Parent == this->_Mypair._Myval2._Myval2._Myhead->_Parent )
        {
          this->_Mypair._Myval2._Myval2._Myhead->_Parent = v21;
        }
        else
        {
          v22 = Parent->_Parent;
          if ( Parent == v22->_Left )
            v22->_Left = v21;
          else
            v22->_Right = v21;
        }
        v21->_Left = Parent;
        Parent->_Parent = v21;
        v20 = (std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *)Parent->_Right;
      }
      if ( !v20->_Isnil )
      {
        if ( v20->_Left->_Color != 1 || v20->_Right->_Color != 1 )
        {
          if ( v20->_Right->_Color == 1 )
          {
            v20->_Left->_Color = 1;
            v20->_Color = 0;
            std::_Tree<std::_Tmap_traits<enum AgControllerComponentType,std::list<AgControllerComponent *>,std::less<enum AgControllerComponentType>,std::allocator<std::pair<enum AgControllerComponentType const,std::list<AgControllerComponent *>>>,0>>::_Rrotate(
              (std::_Tree<std::_Tmap_traits<AgStringRef,AgJsonNode,std::less<AgStringRef>,std::allocator<std::pair<AgStringRef const ,AgJsonNode> >,0> > *)this,
              v20);
            v20 = (std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *)Parent->_Right;
          }
          v20->_Color = Parent->_Color;
          Parent->_Color = 1;
          v20->_Right->_Color = 1;
          std::_Tree<std::_Tmap_traits<AgControllerUID,FighterOperationMapper,std::less<AgControllerUID>,std::allocator<std::pair<AgControllerUID const,FighterOperationMapper>>,0>>::_Lrotate(
            (std::_Tree<std::_Tmap_traits<AgStringRef,AgJsonNode,std::less<AgStringRef>,std::allocator<std::pair<AgStringRef const ,AgJsonNode> >,0> > *)this,
            (std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *)Parent);
          break;
        }
LABEL_75:
        v20->_Color = 0;
      }
    }
    else
    {
      if ( !v20->_Color )
      {
        v20->_Color = 1;
        Parent->_Color = 0;
        v23 = Parent->_Left;
        Parent->_Left = Parent->_Left->_Right;
        v24 = v23->_Right;
        if ( !v24->_Isnil )
          v24->_Parent = Parent;
        v23->_Parent = Parent->_Parent;
        if ( Parent == this->_Mypair._Myval2._Myval2._Myhead->_Parent )
        {
          this->_Mypair._Myval2._Myval2._Myhead->_Parent = v23;
        }
        else
        {
          v25 = Parent->_Parent;
          if ( Parent == v25->_Right )
            v25->_Right = v23;
          else
            v25->_Left = v23;
        }
        v23->_Right = Parent;
        Parent->_Parent = v23;
        v20 = (std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *)Parent->_Left;
      }
      if ( !v20->_Isnil )
      {
        if ( v20->_Right->_Color != 1 || v20->_Left->_Color != 1 )
        {
          if ( v20->_Left->_Color == 1 )
          {
            v20->_Right->_Color = 1;
            v20->_Color = 0;
            std::_Tree<std::_Tmap_traits<AgControllerUID,FighterOperationMapper,std::less<AgControllerUID>,std::allocator<std::pair<AgControllerUID const,FighterOperationMapper>>,0>>::_Lrotate(
              (std::_Tree<std::_Tmap_traits<AgStringRef,AgJsonNode,std::less<AgStringRef>,std::allocator<std::pair<AgStringRef const ,AgJsonNode> >,0> > *)this,
              v20);
            v20 = (std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *)Parent->_Left;
          }
          v20->_Color = Parent->_Color;
          Parent->_Color = 1;
          v20->_Left->_Color = 1;
          std::_Tree<std::_Tmap_traits<enum AgControllerComponentType,std::list<AgControllerComponent *>,std::less<enum AgControllerComponentType>,std::allocator<std::pair<enum AgControllerComponentType const,std::list<AgControllerComponent *>>>,0>>::_Rrotate(
            (std::_Tree<std::_Tmap_traits<AgStringRef,AgJsonNode,std::less<AgStringRef>,std::allocator<std::pair<AgStringRef const ,AgJsonNode> >,0> > *)this,
            (std::_Tree_node<std::pair<AgStringRef const ,AgJsonNode>,void *> *)Parent);
          break;
        }
        goto LABEL_75;
      }
    }
    Parent = Parent->_Parent;
    Left = v19;
  }
  Left->_Color = 1;
LABEL_84:
  AgPointer<AgLeaderboard>::~AgPointer<AgLeaderboard>(&v5->_Myval.second);
  AgString::~AgString(&v5->_Myval.first.m_string, v26);
  operator delete(v5);
  Mysize = this->_Mypair._Myval2._Myval2._Mysize;
  if ( Mysize )
    this->_Mypair._Myval2._Myval2._Mysize = Mysize - 1;
  result->_Ptr = Ptr;
  return result;
}

AgPointer<AgBuffer<AgAllocator<1> > > *__fastcall AgLeaderboardRanking::getData(
        AgLeaderboardRanking *this,
        AgPointer<AgBuffer<AgAllocator<1> > > *result)
{
  AgPointer<AgBuffer<AgAllocator<1>>>::AgPointer<AgBuffer<AgAllocator<1>>>(
    (AgPointer<AgPlayer> *)result,
    (const AgPointer<AgPlayer> *)&this->m_data);
  return result;
}

void __fastcall AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int>::init(
        AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int> *this,
        unsigned int numItems)
{
  unsigned int i; // eax
  __int64 v4; // rsi
  __int64 v5; // rax
  unsigned __int64 v6; // kr00_8
  bool v7; // cf
  unsigned __int64 v8; // rax
  _QWORD *v9; // rax
  AgLeaderboardManager::StoreRankingEntry *v10; // rdi

  for ( i = numItems & -numItems; i < numItems; i *= 2 )
    ;
  this->m_sz = i;
  v4 = i;
  v6 = i;
  v5 = 112i64 * i;
  if ( !is_mul_ok(v6, 0x70ui64) )
    v5 = -1i64;
  v7 = __CFADD__(v5, 8i64);
  v8 = v5 + 8;
  if ( v7 )
    v8 = -1i64;
  v9 = operator new[](v8);
  if ( v9 )
  {
    *v9 = v4;
    v10 = (AgLeaderboardManager::StoreRankingEntry *)(v9 + 1);
    `eh vector constructor iterator'(
      v9 + 1,
      0x70ui64,
      (unsigned int)v4,
      (void (__fastcall *)(void *))AgLeaderboardManager::StoreRankingEntry::StoreRankingEntry,
      (void (__fastcall *)(void *))AgLeaderboardManager::StoreRankingEntry::~StoreRankingEntry);
  }
  else
  {
    v10 = 0i64;
  }
  this->m_buffer = v10;
  this->m_write = 0;
  this->m_read = 0;
}

__int64 __fastcall AgLeaderboardManager::onSingletonExit(AgLeaderboardManager *this)
{
  AgThreadPool *m_threadPool; // rcx
  __int64 result; // rax

  m_threadPool = this->m_storeCompletion.m_threadPool;
  if ( m_threadPool )
    AgThreadPool::cancelJob(m_threadPool, this->m_storeCompletion.m_jobId);
  std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::_Erase(
    &this->m_leaderboards,
    this->m_leaderboards._Mypair._Myval2._Myval2._Myhead->_Parent);
  this->m_leaderboards._Mypair._Myval2._Myval2._Myhead->_Parent = this->m_leaderboards._Mypair._Myval2._Myval2._Myhead;
  this->m_leaderboards._Mypair._Myval2._Myval2._Myhead->_Left = this->m_leaderboards._Mypair._Myval2._Myval2._Myhead;
  this->m_leaderboards._Mypair._Myval2._Myval2._Myhead->_Right = this->m_leaderboards._Mypair._Myval2._Myval2._Myhead;
  result = 1i64;
  this->m_leaderboards._Mypair._Myval2._Myval2._Mysize = 0i64;
  return result;
}

__int64 __fastcall AgLeaderboardManager::onSingletonInit(AgLeaderboardManager *this)
{
  this->m_requestId = 1;
  *(_QWORD *)&this->m_loadedStoreQueue = 0i64;
  AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int>::init(&this->m_storeQueue, 0x80u);
  return 1i64;
}

AgPointer<AgLeaderboard> *__fastcall AgLeaderboardManager::open(
        AgLeaderboardManager *this,
        AgPointer<AgLeaderboard> *result,
        AgStringRef *name)
{
  unsigned __int64 v6; // rdx
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *Myhead; // rdi
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *Parent; // rbx
  const char *CString; // rax
  AgPointer<AgLeaderboard> *v10; // rax
  unsigned __int64 v11; // rdx
  AgStringKey str; // [rsp+30h] [rbp-58h] BYREF
  AgString v14; // [rsp+50h] [rbp-38h] BYREF
  AgStringRef s2; // [rsp+60h] [rbp-28h] BYREF

  AgString::AgString(&v14);
  s2 = *name;
  Myhead = this->m_leaderboards._Mypair._Myval2._Myval2._Myhead;
  Parent = Myhead->_Parent;
  while ( !Parent->_Isnil )
  {
    if ( operator<(&Parent->_Myval.first.m_stringRef, &s2) )
    {
      Parent = Parent->_Right;
    }
    else
    {
      Myhead = Parent;
      Parent = Parent->_Left;
    }
  }
  if ( Myhead == this->m_leaderboards._Mypair._Myval2._Myval2._Myhead
    || operator<(&s2, &Myhead->_Myval.first.m_stringRef) )
  {
    Myhead = this->m_leaderboards._Mypair._Myval2._Myval2._Myhead;
  }
  AgString::~AgString(&v14, v6);
  result->m_ref = 0i64;
  result->m_ptr = 0i64;
  if ( Myhead == this->m_leaderboards._Mypair._Myval2._Myval2._Myhead )
  {
    CString = (const char *)AgStringRef::getCString((std::shared_ptr<__ExceptionPtr> *)name);
    AgTrace("AgLeaderboardManager::open( %s ) opening new leaderboard", CString);
    str.m_string = (AgString)*name;
    v10 = (AgPointer<AgLeaderboard> *)((__int64 (__fastcall *)(AgLeaderboardManager *, AgString *, AgStringKey *))this->_create)(
                                        this,
                                        &v14,
                                        &str);
    AgPointer<AgLeaderboard>::operator=(result, v10);
    AgPointer<AgLeaderboard>::~AgPointer<AgLeaderboard>((AgPointer<AgLeaderboard> *)&v14);
    if ( result->m_ptr )
    {
      AgString::AgString(&str.m_string, name);
      AgStringRef::AgStringRef(&str.m_stringRef, &str.m_string);
      std::map<AgStringKey,AgPointer<AgLeaderboard>>::_Try_emplace<AgStringKey,>(
        &this->m_leaderboards,
        (std::pair<std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > >,bool> *)&v14,
        &str);
      AgPointer<AgLeaderboard>::operator=((AgPointer<AgLeaderboard> *)(*(_QWORD *)&v14.m_length + 64i64), result);
      AgString::~AgString(&str.m_string, v11);
    }
  }
  else
  {
    AgPointer<AgLeaderboard>::operator=(result, &Myhead->_Myval.second);
  }
  return result;
}

__int64 __fastcall AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int>::pop(
        AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int> *this,
        AgLeaderboardManager::StoreRankingEntry *items,
        unsigned int numItems)
{
  unsigned int v6; // er14
  unsigned int m_read; // ebp
  __int64 *p_m_score; // r15
  AgLeaderboardManager::StoreRankingEntry *v9; // rdi
  AgLeaderboardManager::StoreRankingEntry *v10; // rdi

  if ( __TSS0__1__pop___AgRingBufferImpl_UStoreRankingEntry_AgLeaderboardManager__XH__QEAAIPEAUStoreRankingEntry_AgLeaderboardManager__I_Z_4HA > *(_DWORD *)(*((_QWORD *)NtCurrentTeb()->Reserved1[11] + tls_index) + 40i64) )
  {
    Init_thread_header(&__TSS0__1__pop___AgRingBufferImpl_UStoreRankingEntry_AgLeaderboardManager__XH__QEAAIPEAUStoreRankingEntry_AgLeaderboardManager__I_Z_4HA);
    if ( __TSS0__1__pop___AgRingBufferImpl_UStoreRankingEntry_AgLeaderboardManager__XH__QEAAIPEAUStoreRankingEntry_AgLeaderboardManager__I_Z_4HA == -1 )
    {
      AgLeaderboardManager::StoreRankingEntry::StoreRankingEntry(&`AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int>::pop'::`2'::zero);
      atexit(`AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int>::pop'::`2'::`dynamic atexit destructor for 'zero'');
      Init_thread_footer(&__TSS0__1__pop___AgRingBufferImpl_UStoreRankingEntry_AgLeaderboardManager__XH__QEAAIPEAUStoreRankingEntry_AgLeaderboardManager__I_Z_4HA);
    }
  }
  v6 = 0;
  m_read = this->m_read;
  if ( numItems )
  {
    p_m_score = &items->score.m_score;
    do
    {
      if ( m_read >= this->m_write )
        break;
      v9 = &this->m_buffer[m_read & (this->m_sz - 1)];
      *((_DWORD *)p_m_score - 14) = v9->requestId;
      *((_DWORD *)p_m_score - 13) = v9->retryCount;
      AgString::operator=((AgString *)p_m_score - 3, &v9->leaderboardName);
      AgPointer<AgLeaderboard>::operator=((AgPointer<AgLeaderboard> *)p_m_score - 2, &v9->leaderboard);
      *(p_m_score - 2) = v9->score.m_profileId;
      *((_DWORD *)p_m_score - 2) = v9->score.m_rank;
      *p_m_score = v9->score.m_score;
      AgString::operator=((AgString *)(p_m_score + 1), &v9->score.m_comment);
      AgPointer<AgBuffer<AgAllocator<1>>>::operator=(
        (AgPointer<AgBuffer<AgAllocator<1> > > *)(p_m_score + 3),
        &v9->score.m_data);
      AgPointer<AgUser>::operator=((AgPointer<AgUser> *)(p_m_score + 5), &v9->user);
      v10 = &this->m_buffer[m_read & (this->m_sz - 1)];
      v10->requestId = `AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int>::pop'::`2'::zero.requestId;
      v10->retryCount = `AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int>::pop'::`2'::zero.retryCount;
      AgString::operator=(
        &v10->leaderboardName,
        &`AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int>::pop'::`2'::zero.leaderboardName);
      AgPointer<AgLeaderboard>::operator=(
        &v10->leaderboard,
        &`AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int>::pop'::`2'::zero.leaderboard);
      v10->score.m_profileId = `AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int>::pop'::`2'::zero.score.m_profileId;
      v10->score.m_rank = `AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int>::pop'::`2'::zero.score.m_rank;
      v10->score.m_score = `AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int>::pop'::`2'::zero.score.m_score;
      AgString::operator=(
        &v10->score.m_comment,
        &`AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int>::pop'::`2'::zero.score.m_comment);
      AgPointer<AgBuffer<AgAllocator<1>>>::operator=(
        &v10->score.m_data,
        &`AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int>::pop'::`2'::zero.score.m_data);
      AgPointer<AgUser>::operator=(
        &v10->user,
        &`AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int>::pop'::`2'::zero.user);
      ++m_read;
      ++v6;
      p_m_score += 14;
    }
    while ( v6 < numItems );
  }
  this->m_read = m_read;
  return v6;
}

__int64 __fastcall AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int>::push(
        AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int> *this,
        AgLeaderboardManager::StoreRankingEntry *items,
        unsigned int numItems)
{
  unsigned int m_write; // esi
  unsigned int v4; // ebp
  __int64 *p_m_score; // r14
  unsigned int m_sz; // edx
  AgLeaderboardManager::StoreRankingEntry *v9; // rdi
  __int64 result; // rax

  m_write = this->m_write;
  v4 = 0;
  if ( numItems )
  {
    p_m_score = &items->score.m_score;
    do
    {
      m_sz = this->m_sz;
      if ( m_write >= m_sz + this->m_read )
        break;
      v9 = &this->m_buffer[m_write & (m_sz - 1)];
      v9->requestId = *((_DWORD *)p_m_score - 14);
      v9->retryCount = *((_DWORD *)p_m_score - 13);
      AgString::operator=(&v9->leaderboardName, (const AgString *)p_m_score - 3);
      AgPointer<AgLeaderboard>::operator=(&v9->leaderboard, (const AgPointer<AgLeaderboard> *)p_m_score - 2);
      v9->score.m_profileId = *(p_m_score - 2);
      v9->score.m_rank = *((_DWORD *)p_m_score - 2);
      v9->score.m_score = *p_m_score;
      AgString::operator=(&v9->score.m_comment, (const AgString *)(p_m_score + 1));
      AgPointer<AgBuffer<AgAllocator<1>>>::operator=(
        &v9->score.m_data,
        (const AgPointer<AgBuffer<AgAllocator<1> > > *)(p_m_score + 3));
      AgPointer<AgUser>::operator=(&v9->user, (const AgPointer<AgUser> *)(p_m_score + 5));
      ++m_write;
      ++v4;
      p_m_score += 14;
    }
    while ( v4 < numItems );
    result = v4;
    this->m_write = m_write;
  }
  else
  {
    result = 0i64;
    this->m_write = m_write;
  }
  return result;
}

__int64 __fastcall AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int>::push(
        AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int> *this,
        AgLeaderboardManager::StoreRankingEntry *item)
{
  unsigned int v3; // edi
  unsigned __int64 v4; // rdx
  unsigned __int64 v5; // rdx

  v3 = AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int>::push(this, item, 1u);
  AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)&item->user);
  AgPointer<AgBuffer<AgAllocator<1>>>::~AgPointer<AgBuffer<AgAllocator<1>>>(&item->score.m_data);
  AgString::~AgString(&item->score.m_comment, v4);
  AgPointer<AgLeaderboard>::~AgPointer<AgLeaderboard>(&item->leaderboard);
  AgString::~AgString(&item->leaderboardName, v5);
  return v3;
}

__int64 __fastcall AgDefaultLeaderboard::requestRankings(
        AgDefaultLeaderboard *this,
        AgPointer<AgLeaderboardRankingList> *scores,
        AgLeaderboard::Type type,
        int start)
{
  AgPointer<AgLeaderboardRankingList>::~AgPointer<AgLeaderboardRankingList>(scores);
  return 0i64;
}

AgJobCompletion *__fastcall AgDefaultLeaderboard::requestRankingsAsync(
        AgDefaultLeaderboard *this,
        AgJobCompletion *result,
        AgPointer<AgLeaderboardRankingList> *scores,
        AgLeaderboard::Type type)
{
  result->m_threadPool = 0i64;
  result->m_jobId = 0;
  AgPointer<AgLeaderboardRankingList>::~AgPointer<AgLeaderboardRankingList>(scores);
  return result;
}

void __fastcall AgBuffer<AgAllocator<1>>::reset(AgBuffer<AgAllocator<1> > *this, unsigned __int64 size)
{
  unsigned __int8 *m_data; // rdx
  unsigned __int64 m_alignment; // r8
  AgAllocator<1> *p_m_allocator; // rcx

  m_data = this->m_data;
  if ( m_data )
  {
    AgAllocator<1>::deallocate(&this->m_allocator, m_data);
    this->m_data = 0i64;
    this->m_size = 0i64;
  }
  if ( size )
  {
    m_alignment = this->m_alignment;
    p_m_allocator = &this->m_allocator;
    if ( m_alignment )
      this->m_data = (unsigned __int8 *)AgAllocator<1>::allocate(p_m_allocator, size, m_alignment);
    else
      this->m_data = (unsigned __int8 *)AgAllocator<1>::allocate(p_m_allocator, size);
    this->m_size = size;
  }
  else
  {
    this->m_data = 0i64;
    this->m_size = 0i64;
  }
}

__int64 __fastcall AgLeaderboardManager::serialize(AgLeaderboardManager *this, AgPointer<AgStream> *stream)
{
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *Myhead; // rax
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *Left; // rbx
  AgStream *m_ptr; // rsi
  AgStream_vtbl *v7; // r14
  int v8; // edi
  __ExceptionPtr *CString; // rax
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *Right; // rax
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *j; // rax
  std::_Tree_node<std::pair<AgStringKey const ,unsigned int>,void *> *i; // rax
  AgReferenceCount *m_ref; // rdi
  int m_strongCount; // ebx
  volatile int *v15; // rdi
  int v16; // ebx
  unsigned int k; // ebx
  unsigned int second; // [rsp+20h] [rbp-60h] BYREF
  __int64 v20; // [rsp+28h] [rbp-58h]
  volatile int **v21; // [rsp+30h] [rbp-50h]
  volatile int *value[2]; // [rsp+40h] [rbp-40h] BYREF
  int v23; // [rsp+50h] [rbp-30h]
  LPCRITICAL_SECTION lpCriticalSection; // [rsp+58h] [rbp-28h]
  SerializeStoreQueuePredicate v25; // [rsp+60h] [rbp-20h] BYREF
  AgStringRef m_stringRef; // [rsp+70h] [rbp-10h] BYREF
  int IsStopping; // [rsp+C0h] [rbp+40h] BYREF
  AgPointer<AgStream> *v28; // [rsp+C8h] [rbp+48h]
  int Mysize; // [rsp+D0h] [rbp+50h] BYREF
  unsigned int v30; // [rsp+D8h] [rbp+58h] BYREF

  v28 = stream;
  v20 = -2i64;
  lpCriticalSection = (LPCRITICAL_SECTION)&this->m_mutex;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_mutex);
  v23 = 1;
  Mysize = this->m_leaderboardNames._Mypair._Myval2._Myval2._Mysize;
  stream->m_ptr->write(stream->m_ptr, (const unsigned __int8 *)&Mysize, 4u);
  v30 = this->m_storeQueue.m_write - this->m_storeQueue.m_read;
  stream->m_ptr->write(stream->m_ptr, (const unsigned __int8 *)&v30, 4u);
  Myhead = this->m_leaderboardNames._Mypair._Myval2._Myval2._Myhead;
  Left = Myhead->_Left;
  if ( Myhead->_Left != Myhead )
  {
    do
    {
      m_stringRef = Left->_Myval.first.m_stringRef;
      IsStopping = AgSimpleThreadHost::getThreadIsStopping((Concurrency::details::ThreadProxyFactory<Concurrency::details::FreeThreadProxy> *)&m_stringRef);
      stream->m_ptr->write(stream->m_ptr, (const unsigned __int8 *)&IsStopping, 4u);
      m_ptr = stream->m_ptr;
      v7 = m_ptr->__vftable;
      v8 = IsStopping;
      CString = AgStringRef::getCString((std::shared_ptr<__ExceptionPtr> *)&m_stringRef);
      v7->write(m_ptr, (const unsigned __int8 *)CString, v8 + 1);
      second = Left->_Myval.second;
      stream->m_ptr->write(stream->m_ptr, (const unsigned __int8 *)&second, 4u);
      if ( !Left->_Isnil )
      {
        Right = Left->_Right;
        if ( Right->_Isnil )
        {
          for ( i = Left->_Parent; !i->_Isnil; i = i->_Parent )
          {
            if ( Left != i->_Right )
              break;
            Left = i;
          }
          Left = i;
        }
        else
        {
          Left = Left->_Right;
          for ( j = Right->_Left; !j->_Isnil; j = j->_Left )
            Left = j;
        }
      }
    }
    while ( Left != this->m_leaderboardNames._Mypair._Myval2._Myval2._Myhead );
  }
  *(_OWORD *)value = 0i64;
  m_ref = stream->m_ref;
  if ( stream->m_ref )
  {
    m_strongCount = m_ref->m_strongCount;
    if ( m_ref->m_strongCount )
    {
      while ( (unsigned int)AgAtomicCompareExchange(&m_ref->m_strongCount, m_strongCount, m_strongCount + 1) != m_strongCount )
      {
        m_strongCount = m_ref->m_strongCount;
        if ( !m_ref->m_strongCount )
          goto LABEL_19;
      }
      if ( m_strongCount != -1 )
      {
        value[0] = &stream->m_ref->m_strongCount;
        value[1] = (volatile int *)stream->m_ptr;
      }
    }
  }
LABEL_19:
  v21 = value;
  v25 = 0i64;
  v15 = value[0];
  if ( value[0] )
  {
    v16 = *value[0];
    if ( *value[0] )
    {
      while ( (unsigned int)AgAtomicCompareExchange(v15, v16, v16 + 1) != v16 )
      {
        v16 = *v15;
        if ( !*v15 )
          goto LABEL_26;
      }
      if ( v16 != -1 )
        v25 = *(SerializeStoreQueuePredicate *)value;
    }
  }
LABEL_26:
  AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)value);
  if ( __TSS0__1____enumerate_VSerializeStoreQueuePredicate_____AgRingBufferImpl_UStoreRankingEntry_AgLeaderboardManager__XH__QEAAIAEAVSerializeStoreQueuePredicate__HH_Z_4HA > *(_DWORD *)(*((_QWORD *)NtCurrentTeb()->Reserved1[11] + tls_index) + 40i64) )
  {
    Init_thread_header(&__TSS0__1____enumerate_VSerializeStoreQueuePredicate_____AgRingBufferImpl_UStoreRankingEntry_AgLeaderboardManager__XH__QEAAIAEAVSerializeStoreQueuePredicate__HH_Z_4HA);
    if ( __TSS0__1____enumerate_VSerializeStoreQueuePredicate_____AgRingBufferImpl_UStoreRankingEntry_AgLeaderboardManager__XH__QEAAIAEAVSerializeStoreQueuePredicate__HH_Z_4HA == -1 )
    {
      AgLeaderboardManager::StoreRankingEntry::StoreRankingEntry(&`AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int>::enumerate<SerializeStoreQueuePredicate>'::`2'::zero);
      atexit(`AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int>::enumerate<SerializeStoreQueuePredicate>'::`2'::`dynamic atexit destructor for 'zero'');
      Init_thread_footer(&__TSS0__1____enumerate_VSerializeStoreQueuePredicate_____AgRingBufferImpl_UStoreRankingEntry_AgLeaderboardManager__XH__QEAAIAEAVSerializeStoreQueuePredicate__HH_Z_4HA);
    }
  }
  for ( k = this->m_storeQueue.m_read; k < this->m_storeQueue.m_write; ++k )
    SerializeStoreQueuePredicate::operator()(&v25, &this->m_storeQueue.m_buffer[k & (this->m_storeQueue.m_sz - 1)]);
  AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)&v25);
  LeaveCriticalSection(lpCriticalSection);
  v23 = 0;
  AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)stream);
  return 1i64;
}

__int64 __fastcall AgDefaultLeaderboard::storeRanking(
        AgDefaultLeaderboard *this,
        const AgLeaderboardRanking *score,
        AgPointer<AgUser> *user)
{
  AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)user);
  return 0i64;
}

AgJobCompletion *__fastcall AgDefaultLeaderboard::storeRankingAsync(
        AgDefaultLeaderboard *this,
        AgJobCompletion *result,
        const AgLeaderboardRanking *score,
        AgPointer<AgUser> *user)
{
  result->m_threadPool = 0i64;
  result->m_jobId = 0;
  AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)user);
  return result;
}

void __fastcall AgLeaderboardManager::update(AgLeaderboardManager *this)
{
  AgMutex *p_m_mutex; // rbx
  AgThreadPool *m_threadPool; // rcx
  int v4; // er13
  AgStringRef *v5; // rax
  AgPointer<AgLeaderboard> *v6; // rax
  AgLeaderboard *m_ptr; // rdi
  AgReferenceCount *m_ref; // rbx
  int v9; // esi
  AgReferenceCount *v10; // rdi
  int m_strongCount; // ebx
  AgReferenceCount *v12; // rdi
  int v13; // ebx
  AgReferenceCount *v14; // rdi
  int v15; // ebx
  unsigned __int64 v16; // rdx
  unsigned __int64 v17; // rdx
  AgPointer<AgPlayer> *PrimaryPlayer; // rax
  AgLeaderboard *v19; // rbx
  __int64 v20; // rax
  AgUser *v21; // rdi
  AgReferenceCount *v22; // rbx
  int v23; // esi
  unsigned __int64 v24; // rdx
  unsigned __int64 v25; // rdx
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *Myhead; // rax
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *Left; // rbx
  std::_Tree_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > > v28; // r8
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *Right; // rax
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *j; // rax
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *i; // rax
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *v32; // rax
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *m; // rax
  std::_Tree_node<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> >,void *> *k; // rax
  unsigned __int64 v35; // rdx
  unsigned __int64 v36; // rdx
  AgPointer<AgStream> *v37; // rax
  void (__fastcall ***v38)(void *, __int64); // rdi
  AgReferenceCount *v39; // rbx
  unsigned __int64 v40; // rdx
  AgPointer<AgStream> *v41; // rax
  int v42; // esi
  AgPointer<AgUser> v43; // [rsp+30h] [rbp-D0h] BYREF
  AgPointer<AgFile> v44; // [rsp+40h] [rbp-C0h] BYREF
  AgPointer<AgMount> v45; // [rsp+50h] [rbp-B0h] BYREF
  AgPointer<AgLeaderboard> value; // [rsp+60h] [rbp-A0h] BYREF
  int v47; // [rsp+70h] [rbp-90h]
  AgMutex *v48; // [rsp+78h] [rbp-88h]
  AgLeaderboardManager::StoreRankingEntry items; // [rsp+80h] [rbp-80h] BYREF
  AgString v50; // [rsp+F0h] [rbp-10h] BYREF
  AgPointer<AgFile> v51; // [rsp+100h] [rbp+0h] BYREF
  AgString v52; // [rsp+110h] [rbp+10h] BYREF
  AgLeaderboardManager::StoreRankingEntry v53; // [rsp+120h] [rbp+20h] BYREF
  AgString mountPoint; // [rsp+190h] [rbp+90h] BYREF
  __int64 v55; // [rsp+1A0h] [rbp+A0h]
  AgStringRef v56; // [rsp+1B0h] [rbp+B0h] BYREF
  AgPointer<AgPlayer> result; // [rsp+1C0h] [rbp+C0h] BYREF
  AgPointer<AgPlayer> v58; // [rsp+1D0h] [rbp+D0h] BYREF
  AgPointer<AgStream> v59; // [rsp+1E0h] [rbp+E0h] BYREF
  AgPointer<AgStream> v60; // [rsp+1F0h] [rbp+F0h] BYREF
  AgStringRef v61; // [rsp+200h] [rbp+100h] BYREF
  char v62[64]; // [rsp+210h] [rbp+110h] BYREF
  std::_Tree_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<AgStringKey const ,AgPointer<AgLeaderboard> > > > > v63; // [rsp+270h] [rbp+170h] BYREF

  v55 = -2i64;
  p_m_mutex = &this->m_mutex;
  v48 = &this->m_mutex;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_mutex);
  v47 = 1;
  AgClock::tick(&this->m_clock);
  m_threadPool = this->m_storeCompletion.m_threadPool;
  if ( m_threadPool )
  {
    if ( !(unsigned int)AgThreadPool::isJobComplete(m_threadPool, this->m_storeCompletion.m_jobId) )
      goto LABEL_58;
    this->m_storeCompletion.m_threadPool = 0i64;
    this->m_storeCompletion.m_jobId = 0;
  }
  if ( AgClock::getTotalElapsedTime(&this->m_clock) > 10.0 )
  {
    AgClock::reset(&this->m_clock);
    AgLeaderboardManager::StoreRankingEntry::StoreRankingEntry(&items);
    v4 = 2;
    if ( this->m_storeQueue.m_sz + this->m_storeQueue.m_read - this->m_storeQueue.m_write < 2 )
      v4 = this->m_storeQueue.m_sz + this->m_storeQueue.m_read - this->m_storeQueue.m_write;
    if ( this->m_batchCount < v4 )
    {
      do
      {
        if ( !(unsigned int)AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int>::pop(
                              &this->m_storeQueue,
                              &items,
                              1u) )
          break;
        if ( !items.leaderboard.m_ptr || !items.leaderboard.m_ptr->m_initialized )
        {
          AgStringRef::AgStringRef(&v61, &items.leaderboardName);
          v56 = *v5;
          v6 = AgLeaderboardManager::open(this, &value, &v56);
          AgPointer<AgLeaderboard>::operator=(&items.leaderboard, v6);
          m_ptr = value.m_ptr;
          value.m_ptr = 0i64;
          m_ref = value.m_ref;
          if ( value.m_ref )
          {
            value.m_ref = 0i64;
            v9 = 0;
            if ( !(unsigned int)AgAtomicDecrement(&m_ref->m_strongCount) )
            {
              if ( !(unsigned int)AgAtomicDecrement(&m_ref->m_weakCount) )
                v9 = 1;
              m_ref->m_data = 0i64;
              if ( m_ptr )
                ((void (__fastcall *)(AgLeaderboard *, __int64))m_ptr->~AgLeaderboard)(m_ptr, 1i64);
              if ( v9 )
                AgReferenceCount::operator delete(m_ref);
            }
          }
        }
        v53.requestId = items.requestId;
        v53.retryCount = items.retryCount;
        AgString::AgString(&v53.leaderboardName, &items.leaderboardName);
        v53.leaderboard = 0i64;
        v10 = items.leaderboard.m_ref;
        if ( items.leaderboard.m_ref )
        {
          m_strongCount = items.leaderboard.m_ref->m_strongCount;
          if ( items.leaderboard.m_ref->m_strongCount )
          {
            while ( (unsigned int)AgAtomicCompareExchange(&v10->m_strongCount, m_strongCount, m_strongCount + 1) != m_strongCount )
            {
              m_strongCount = v10->m_strongCount;
              if ( !v10->m_strongCount )
                goto LABEL_26;
            }
            if ( m_strongCount != -1 )
              v53.leaderboard = items.leaderboard;
          }
        }
LABEL_26:
        v53.score.m_profileId = items.score.m_profileId;
        v53.score.m_rank = items.score.m_rank;
        v53.score.m_score = items.score.m_score;
        AgString::AgString(&v53.score.m_comment, &items.score.m_comment);
        v53.score.m_data = 0i64;
        v12 = items.score.m_data.m_ref;
        if ( items.score.m_data.m_ref )
        {
          v13 = items.score.m_data.m_ref->m_strongCount;
          if ( items.score.m_data.m_ref->m_strongCount )
          {
            while ( (unsigned int)AgAtomicCompareExchange(&v12->m_strongCount, v13, v13 + 1) != v13 )
            {
              v13 = v12->m_strongCount;
              if ( !v12->m_strongCount )
                goto LABEL_33;
            }
            if ( v13 != -1 )
              v53.score.m_data = items.score.m_data;
          }
        }
LABEL_33:
        v53.user = 0i64;
        v14 = items.user.m_ref;
        if ( items.user.m_ref )
        {
          v15 = items.user.m_ref->m_strongCount;
          if ( items.user.m_ref->m_strongCount )
          {
            while ( (unsigned int)AgAtomicCompareExchange(&v14->m_strongCount, v15, v15 + 1) != v15 )
            {
              v15 = v14->m_strongCount;
              if ( !v14->m_strongCount )
                goto LABEL_40;
            }
            if ( v15 != -1 )
              v53.user = items.user;
          }
        }
LABEL_40:
        AgRingBufferImpl<AgLeaderboardManager::StoreRankingEntry,void,int>::push(&this->m_storeQueue, &v53, 1u);
        AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)&v53.user);
        AgPointer<AgBuffer<AgAllocator<1>>>::~AgPointer<AgBuffer<AgAllocator<1>>>(&v53.score.m_data);
        AgString::~AgString(&v53.score.m_comment, v16);
        AgPointer<AgLeaderboard>::~AgPointer<AgLeaderboard>(&v53.leaderboard);
        AgString::~AgString(&v53.leaderboardName, v17);
        PrimaryPlayer = AgPlayerManager::getPrimaryPlayer(
                          (AgPlayerManager *)AgSingleton<AgPlayerManager>::ms_instance,
                          &result);
        AgPlayer::getUser(PrimaryPlayer->m_ptr, &v43);
        AgPointer<AgPlayer>::~AgPointer<AgPlayer>(&result);
        if ( items.leaderboard.m_ptr
          && items.leaderboard.m_ptr->m_initialized
          && v43.m_ptr
          && v43.m_ptr->isSignedIn(v43.m_ptr)
          && v43.m_ptr->isOnline(v43.m_ptr)
          && !v43.m_ptr->isAgeRestricted(v43.m_ptr) )
        {
          v19 = items.leaderboard.m_ptr;
          AgPointer<AgBuffer<AgAllocator<1>>>::AgPointer<AgBuffer<AgAllocator<1>>>(
            &v58,
            (const AgPointer<AgPlayer> *)&items.user);
          this->m_storeCompletion = *(AgJobCompletion *)((__int64 (__fastcall *)(AgLeaderboard *, char *, _QWORD, AgLeaderboardRanking *, __int64))v19->_storeRankingAsync)(
                                                          v19,
                                                          v62,
                                                          (unsigned int)items.requestId,
                                                          &items.score,
                                                          v20);
        }
        ++this->m_batchCount;
        v21 = v43.m_ptr;
        v43.m_ptr = 0i64;
        v22 = v43.m_ref;
        if ( v43.m_ref )
        {
          v43.m_ref = 0i64;
          v23 = 0;
          if ( !(unsigned int)AgAtomicDecrement(&v22->m_strongCount) )
          {
            if ( !(unsigned int)AgAtomicDecrement(&v22->m_weakCount) )
              v23 = 1;
            v22->m_data = 0i64;
            if ( v21 )
              ((void (__fastcall *)(AgUser *, __int64))v21->~AgUser)(v21, 1i64);
            if ( v23 )
              AgReferenceCount::operator delete(v22);
          }
        }
      }
      while ( this->m_batchCount < v4 );
      p_m_mutex = v48;
    }
    this->m_batchCount = 0;
    AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)&items.user);
    AgPointer<AgBuffer<AgAllocator<1>>>::~AgPointer<AgBuffer<AgAllocator<1>>>(&items.score.m_data);
    AgString::~AgString(&items.score.m_comment, v24);
    AgPointer<AgLeaderboard>::~AgPointer<AgLeaderboard>(&items.leaderboard);
    AgString::~AgString(&items.leaderboardName, v25);
  }
LABEL_58:
  LeaveCriticalSection((LPCRITICAL_SECTION)p_m_mutex);
  v47 = 0;
  Myhead = this->m_leaderboards._Mypair._Myval2._Myval2._Myhead;
  Left = Myhead->_Left;
  if ( Myhead->_Left != Myhead )
  {
    do
    {
      if ( Left->_Myval.second.m_ptr->m_refCount->m_strongCount == 1 )
      {
        v28._Ptr = Left;
        if ( !Left->_Isnil )
        {
          Right = Left->_Right;
          if ( Right->_Isnil )
          {
            for ( i = Left->_Parent; !i->_Isnil; i = i->_Parent )
            {
              if ( Left != i->_Right )
                break;
              Left = i;
            }
            Left = i;
          }
          else
          {
            Left = Left->_Right;
            for ( j = Right->_Left; !j->_Isnil; j = j->_Left )
              Left = j;
          }
        }
        std::_Tree<std::_Tmap_traits<AgStringKey,AgPointer<AgLeaderboard>,std::less<AgStringKey>,std::allocator<std::pair<AgStringKey const,AgPointer<AgLeaderboard>>>,0>>::erase(
          &this->m_leaderboards,
          &v63,
          v28);
      }
      else if ( !Left->_Isnil )
      {
        v32 = Left->_Right;
        if ( v32->_Isnil )
        {
          for ( k = Left->_Parent; !k->_Isnil; k = k->_Parent )
          {
            if ( Left != k->_Right )
              break;
            Left = k;
          }
          Left = k;
        }
        else
        {
          Left = Left->_Right;
          for ( m = v32->_Left; !m->_Isnil; m = m->_Left )
            Left = m;
        }
      }
    }
    while ( Left != this->m_leaderboards._Mypair._Myval2._Myval2._Myhead );
  }
  if ( this->m_loadedStoreQueue )
  {
    if ( this->m_cacheStoreQueue )
    {
      AgString::AgString(&v52, "savedata:ag/silverware/leaderboard_store", -1);
      AgPath::clean((AgPath *)&v52);
      AgFileSystem::open((AgFileSystem *)AgSingleton<AgFileSystem>::ms_instance, &v44, (const AgPath *)&v52, 2u);
      AgString::~AgString(&v52, v40);
      if ( (unsigned int)AgFile::waitOpen(v44.m_ptr) )
      {
        v41 = AgPointer<AgFile>::operator<AgStream> AgPointer<AgStream>(&v44, &v60);
        ((void (__fastcall *)(AgLeaderboardManager *, AgPointer<AgStream> *))this->serialize)(this, v41);
      }
      this->m_cacheStoreQueue = 0;
      v38 = (void (__fastcall ***)(void *, __int64))v44.m_ptr;
      v44.m_ptr = 0i64;
      v39 = v44.m_ref;
      if ( v44.m_ref )
      {
        v44.m_ref = 0i64;
LABEL_93:
        v42 = 0;
        if ( !(unsigned int)AgAtomicDecrement(&v39->m_strongCount) )
        {
          if ( !(unsigned int)AgAtomicDecrement(&v39->m_weakCount) )
            v42 = 1;
          v39->m_data = 0i64;
          if ( v38 )
            (**v38)(v38, 1i64);
          if ( v42 )
            AgReferenceCount::operator delete(v39);
        }
      }
    }
  }
  else
  {
    AgString::AgString(&mountPoint, "savedata", -1);
    AgFileSystem::getMount((AgFileSystem *)AgSingleton<AgFileSystem>::ms_instance, &v45, &mountPoint);
    AgString::~AgString(&mountPoint, v35);
    if ( v45.m_ptr && v45.m_ptr->m_mounted )
    {
      AgString::AgString(&v50, "savedata:ag/silverware/leaderboard_store", -1);
      AgPath::clean((AgPath *)&v50);
      AgFileSystem::open((AgFileSystem *)AgSingleton<AgFileSystem>::ms_instance, &v51, (const AgPath *)&v50, 1u);
      AgString::~AgString(&v50, v36);
      if ( (unsigned int)AgFile::waitOpen(v51.m_ptr) )
      {
        v37 = AgPointer<AgFile>::operator<AgStream> AgPointer<AgStream>(&v51, &v59);
        ((void (__fastcall *)(AgLeaderboardManager *, AgPointer<AgStream> *))this->deserialize)(this, v37);
      }
      this->m_loadedStoreQueue = 1;
      AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)&v51);
    }
    v38 = (void (__fastcall ***)(void *, __int64))v45.m_ptr;
    v45.m_ptr = 0i64;
    v39 = v45.m_ref;
    if ( v45.m_ref )
    {
      v45.m_ref = 0i64;
      goto LABEL_93;
    }
  }
}

