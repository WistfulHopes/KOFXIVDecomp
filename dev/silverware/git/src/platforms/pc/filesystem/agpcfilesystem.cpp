#include "dev/silverware/git/sdk/agstring.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/string"
#include "program files (x86)/windows kits/8.1/include/um/winuser.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xtgmath.h"
#include "dev/silverware/git/sdk/3rdparty/steam/matchmakingtypes.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/ios"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xtr1common"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wstring.h"
#include "dev/silverware/git/sdk/agsemaphore.inl"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xlocnum"
#include "program files (x86)/windows kits/8.1/include/um/propidl.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xiosbase"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xlocale"
#include "dev/silverware/git/sdk/system/aguser.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xlocinfo"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xstddef"
#include "dev/silverware/git/sdk/agpointer.h"
#include "dev/silverware/git/sdk/agreferencedobject.h"
#include "dev/silverware/git/sdk/agreferencecount.h"
#include "dev/silverware/git/sdk/agstream.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/mutex"
#include "program files (x86)/windows kits/8.1/include/um/shobjidl.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/chrono"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vcruntime_exception.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/limits"
#include "program files (x86)/windows kits/8.1/include/um/combaseapi.h"
#include "program files (x86)/windows kits/8.1/include/shared/stralign.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/string.h"
#include "program files (x86)/windows kits/8.1/include/shared/basetsd.h"
#include "dev/silverware/git/sdk/system/agsysteminfo.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_memory.h"
#include "dev/silverware/git/sdk/filesystem/agdirectory.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/system_error"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/stdlib.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_memcpy_s.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/utility"
#include "dev/silverware/git/sdk/agmutex.inl"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/stdexcept"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/iosfwd"
#include "dev/silverware/git/sdk/memory/agbuffer.h"
#include "dev/silverware/git/sdk/memory/agallocators.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/stdio.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/tuple"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wio.h"
#include "program files (x86)/windows kits/8.1/include/um/winbase.h"
#include "dev/silverware/git/sdk/3rdparty/steam/steamclientpublic.h"
#include "dev/silverware/git/src/platforms/shared/filesystem/agvirtualmount.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vector"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/type_traits"
#include "dev/silverware/git/sdk/platforms/pc/system/agpcsysteminfo.h"
#include "program files (x86)/windows kits/8.1/include/um/propkeydef.h"
#include "dev/silverware/git/sdk/util/agdebugchannels.h"
#include "dev/silverware/git/sdk/util/agperformancecounter.h"
#include "dev/silverware/git/sdk/agclock.h"
#include "dev/silverware/git/sdk/agreferencecountinl.h"
#include "program files (x86)/windows kits/8.1/include/um/propsys.h"
#include "program files (x86)/windows kits/8.1/include/um/commctrl.h"
#include "dev/silverware/git/src/platforms/pc/filesystem/agpcstoragemount.h"
#include "dev/silverware/git/sdk/agcondition.inl"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/time.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/thread"
#include "program files (x86)/windows kits/8.1/include/um/winnt.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/memory"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/ctype.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xmemory"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/thr/xthread"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/cmath"
#include "dev/silverware/git/sdk/util/agdelegate.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/math.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/wchar.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wconio.h"
#include "dev/silverware/git/sdk/filesystem/agfile.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_stdio_config.h"
#include "dev/silverware/git/sdk/agthreadpool.h"
#include "dev/silverware/git/sdk/agcondition.h"
#include "dev/silverware/git/sdk/agconditionvariable.h"
#include "dev/silverware/git/sdk/util/agservice.h"
#include "dev/silverware/git/sdk/agsemaphore.h"
#include "dev/silverware/git/sdk/agmath.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/condition_variable"
#include "dev/silverware/git/sdk/agthread.h"
#include "dev/silverware/git/sdk/agpointerinl.h"
#include "dev/silverware/git/sdk/filesystem/agmount.h"
#include "program files (x86)/windows kits/8.1/include/um/oleauto.h"
#include "dev/silverware/git/sdk/filesystem/agpath.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/sys/stat.h"
#include "dev/silverware/git/sdk/3rdparty/steam/isteamhtmlsurface.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xatomic0.h"
#include "program files (x86)/windows kits/8.1/include/um/shlwapi.h"
#include "dev/silverware/git/sdk/agmemorypool.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/functional"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xstring"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xmemory0"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/exception"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/malloc.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/map"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xfacet"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vcruntime_new.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xtree"
#include "dev/silverware/git/sdk/3rdparty/steam/steam_api_internal.h"
#include "dev/silverware/git/sdk/agreferenceinl.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wtime.h"
#include "dev/silverware/git/src/platforms/shared/filesystem/agsteamremotemount.h"
#include "program files (x86)/windows kits/8.1/include/um/shlobj.h"
#include "dev/silverware/git/sdk/3rdparty/steam/steam_api.h"
#include "dev/silverware/git/sdk/agreferencedobjectinl.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wstdio.h"
#include "program files (x86)/windows kits/8.1/include/shared/winerror.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vadefs.h"
#include "dev/silverware/git/sdk/agconditionvariable.inl"
#include "dev/silverware/git/sdk/agsingleton.h"
#include "dev/silverware/git/sdk/util/agservicecommand.h"
#include "dev/silverware/git/sdk/system/agusermanager.h"
#include "dev/silverware/git/sdk/agmutex.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vcruntime_typeinfo.h"
#include "dev/silverware/git/sdk/agscopedlock.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xutility"
#include "program files (x86)/windows kits/8.1/include/shared/guiddef.h"

typedef const char * PCSTR;
typedef char * PSTR;
AgPCFileSystem::AgPCFileSystem(); // 0x14068D180
AgPath AgPCFileSystem::getSystemSavePath(); // 0x14068D430
AgPointer<AgMount> AgPCFileSystem::mount(AgMountPoint mountPoint, AgMountType mountType); // 0x14068D580
AgPointer<AgMount> AgPCFileSystem::mountUser(AgPointer<AgUser> user); // 0x14068DDA0void __fastcall AgPCFileSystem::AgPCFileSystem(AgPCFileSystem *this)
{
  unsigned __int64 v2; // rdx
  unsigned __int64 v3; // rdx
  AgString v4; // [rsp+28h] [rbp-20h] BYREF

  AgFileSystem::AgFileSystem(this);
  this->__vftable = (AgPCFileSystem_vtbl *)&AgPCFileSystem::`vftable';
  AgString::AgString(&v4, "Content", -1);
  AgPath::clean((AgPath *)&v4);
  AgFileSystem::setMountPointPath(AgMountPoint_Content, (const AgPath *)&v4, 0);
  AgString::~AgString(&v4, v2);
  AgString::AgString(&v4, "SaveData", -1);
  AgPath::clean((AgPath *)&v4);
  AgFileSystem::setMountPointPath(AgMountPoint_SaveData, (const AgPath *)&v4, 0);
  AgString::~AgString(&v4, v3);
}

void __fastcall AgPCStorageMount::AgPCStorageMount(
        AgPCStorageMount *this,
        const AgString *mountPoint,
        const AgPath *systemPath,
        AgPointer<AgUser> *user)
{
  AgPointer<AgUser> *v8; // rax
  AgPointer<AgPlayer> v9; // [rsp+28h] [rbp-30h] BYREF

  AgPointer<AgBuffer<AgAllocator<1>>>::AgPointer<AgBuffer<AgAllocator<1>>>(&v9, (const AgPointer<AgPlayer> *)user);
  AgMount::AgMount(this, mountPoint, v8);
  this->__vftable = (AgPCStorageMount_vtbl *)&AgPCStorageMount::`vftable';
  AgString::AgString(&this->m_systemPath.m_path, &systemPath->m_path);
  AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)user);
}

void __fastcall AgSteamRemoteMount::AgSteamRemoteMount(
        AgSteamRemoteMount *this,
        const AgString *mountPoint,
        AgPointer<AgUser> *user)
{
  AgPointer<AgUser> *v6; // rax
  AgPointer<AgPlayer> v7; // [rsp+28h] [rbp-30h] BYREF

  AgPointer<AgBuffer<AgAllocator<1>>>::AgPointer<AgBuffer<AgAllocator<1>>>(&v7, (const AgPointer<AgPlayer> *)user);
  AgMount::AgMount(this, mountPoint, v6);
  this->__vftable = (AgSteamRemoteMount_vtbl *)&AgSteamRemoteMount::`vftable';
  AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)user);
}

AgPath *__fastcall AgPCFileSystem::getSystemSavePath(AgPCFileSystem *this, AgPath *result)
{
  HRESULT v3; // ebx
  unsigned __int64 v4; // rdx
  char *CString; // rax
  unsigned __int64 v6; // rdx
  AgString move; // [rsp+38h] [rbp-260h] BYREF
  AgString copy; // [rsp+48h] [rbp-250h] BYREF
  __int64 v10; // [rsp+58h] [rbp-240h]
  AgPath *v11; // [rsp+60h] [rbp-238h]
  wchar_t text[264]; // [rsp+70h] [rbp-228h] BYREF

  v10 = -2i64;
  v11 = result;
  v3 = SHGetFolderPathW(0i64, 5, 0i64, 0, text);
  AgTrace("INFO: AgPCFileSystem::getSystemSavePath");
  if ( v3 )
  {
    AgTrace("ERROR: Could not resolve documents path!");
    AgString::AgString(&result->m_path, "My Games", -1);
    AgPath::clean(result);
  }
  else
  {
    PathAppendW(text, L"My Games");
    AgString::AgString(&copy, text, -1);
    AgString::AgString(&move, &copy);
    AgPath::clean((AgPath *)&move);
    AgString::~AgString(&copy, v4);
    CString = AgString::getCString(&move);
    AgTrace("INFO: Save Path: %s", CString);
    AgString::AgString(&result->m_path, &move);
    AgString::~AgString(&move, v6);
  }
  return result;
}

AgPointer<AgMount> *__fastcall AgPCFileSystem::mount(
        AgPCFileSystem *this,
        AgPointer<AgMount> *result,
        AgMountPoint mountPoint,
        AgMountType mountType)
{
  AgMount *v8; // rsi
  AgPath *MountPath; // rax
  int v10; // er12
  __int16 v11; // di
  unsigned __int64 v12; // rdx
  AgPCStorageMount *v13; // r14
  const AgPath *SystemSavePath; // rbx
  const AgString *MountName; // rax
  KOFApplication *v16; // rax
  KOFApplication *v17; // rbx
  __m128i si128; // xmm6
  AgReferenceCount *v19; // rax
  AgReferenceCount *m_refCount; // r14
  AgDelayedSaveDataMount *v21; // r14
  const AgPath *v22; // rbx
  const AgString *v23; // rax
  AgMount *v24; // rax
  unsigned __int64 v25; // rdx
  unsigned __int64 v26; // rdx
  AgSteamRemoteMount *v27; // rbx
  const AgString *v28; // rax
  AgMount *v29; // rax
  AgPath *v30; // rcx
  unsigned __int64 v31; // rdx
  char *v32; // r14
  const AgString *v33; // rbx
  AgPointer<AgUser> *v34; // rax
  __m128i v35; // xmm6
  _DWORD *v36; // rax
  AgReferenceCount *v37; // rbx
  AgDelayedSaveDataMount *v38; // rbx
  const AgString *v39; // rax
  AgMount *v40; // rax
  unsigned __int64 v41; // rdx
  AgPCStorageMount *v42; // r14
  AgPath *v43; // rax
  const AgPath *v44; // rbx
  const AgString *v45; // rax
  AgMount *v46; // rax
  AgSteamRemoteMount *v47; // rbx
  const AgString *v48; // rax
  AgMount *v49; // rax
  AgVirtualMount *v50; // rbx
  const AgString *v51; // rax
  AgMount *v52; // rax
  AgPCStorageMount *v53; // r14
  const AgString *v54; // rax
  AgMount *v55; // rax
  AgPointer<AgMount> *v56; // rax
  _QWORD v58[3]; // [rsp+48h] [rbp-C0h] BYREF
  AgPointer<KOFApplication> v59; // [rsp+68h] [rbp-A0h] BYREF
  AgPointer<KOFApplication> v60; // [rsp+78h] [rbp-90h] BYREF
  AgString copy; // [rsp+88h] [rbp-80h] BYREF
  AgPointer<AgPlayer> rhs; // [rsp+98h] [rbp-70h] BYREF
  AgString v63; // [rsp+A8h] [rbp-60h] BYREF
  AgString v64; // [rsp+B8h] [rbp-50h] BYREF
  AgPointer<AgUser> v65; // [rsp+C8h] [rbp-40h] BYREF
  AgPointer<AgUser> v66; // [rsp+D8h] [rbp-30h] BYREF
  AgPointer<AgUser> v67; // [rsp+E8h] [rbp-20h] BYREF
  __m128i v68; // [rsp+F8h] [rbp-10h] BYREF
  AgPointer<AgUser> v69; // [rsp+108h] [rbp+0h] BYREF
  __m128i v70; // [rsp+118h] [rbp+10h] BYREF
  AgPointer<AgUser> v71; // [rsp+128h] [rbp+20h] BYREF
  void *v72[2]; // [rsp+138h] [rbp+30h] BYREF
  void *block[2]; // [rsp+148h] [rbp+40h] BYREF
  __int64 v74; // [rsp+158h] [rbp+50h]
  AgString v75; // [rsp+160h] [rbp+58h] BYREF
  AgPath resulta; // [rsp+170h] [rbp+68h] BYREF
  AgString v77; // [rsp+180h] [rbp+78h] BYREF
  AgPath v78; // [rsp+190h] [rbp+88h] BYREF
  AgString v79; // [rsp+1A0h] [rbp+98h] BYREF
  AgPointer<AgPlayer> v80; // [rsp+1B0h] [rbp+A8h] BYREF
  AgString v81; // [rsp+1C0h] [rbp+B8h] BYREF
  AgString v82; // [rsp+1D0h] [rbp+C8h] BYREF
  AgString v83; // [rsp+1E0h] [rbp+D8h] BYREF
  AgPath v84; // [rsp+1F0h] [rbp+E8h] BYREF
  AgPath v85; // [rsp+200h] [rbp+F8h] BYREF
  AgString v86; // [rsp+210h] [rbp+108h] BYREF
  AgString v87; // [rsp+220h] [rbp+118h] BYREF
  AgString v88; // [rsp+230h] [rbp+128h] BYREF
  AgPointer<AgPlayer> v89; // [rsp+240h] [rbp+138h] BYREF

  v74 = -2i64;
  v8 = 0i64;
  MountPath = AgFileSystem::getMountPath(mountPoint);
  AgString::AgString(&copy, &MountPath->m_path);
  result->m_ref = 0i64;
  result->m_ptr = 0i64;
  v10 = 1;
  v11 = 1;
  switch ( mountPoint )
  {
    case AgMountPoint_SaveData:
      if ( mountType != AgMountType_Steam )
      {
        v13 = (AgPCStorageMount *)operator new(0x138ui64);
        v58[1] = v13;
        if ( v13 )
        {
          v66 = 0i64;
          SystemSavePath = AgPCFileSystem::getSystemSavePath(this, &resulta);
          MountName = AgFileSystem::getMountName(&v75, AgMountPoint_Internal);
          LOBYTE(v11) = 13;
          AgPCStorageMount::AgPCStorageMount(v13, MountName, SystemSavePath, &v66);
          v17 = v16;
        }
        else
        {
          v17 = 0i64;
        }
        si128 = 0i64;
        v59 = 0i64;
        if ( v17 )
        {
          if ( v17->m_refCount )
          {
            v10 = 0;
          }
          else
          {
            v19 = (AgReferenceCount *)AgReferenceCount::operator new(0x10ui64);
            if ( v19 )
            {
              v19->m_strongCount = 1;
              v19->m_weakCount = 1;
              v19->m_data = v17;
            }
            else
            {
              v19 = 0i64;
            }
            v17->m_refCount = v19;
          }
          m_refCount = v17->m_refCount;
          if ( !v10 )
            AgReferenceCount::incRef(v17->m_refCount);
          v59.m_ref = m_refCount;
          v59.m_ptr = v17;
          si128 = _mm_load_si128((const __m128i *)&v59);
        }
        if ( (v11 & 8) != 0 )
        {
          LOBYTE(v11) = v11 & 0xF7;
          AgString::~AgString(&v75, v12);
        }
        if ( (v11 & 4) != 0 )
        {
          LOBYTE(v11) = v11 & 0xFB;
          AgString::~AgString(&resulta.m_path, v12);
        }
        v21 = (AgDelayedSaveDataMount *)operator new(0x1D8ui64);
        if ( v21 )
        {
          v58[1] = &v67;
          AgString::AgString(&v64, "savedata.vfs", -1);
          AgPath::clean((AgPath *)&v64);
          v67 = 0i64;
          v22 = AgPath::operator/((AgPath *)&copy, &v78, (const AgPath *)&v64);
          v68 = si128;
          v59 = 0i64;
          v23 = AgFileSystem::getMountName(&v77, AgMountPoint_SaveData);
          LOBYTE(v11) = v11 | 0x70;
          AgDelayedSaveDataMount::AgDelayedSaveDataMount(v21, v23, (AgPointer<AgMount> *)&v68, v22, &v67);
          v8 = v24;
        }
        AgPointer<AgMount>::operator=(result, v8);
        if ( (v11 & 0x40) != 0 )
        {
          LOBYTE(v11) = v11 & 0xBF;
          AgString::~AgString(&v77, v25);
        }
        if ( (v11 & 0x20) != 0 )
        {
          LOBYTE(v11) = v11 & 0xDF;
          AgString::~AgString(&v78.m_path, v25);
        }
        if ( (v11 & 0x10) != 0 )
          AgString::~AgString(&v64, v25);
        AgPointer<AgUser>::~AgPointer<AgUser>(&v59);
        break;
      }
      v27 = (AgSteamRemoteMount *)operator new(0x128ui64);
      if ( v27 )
      {
        *(_OWORD *)&v58[1] = 0i64;
        v28 = AgFileSystem::getMountName(&v79, AgMountPoint_SaveData);
        LOBYTE(v11) = 3;
        AgSteamRemoteMount::AgSteamRemoteMount(v27, v28, (AgPointer<AgUser> *)&v58[1]);
        v8 = v29;
      }
      AgPointer<AgMount>::operator=(result, v8);
      if ( (v11 & 2) != 0 )
      {
        v30 = (AgPath *)&v79;
LABEL_79:
        AgString::~AgString(&v30->m_path, v26);
      }
      break;
    case AgMountPoint_CloudData:
      v32 = (char *)operator new(0x138ui64);
      if ( v32 )
      {
        rhs = 0i64;
        v58[1] = &rhs;
        v33 = AgFileSystem::getMountName(&v81, AgMountPoint_Internal);
        v11 = 129;
        AgPointer<AgBuffer<AgAllocator<1>>>::AgPointer<AgBuffer<AgAllocator<1>>>(&v80, &rhs);
        AgMount::AgMount((AgMount *)v32, v33, v34);
        *(_QWORD *)v32 = &AgPCStorageMount::`vftable';
        AgString::AgString((AgString *)(v32 + 296), &copy);
        AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)&rhs);
      }
      else
      {
        v32 = 0i64;
      }
      v35 = 0i64;
      v60 = 0i64;
      if ( v32 )
      {
        if ( *((_QWORD *)v32 + 1) )
        {
          v10 = 0;
        }
        else
        {
          v36 = AgReferenceCount::operator new(0x10ui64);
          if ( v36 )
          {
            *v36 = 1;
            v36[1] = 1;
            *((_QWORD *)v36 + 1) = v32;
          }
          else
          {
            v36 = 0i64;
          }
          *((_QWORD *)v32 + 1) = v36;
        }
        v37 = (AgReferenceCount *)*((_QWORD *)v32 + 1);
        if ( !v10 )
          AgReferenceCount::incRef(*((AgReferenceCount **)v32 + 1));
        v60.m_ref = v37;
        v60.m_ptr = (KOFApplication *)v32;
        v35 = _mm_load_si128((const __m128i *)&v60);
      }
      if ( (v11 & 0x80u) != 0 )
      {
        v11 &= ~0x80u;
        AgString::~AgString(&v81, v31);
      }
      v38 = (AgDelayedSaveDataMount *)operator new(0x1D8ui64);
      if ( v38 )
      {
        AgString::AgString(&v63, "clouddata.vfs", -1);
        AgPath::clean((AgPath *)&v63);
        v58[1] = &v70;
        v69 = 0i64;
        v70 = v35;
        v60 = 0i64;
        v39 = AgFileSystem::getMountName(&v82, AgMountPoint_CloudData);
        v11 |= 0x300u;
        AgDelayedSaveDataMount::AgDelayedSaveDataMount(v38, v39, (AgPointer<AgMount> *)&v70, (const AgPath *)&v63, &v69);
        v8 = v40;
      }
      AgPointer<AgMount>::operator=(result, v8);
      if ( (v11 & 0x200) != 0 )
      {
        v11 &= ~0x200u;
        AgString::~AgString(&v82, v41);
      }
      if ( (v11 & 0x100) != 0 )
        AgString::~AgString(&v63, v41);
      AgPointer<AgUser>::~AgPointer<AgUser>(&v60);
      break;
    case AgMountPoint_Config:
      if ( mountType == AgMountType_Steam )
      {
        v47 = (AgSteamRemoteMount *)operator new(0x128ui64);
        if ( v47 )
        {
          *(_OWORD *)v72 = 0i64;
          v48 = AgFileSystem::getMountName(&v86, AgMountPoint_Config);
          v11 = 1025;
          AgSteamRemoteMount::AgSteamRemoteMount(v47, v48, (AgPointer<AgUser> *)v72);
          v8 = v49;
        }
        AgPointer<AgMount>::operator=(result, v8);
        if ( (v11 & 0x400) != 0 )
        {
          v30 = (AgPath *)&v86;
          goto LABEL_79;
        }
      }
      else
      {
        v42 = (AgPCStorageMount *)operator new(0x138ui64);
        if ( v42 )
        {
          v71 = 0i64;
          v43 = AgPCFileSystem::getSystemSavePath(this, &v85);
          v44 = AgPath::operator/(v43, &v84, (const AgPath *)&copy);
          v45 = AgFileSystem::getMountName(&v83, AgMountPoint_Config);
          v11 = 14337;
          AgPCStorageMount::AgPCStorageMount(v42, v45, v44, &v71);
          v8 = v46;
        }
        AgPointer<AgMount>::operator=(result, v8);
        if ( (v11 & 0x2000) != 0 )
        {
          v11 &= ~0x2000u;
          AgString::~AgString(&v83, v26);
        }
        if ( (v11 & 0x1000) != 0 )
        {
          v11 &= ~0x1000u;
          AgString::~AgString(&v84.m_path, v26);
        }
        if ( (v11 & 0x800) != 0 )
        {
          v30 = &v85;
          goto LABEL_79;
        }
      }
      break;
    case AgMountPoint_Temp:
      v50 = (AgVirtualMount *)operator new(0x150ui64);
      if ( v50 )
      {
        *(_OWORD *)block = 0i64;
        v51 = AgFileSystem::getMountName(&v87, AgMountPoint_Temp);
        v11 = 16385;
        AgVirtualMount::AgVirtualMount(v50, v51, (AgPointer<AgUser> *)block);
        v8 = v52;
      }
      AgPointer<AgMount>::operator=(result, v8);
      if ( (v11 & 0x4000) != 0 )
      {
        v30 = (AgPath *)&v87;
        goto LABEL_79;
      }
      break;
    default:
      v53 = (AgPCStorageMount *)operator new(0x138ui64);
      if ( v53 )
      {
        v65 = 0i64;
        v54 = AgFileSystem::getMountName(&v88, mountPoint);
        v11 = -32767;
        AgPCStorageMount::AgPCStorageMount(v53, v54, (const AgPath *)&copy, &v65);
        v8 = v55;
      }
      AgPointer<AgMount>::operator=(result, v8);
      if ( (v11 & 0x8000) != 0 )
      {
        v30 = (AgPath *)&v88;
        goto LABEL_79;
      }
      break;
  }
  if ( result->m_ptr )
  {
    AgPointer<AgBuffer<AgAllocator<1>>>::AgPointer<AgBuffer<AgAllocator<1>>>(&v89, (const AgPointer<AgPlayer> *)result);
    AgFileSystem::mount(this, v56);
  }
  AgString::~AgString(&copy, v26);
  return result;
}

AgPointer<AgMount> *__fastcall AgPCFileSystem::mountUser(
        AgPCFileSystem *this,
        AgPointer<AgMount> *result,
        AgPointer<AgUser> *user)
{
  char v6; // si
  AgPCStorageMount *v7; // r12
  AgPointer<AgUser> *v8; // rax
  AgPointer<AgUser> *v9; // rdi
  AgPointer<AgUser> *v10; // rax
  const AgPath *UserMountPath; // rbx
  AgPointer<AgUser> *v12; // rax
  AgPath *UserMountName; // rax
  AgMount *v14; // rax
  unsigned __int64 v15; // rdx
  char v16; // si
  AgPointer<AgMount> *v17; // rax
  AgString v19; // [rsp+30h] [rbp-51h] BYREF
  __int64 v20; // [rsp+40h] [rbp-41h]
  AgPointer<AgPlayer> *v21; // [rsp+48h] [rbp-39h]
  AgPointer<AgPlayer> *v22; // [rsp+50h] [rbp-31h]
  AgPointer<AgPlayer> *v23; // [rsp+58h] [rbp-29h]
  AgPointer<AgPlayer> v24; // [rsp+60h] [rbp-21h] BYREF
  AgPointer<AgPlayer> v25; // [rsp+70h] [rbp-11h] BYREF
  AgPointer<AgPlayer> v26; // [rsp+80h] [rbp-1h] BYREF
  AgString v27; // [rsp+90h] [rbp+Fh] BYREF

  v20 = -2i64;
  v6 = 0;
  v7 = (AgPCStorageMount *)operator new(0x138ui64);
  if ( v7 )
  {
    v21 = &v24;
    v22 = &v25;
    v23 = &v26;
    AgPointer<AgBuffer<AgAllocator<1>>>::AgPointer<AgBuffer<AgAllocator<1>>>(&v24, (const AgPointer<AgPlayer> *)user);
    v9 = v8;
    AgPointer<AgBuffer<AgAllocator<1>>>::AgPointer<AgBuffer<AgAllocator<1>>>(&v25, (const AgPointer<AgPlayer> *)user);
    UserMountPath = AgFileSystem::getUserMountPath((AgPath *)&v19, v10);
    AgPointer<AgBuffer<AgAllocator<1>>>::AgPointer<AgBuffer<AgAllocator<1>>>(&v26, (const AgPointer<AgPlayer> *)user);
    UserMountName = AgFileSystem::getUserMountName((AgPath *)&v27, v12);
    v6 = 3;
    AgPCStorageMount::AgPCStorageMount(v7, &UserMountName->m_path, UserMountPath, v9);
  }
  else
  {
    v14 = 0i64;
  }
  AgPointer<AgMount>::AgPointer<AgMount>(result, v14);
  v16 = v6 | 4;
  if ( (v16 & 2) != 0 )
  {
    v16 &= ~2u;
    AgString::~AgString(&v27, v15);
  }
  if ( (v16 & 1) != 0 )
    AgString::~AgString(&v19, v15);
  AgPointer<AgBuffer<AgAllocator<1>>>::AgPointer<AgBuffer<AgAllocator<1>>>(
    (AgPointer<AgPlayer> *)&v19,
    (const AgPointer<AgPlayer> *)result);
  AgFileSystem::mount(this, v17);
  AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)user);
  return result;
}

AgPointer<AgDirectory> *__fastcall AgSteamRemoteMount::openDirectory(
        AgSteamRemoteMount *this,
        AgPointer<AgDirectory> *result,
        const AgPath *path,
        AgStringRef *filter,
        unsigned int filterMask)
{
  result->m_ref = 0i64;
  result->m_ptr = 0i64;
  return result;
}

