#include "dev/silverware/git/sdk/agstring.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xtgmath.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xtr1common"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/thr/xthread"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/string"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vcruntime_typeinfo.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/stdlib.h"
#include "dev/silverware/git/sdk/agmath.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/ios"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xlocnum"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/functional"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/stdexcept"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/exception"
#include "dev/silverware/git/sdk/agreferencecount.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/type_traits"
#include "dev/silverware/git/sdk/filesystem/agfile.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xstddef"
#include "dev/silverware/git/sdk/system/aguser.h"
#include "dev/silverware/git/sdk/agpointer.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xatomic0.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/system_error"
#include "dev/silverware/git/sdk/agstream.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/thread"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/memory"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wio.h"
#include "dev/silverware/git/sdk/agmutex.h"
#include "dev/silverware/git/sdk/agscopedlock.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wstring.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/tuple"
#include "dev/silverware/git/sdk/filesystem/agpath.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xutility"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/utility"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/iosfwd"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xlocinfo"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xiosbase"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/ctype.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/time.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xlocale"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/string.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_memory.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_memcpy_s.h"
#include "dev/silverware/git/sdk/agreferencecountinl.h"
#include "dev/silverware/git/sdk/util/agdebugchannels.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/mutex"
#include "dev/silverware/git/sdk/util/agperformancecounter.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/chrono"
#include "dev/silverware/git/sdk/agclock.h"
#include "dev/silverware/git/sdk/system/agsysteminfo.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vector"
#include "dev/silverware/git/sdk/agmutex.inl"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/malloc.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/cmath"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/math.h"
#include "dev/silverware/git/sdk/agcondition.inl"
#include "dev/silverware/git/sdk/filesystem/agmount.h"
#include "dev/silverware/git/sdk/platforms/pc/system/agpcsysteminfo.h"
#include "dev/silverware/git/sdk/memory/agallocators.h"
#include "dev/silverware/git/sdk/agsingleton.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/sys/stat.h"
#include "dev/silverware/git/sdk/agpointerinl.h"
#include "dev/silverware/git/sdk/agcondition.h"
#include "dev/silverware/git/sdk/agconditionvariable.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/condition_variable"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xstring"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xmemory0"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/stdio.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wstdio.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vcruntime_new.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_stdio_config.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/wchar.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wconio.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vcruntime_exception.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/limits"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wtime.h"
#include "dev/silverware/git/sdk/agarchivedirectory.h"
#include "dev/silverware/git/sdk/agreferencedobjectinl.h"
#include "dev/silverware/git/sdk/agreferenceinl.h"
#include "dev/silverware/git/sdk/filesystem/agdirectory.h"
#include "dev/silverware/git/sdk/agreferencedobject.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vadefs.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xfacet"
#include "dev/silverware/git/sdk/agconditionvariable.inl"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/map"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xmemory"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xtree"

AgDirectory::DirectoryEntry AgArchiveDirectory::nextEntry(); // 0x14068E530
AgDirectory::DirectoryEntry AgArchiveDirectory::firstEntry(); // 0x14068E4C0
AgArchiveDirectory::AgArchiveDirectory(AgPointer<AgMount> mount, const AgPath & path, AgStringRef filter, unsigned long mask); // 0x14068E000
AgDirectory::DirectoryEntry::~DirectoryEntry(); // 0x14068E0D0
void AgArchiveDirectory::addEntry(const AgStringRef name, long isDirectory); // 0x14068E340void __fastcall std::_Destroy_range<std::allocator<AgDirectory::DirectoryEntry>,AgDirectory::DirectoryEntry *>(
        AgDirectory::DirectoryEntry *_First,
        AgDirectory::DirectoryEntry *_Last,
        std::_Wrap_alloc<std::allocator<AgDirectory::DirectoryEntry> > *_Al)
{
  AgDirectory::DirectoryEntry *v4; // rdi

  if ( _First != _Last )
  {
    v4 = _First;
    do
    {
      AgString::~AgString(&v4->m_path.m_path, (unsigned __int64)_Last);
      ++v4;
    }
    while ( v4 != _Last );
  }
}

AgDirectory::DirectoryEntry *__fastcall std::_Uninitialized_move_al_unchecked1<AgDirectory::DirectoryEntry *,AgDirectory::DirectoryEntry *,std::allocator<AgDirectory::DirectoryEntry>>(
        AgDirectory::DirectoryEntry *_First,
        AgDirectory::DirectoryEntry *_Last,
        AgDirectory::DirectoryEntry *_Dest,
        std::_Wrap_alloc<std::allocator<AgDirectory::DirectoryEntry> > *_Al)
{
  while ( _First != _Last )
  {
    if ( _Dest )
    {
      AgString::AgString(&_Dest->m_path.m_path, &_First->m_path.m_path);
      _Dest->m_type = _First->m_type;
      _Dest->m_exists = _First->m_exists;
      _Dest->m_internalData = _First->m_internalData;
    }
    ++_Dest;
    ++_First;
  }
  return _Dest;
}

void __fastcall AgArchiveDirectory::AgArchiveDirectory(
        AgArchiveDirectory *this,
        AgPointer<AgMount> *mount,
        const AgPath *path,
        AgStringRef *filter,
        unsigned int mask)
{
  AgPointer<AgMount> *v8; // rax
  AgPointer<AgPlayer> v9; // [rsp+38h] [rbp-40h] BYREF
  AgStringRef v10; // [rsp+50h] [rbp-28h] BYREF

  v10 = *filter;
  AgPointer<AgBuffer<AgAllocator<1>>>::AgPointer<AgBuffer<AgAllocator<1>>>(&v9, (const AgPointer<AgPlayer> *)mount);
  AgDirectory::AgDirectory(this, v8, path, &v10, mask);
  this->__vftable = (AgArchiveDirectory_vtbl *)&AgArchiveDirectory::`vftable';
  this->m_entries._Mypair._Myval2._Myfirst = 0i64;
  this->m_entries._Mypair._Myval2._Mylast = 0i64;
  this->m_entries._Mypair._Myval2._Myend = 0i64;
  this->m_currentPos._Ptr = 0i64;
  this->m_currentPos._Ptr = this->m_entries._Mypair._Myval2._Mylast;
  AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)mount);
}

void __fastcall std::vector<AgDirectory::DirectoryEntry>::~vector<AgDirectory::DirectoryEntry>(
        std::vector<AgDirectory::DirectoryEntry> *this)
{
  std::vector<AgDirectory::DirectoryEntry>::_Tidy(this);
}

void __fastcall AgDirectory::DirectoryEntry::~DirectoryEntry(AgDirectory::DirectoryEntry *this, unsigned __int64 a2)
{
  AgString::~AgString(&this->m_path.m_path, a2);
}

void __fastcall std::vector<AgDirectory::DirectoryEntry>::_Reallocate(
        std::vector<AgDirectory::DirectoryEntry> *this,
        unsigned __int64 _Count)
{
  AgDirectory::DirectoryEntry *v4; // r12
  unsigned __int64 v5; // rdx
  AgDirectory::DirectoryEntry *Mylast; // r14
  AgDirectory::DirectoryEntry *Myfirst; // rbx
  signed __int64 v8; // rsi

  v4 = std::allocator<AgDirectory::DirectoryEntry>::allocate(
         (std::allocator<AgDirectory::DirectoryEntry> *)this,
         _Count);
  std::_Uninitialized_move_al_unchecked1<AgDirectory::DirectoryEntry *,AgDirectory::DirectoryEntry *,std::allocator<AgDirectory::DirectoryEntry>>(
    this->_Mypair._Myval2._Myfirst,
    this->_Mypair._Myval2._Mylast,
    v4,
    (std::_Wrap_alloc<std::allocator<AgDirectory::DirectoryEntry> > *)this);
  Mylast = this->_Mypair._Myval2._Mylast;
  Myfirst = this->_Mypair._Myval2._Myfirst;
  v8 = (char *)Mylast - (char *)this->_Mypair._Myval2._Myfirst;
  if ( this->_Mypair._Myval2._Myfirst )
  {
    for ( ; Myfirst != Mylast; ++Myfirst )
      AgString::~AgString(&Myfirst->m_path.m_path, v5);
    std::_Wrap_alloc<std::allocator<AgDirectory::DirectoryEntry>>::deallocate(
      (std::_Wrap_alloc<std::allocator<AgDirectory::DirectoryEntry> > *)this,
      this->_Mypair._Myval2._Myfirst,
      this->_Mypair._Myval2._Myend - this->_Mypair._Myval2._Myfirst);
  }
  this->_Mypair._Myval2._Myend = &v4[_Count];
  this->_Mypair._Myval2._Mylast = (AgDirectory::DirectoryEntry *)((char *)v4 + (v8 & 0xFFFFFFFFFFFFFFE0ui64));
  this->_Mypair._Myval2._Myfirst = v4;
}

void __fastcall std::vector<AgDirectory::DirectoryEntry>::_Reserve(
        std::vector<AgDirectory::DirectoryEntry> *this,
        unsigned __int64 _Count)
{
  AgDirectory::DirectoryEntry *Myend; // r10
  AgDirectory::DirectoryEntry *Mylast; // r8
  AgDirectory::DirectoryEntry *Myfirst; // rcx
  __int64 v6; // r8
  unsigned __int64 v7; // rdx
  unsigned __int64 v8; // r10
  unsigned __int64 v9; // rcx

  Myend = this->_Mypair._Myval2._Myend;
  Mylast = this->_Mypair._Myval2._Mylast;
  if ( Myend - Mylast < _Count )
  {
    Myfirst = this->_Mypair._Myval2._Myfirst;
    v6 = Mylast - Myfirst;
    if ( 0x7FFFFFFFFFFFFFFi64 - v6 < _Count )
      std::_Xlength_error("vector<T> too long");
    v7 = v6 + _Count;
    v8 = Myend - Myfirst;
    v9 = 0i64;
    if ( 0x7FFFFFFFFFFFFFFi64 - (v8 >> 1) >= v8 )
      v9 = v8 + (v8 >> 1);
    if ( v9 >= v7 )
      v7 = v9;
    std::vector<AgDirectory::DirectoryEntry>::_Reallocate(this, v7);
  }
}

void __fastcall std::vector<AgDirectory::DirectoryEntry>::_Tidy(
        std::vector<AgDirectory::DirectoryEntry> *this,
        unsigned __int64 a2)
{
  AgDirectory::DirectoryEntry *Myfirst; // rbx
  AgDirectory::DirectoryEntry *i; // rdi

  Myfirst = this->_Mypair._Myval2._Myfirst;
  if ( this->_Mypair._Myval2._Myfirst )
  {
    for ( i = this->_Mypair._Myval2._Mylast; Myfirst != i; ++Myfirst )
      AgString::~AgString(&Myfirst->m_path.m_path, a2);
    std::_Wrap_alloc<std::allocator<AgDirectory::DirectoryEntry>>::deallocate(
      (std::_Wrap_alloc<std::allocator<AgDirectory::DirectoryEntry> > *)this,
      this->_Mypair._Myval2._Myfirst,
      this->_Mypair._Myval2._Myend - this->_Mypair._Myval2._Myfirst);
    this->_Mypair._Myval2._Myfirst = 0i64;
    this->_Mypair._Myval2._Mylast = 0i64;
    this->_Mypair._Myval2._Myend = 0i64;
  }
}

void __fastcall AgArchiveDirectory::addEntry(AgArchiveDirectory *this, const AgStringRef *name, int isDirectory)
{
  unsigned __int64 v6; // rdx
  unsigned __int64 v7; // rdx
  AgString copy; // [rsp+28h] [rbp-40h] BYREF
  AgDirectory::DirectoryEntry v9; // [rsp+38h] [rbp-30h] BYREF

  AgString::AgString(&v9.m_path.m_path, &pnewText, -1);
  AgPath::clean(&v9.m_path);
  *(_QWORD *)&v9.m_type = 0x100000002i64;
  v9.m_internalData = 0i64;
  AgString::AgString(&copy, name);
  AgPath::clean((AgPath *)&copy);
  AgString::operator=(&v9.m_path.m_path, &copy);
  AgString::~AgString(&copy, v6);
  v9.m_type = isDirectory == 1;
  std::vector<AgDirectory::DirectoryEntry>::push_back(&this->m_entries, &v9);
  if ( this->m_currentPos._Ptr == this->m_entries._Mypair._Myval2._Mylast )
    this->m_currentPos._Ptr = this->m_entries._Mypair._Myval2._Myfirst;
  AgString::~AgString(&v9.m_path.m_path, v7);
}

AgDirectory::DirectoryEntry *__fastcall std::allocator<AgDirectory::DirectoryEntry>::allocate(
        std::allocator<AgDirectory::DirectoryEntry> *this,
        unsigned __int64 _Count)
{
  AgDirectory::DirectoryEntry *result; // rax
  unsigned __int64 v3; // rdx
  void *v4; // rax
  void *v5; // rcx

  if ( !_Count )
    return 0i64;
  if ( _Count > 0x7FFFFFFFFFFFFFFi64 )
    std::_Xbad_alloc();
  v3 = 32 * _Count;
  if ( v3 < 0x1000 )
  {
    result = (AgDirectory::DirectoryEntry *)operator new(v3);
    if ( !result )
      invalid_parameter_noinfo_noreturn();
  }
  else
  {
    if ( v3 + 39 <= v3 )
      std::_Xbad_alloc();
    v4 = operator new(v3 + 39);
    v5 = v4;
    if ( !v4 )
      invalid_parameter_noinfo_noreturn();
    result = (AgDirectory::DirectoryEntry *)(((unsigned __int64)v4 + 39) & 0xFFFFFFFFFFFFFFE0ui64);
    result[-1].m_internalData = v5;
  }
  return result;
}

void __fastcall std::_Wrap_alloc<std::allocator<AgDirectory::DirectoryEntry>>::deallocate(
        std::_Wrap_alloc<std::allocator<AgDirectory::DirectoryEntry> > *this,
        AgDirectory::DirectoryEntry *_Ptr,
        unsigned __int64 _Count)
{
  AgDirectory::DirectoryEntry *m_internalData; // rax
  char *v4; // rdx

  if ( _Count > 0x7FFFFFFFFFFFFFFi64 )
    invalid_parameter_noinfo_noreturn();
  if ( 32 * _Count >= 0x1000 )
  {
    if ( ((unsigned __int8)_Ptr & 0x1F) != 0 )
      invalid_parameter_noinfo_noreturn();
    m_internalData = (AgDirectory::DirectoryEntry *)_Ptr[-1].m_internalData;
    if ( m_internalData >= _Ptr )
      invalid_parameter_noinfo_noreturn();
    v4 = (char *)((char *)_Ptr - (char *)m_internalData);
    if ( (unsigned __int64)v4 < 8 )
      invalid_parameter_noinfo_noreturn();
    if ( (unsigned __int64)v4 > 0x27 )
      invalid_parameter_noinfo_noreturn();
    _Ptr = m_internalData;
  }
  operator delete(_Ptr);
}

AgDirectory::DirectoryEntry *__fastcall AgArchiveDirectory::firstEntry(
        AgArchiveDirectory *this,
        AgDirectory::DirectoryEntry *result)
{
  AgDirectory::DirectoryEntry *Myfirst; // rbx

  Myfirst = this->m_entries._Mypair._Myval2._Myfirst;
  this->m_currentPos._Ptr = Myfirst;
  AgString::AgString(&result->m_path.m_path, &Myfirst->m_path.m_path);
  result->m_type = Myfirst->m_type;
  result->m_exists = Myfirst->m_exists;
  result->m_internalData = Myfirst->m_internalData;
  return result;
}

AgDirectory::DirectoryEntry *__fastcall AgArchiveDirectory::nextEntry(
        AgArchiveDirectory *this,
        AgDirectory::DirectoryEntry *result)
{
  AgDirectory::DirectoryEntry *v3; // rdi

  v3 = ++this->m_currentPos._Ptr;
  if ( v3 == this->m_entries._Mypair._Myval2._Mylast )
  {
    AgString::AgString(&result->m_path.m_path, &pnewText, -1);
    AgPath::clean(&result->m_path);
    *(_QWORD *)&result->m_type = 2i64;
  }
  else
  {
    AgString::AgString(&result->m_path.m_path, &v3->m_path.m_path);
    result->m_type = v3->m_type;
    result->m_exists = v3->m_exists;
    result->m_internalData = v3->m_internalData;
  }
  return result;
}

void __fastcall std::vector<AgDirectory::DirectoryEntry>::push_back(
        std::vector<AgDirectory::DirectoryEntry> *this,
        const AgDirectory::DirectoryEntry *_Val)
{
  AgDirectory::DirectoryEntry *Mylast; // rax
  AgDirectory::DirectoryEntry *Myfirst; // rcx
  signed __int64 v6; // rdi
  AgDirectory::DirectoryEntry *v7; // rsi
  char *v8; // rdi
  AgDirectory::DirectoryEntry *v9; // rsi

  Mylast = this->_Mypair._Myval2._Mylast;
  if ( _Val >= Mylast || (Myfirst = this->_Mypair._Myval2._Myfirst, Myfirst > _Val) )
  {
    if ( Mylast == this->_Mypair._Myval2._Myend )
      std::vector<AgDirectory::DirectoryEntry>::_Reserve(this, 1ui64);
    v9 = this->_Mypair._Myval2._Mylast;
    if ( v9 )
    {
      AgString::AgString(&v9->m_path.m_path, &_Val->m_path.m_path);
      v9->m_type = _Val->m_type;
      v9->m_exists = _Val->m_exists;
      v9->m_internalData = _Val->m_internalData;
    }
  }
  else
  {
    v6 = (char *)_Val - (char *)Myfirst;
    if ( Mylast == this->_Mypair._Myval2._Myend )
      std::vector<AgDirectory::DirectoryEntry>::_Reserve(this, 1ui64);
    v7 = this->_Mypair._Myval2._Mylast;
    v8 = (char *)this->_Mypair._Myval2._Myfirst + (v6 & 0xFFFFFFFFFFFFFFE0ui64);
    if ( v7 )
    {
      AgString::AgString(&v7->m_path.m_path, (const AgString *)v8);
      v7->m_type = *((_DWORD *)v8 + 4);
      v7->m_exists = *((_DWORD *)v8 + 5);
      v7->m_internalData = (void *)*((_QWORD *)v8 + 3);
    }
  }
  ++this->_Mypair._Myval2._Mylast;
}

