#include "program files (x86)/microsoft visual studio 14.0/vc/include/string"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/ios"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/tuple"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xlocnum"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xiosbase"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xlocale"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xlocinfo"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xtgmath.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xtr1common"
#include "dev/silverware/git/sdk/agreferencecount.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/ctype.h"
#include "dev/silverware/git/sdk/agpointer.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/stdlib.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xstddef"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/mutex"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/chrono"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/limits"
#include "dev/silverware/git/sdk/system/agsysteminfo.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/time.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vector"
#include "dev/silverware/git/sdk/util/ageventdispatcher.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/thread"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/utility"
#include "dev/silverware/git/sdk/util/agdelegate.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/memory"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xmemory"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/thr/xthread"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/iosfwd"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/stdio.h"
#include "dev/silverware/git/sdk/platforms/pc/system/agpcsysteminfo.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/type_traits"
#include "dev/silverware/git/sdk/util/agjsondata.h"
#include "dev/silverware/git/sdk/agreferencecountinl.h"
#include "dev/silverware/git/sdk/agstream.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wconio.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_stdio_config.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xatomic0.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/functional"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xstring"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xmemory0"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/exception"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/map"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/malloc.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xtree"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vcruntime_new.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/cmath"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wstring.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/math.h"
#include "dev/silverware/git/sdk/agpointerinl.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wstdio.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xfacet"
#include "dev/silverware/git/sdk/util/agperformancecounter.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/sys/stat.h"
#include "dev/silverware/git/sdk/agclock.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vcruntime_typeinfo.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xutility"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/wchar.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_memcpy_s.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/string.h"
#include "dev/silverware/git/sdk/system/agsystemmanager.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_memory.h"
#include "dev/silverware/git/sdk/agsingleton.h"
#include "dev/silverware/git/sdk/agreferencedobjectinl.h"
#include "dev/silverware/git/sdk/agprogram.h"
#include "dev/silverware/git/sdk/agreferencedobject.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vcruntime_exception.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wtime.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wio.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vadefs.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/system_error"
#include "dev/silverware/git/sdk/system/agsystemconfig.h"
#include "dev/silverware/git/sdk/util/agdebugchannels.h"
#include "dev/silverware/git/sdk/agthread.h"
#include "dev/silverware/git/sdk/agmutex.inl"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/stdexcept"
#include "dev/silverware/git/sdk/agstring.h"
#include "dev/silverware/git/sdk/agmutex.h"
#include "dev/silverware/git/sdk/agscopedlock.h"

AgProgram * AgProgram::ms_instance; // 0x140A8FEC0
AgProgram::AgProgram(); // 0x1406692E0
AgProgram::~AgProgram(); // 0x1406693A0
long AgProgram::getShutdownRequested(); // 0x1400B8230
void AgProgram::onShutdown(const AgShutdownEvent & e); // 0x1400B8250
void AgProgram::onExecuteThread(); // 0x140147FC0
void AgProgram::onJoinThread(); // 0x14002E7C0
long AgProgram::getThreadIsRunning(); // 0x1406695D0
AgProgram * AgProgram::getInstance(); // 0x1406695C0//decompilation failure at 140A8FEC0!
AgDelegate1<AgShutdownEvent const &,void> *__fastcall std::_Uninitialized_move_al_unchecked1<AgDelegate1<AgShutdownEvent const &,void> *,AgDelegate1<AgShutdownEvent const &,void> *,std::allocator<AgDelegate1<AgShutdownEvent const &,void>>>(
        AgDelegate1<AgShutdownEvent const &,void> *_First,
        AgDelegate1<AgShutdownEvent const &,void> *_Last,
        AgDelegate1<AgShutdownEvent const &,void> *_Dest,
        std::_Wrap_alloc<std::allocator<AgDelegate1<AgShutdownEvent const &,void> > > *_Al)
{
  while ( _First != _Last )
  {
    if ( _Dest )
    {
      _Dest->m_Closure.m_pthis = 0i64;
      _Dest->m_Closure.m_pFunction = 0i64;
      *_Dest = *_First;
    }
    ++_Dest;
    ++_First;
  }
  return _Dest;
}

void __fastcall AgProgram::AgProgram(AgProgram *this)
{
  AgSingleton<AgSystemManager> *v1; // rbx
  detail::GenericClass *v2; // rax
  AgDelegate1<AgShutdownEvent const &,void> _Val; // [rsp+38h] [rbp-20h] BYREF

  this->m_refCount = 0i64;
  this->__vftable = (AgProgram_vtbl *)&AgIThreadHost::`vftable';
  this->__vftable = (AgProgram_vtbl *)&AgProgram::`vftable';
  *(_QWORD *)&this->m_asynchronous = 0i64;
  this->m_thread.m_ref = 0i64;
  this->m_thread.m_ptr = 0i64;
  AgProgram::ms_instance = this;
  Scaleform::Render::SubImage::GetAsImage((std::_Wrap_alloc<std::allocator<AgString> > *)this);
  v1 = AgSingleton<AgSystemManager>::ms_instance + 65;
  _Val.m_Closure.m_pFunction = (void (__fastcall *)(detail::GenericClass *))AgProgram::onShutdown;
  _Val.m_Closure.m_pthis = v2;
  EnterCriticalSection((LPCRITICAL_SECTION)&AgSingleton<AgSystemManager>::ms_instance[65]);
  std::vector<AgDelegate1<AgShutdownEvent const &,void>>::push_back(
    (std::vector<AgDelegate1<AgShutdownEvent const &,void>> *)&v1[5],
    &_Val);
  LeaveCriticalSection((LPCRITICAL_SECTION)v1);
}

void __fastcall AgProgram::~AgProgram(AgProgram *this)
{
  detail::GenericClass *v2; // rax
  AgDelegate1<AgShutdownEvent const &,void> v3; // [rsp+28h] [rbp-20h] BYREF

  this->__vftable = (AgProgram_vtbl *)&AgProgram::`vftable';
  Scaleform::Render::SubImage::GetAsImage((std::_Wrap_alloc<std::allocator<AgString> > *)this);
  v3.m_Closure.m_pFunction = (void (__fastcall *)(detail::GenericClass *))AgProgram::onShutdown;
  v3.m_Closure.m_pthis = v2;
  AgEventDispatcherBase<AgShutdownEvent>::unbind(
    (AgEventDispatcherBase<AgShutdownEvent> *)&AgSingleton<AgSystemManager>::ms_instance[65],
    &v3);
  this->m_shutdownRequested = 1;
  if ( this->m_asynchronous )
  {
    AgThread::join(this->m_thread.m_ptr);
    AgPointer<AgThread>::operator=((AgPointer<AgController> *)&this->m_thread, 0i64);
  }
  AgProgram::ms_instance = 0i64;
  AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)&this->m_thread);
  this->__vftable = (AgProgram_vtbl *)&AgIThreadHost::`vftable';
}

void __fastcall std::vector<AgDelegate1<AgShutdownEvent const &,void>>::_Reallocate(
        std::vector<AgDelegate1<AgShutdownEvent const &,void>> *this,
        unsigned __int64 _Count)
{
  AgDelegate1<AgShutdownEvent const &,void> *v4; // r14
  signed __int64 v5; // rdi

  v4 = std::allocator<AgDelegate1<AgShutdownEvent const &,void>>::allocate(
         (std::allocator<AgDelegate1<AgShutdownEvent const &,void> > *)this,
         _Count);
  std::_Uninitialized_move_al_unchecked1<AgDelegate1<AgShutdownEvent const &,void> *,AgDelegate1<AgShutdownEvent const &,void> *,std::allocator<AgDelegate1<AgShutdownEvent const &,void>>>(
    this->_Mypair._Myval2._Myfirst,
    this->_Mypair._Myval2._Mylast,
    v4,
    (std::_Wrap_alloc<std::allocator<AgDelegate1<AgShutdownEvent const &,void> > > *)this);
  v5 = (char *)this->_Mypair._Myval2._Mylast - (char *)this->_Mypair._Myval2._Myfirst;
  if ( this->_Mypair._Myval2._Myfirst )
    std::_Wrap_alloc<std::allocator<AgDelegate1<AgSuspendingEvent const &,void>>>::deallocate(
      (std::_Wrap_alloc<std::allocator<AgDelegate1<AgUserUpdatedEvent const &,void> > > *)this,
      (AgDelegate1<AgUserUpdatedEvent const &,void> *)this->_Mypair._Myval2._Myfirst,
      this->_Mypair._Myval2._Myend - this->_Mypair._Myval2._Myfirst);
  this->_Mypair._Myval2._Myend = &v4[_Count];
  this->_Mypair._Myval2._Mylast = (AgDelegate1<AgShutdownEvent const &,void> *)((char *)v4
                                                                              + (v5 & 0xFFFFFFFFFFFFFFF0ui64));
  this->_Mypair._Myval2._Myfirst = v4;
}

void __fastcall std::vector<AgDelegate1<AgShutdownEvent const &,void>>::_Reserve(
        std::vector<AgDelegate1<AgShutdownEvent const &,void>> *this,
        unsigned __int64 _Count)
{
  AgDelegate1<AgShutdownEvent const &,void> *Myend; // r10
  AgDelegate1<AgShutdownEvent const &,void> *Mylast; // r8
  AgDelegate1<AgShutdownEvent const &,void> *Myfirst; // rcx
  __int64 v6; // r8
  unsigned __int64 v7; // rdx
  unsigned __int64 v8; // r10
  unsigned __int64 v9; // rcx

  Myend = this->_Mypair._Myval2._Myend;
  Mylast = this->_Mypair._Myval2._Mylast;
  if ( Myend - Mylast < _Count )
  {
    Myfirst = this->_Mypair._Myval2._Myfirst;
    v6 = Mylast - Myfirst;
    if ( 0xFFFFFFFFFFFFFFFi64 - v6 < _Count )
      std::_Xlength_error("vector<T> too long");
    v7 = v6 + _Count;
    v8 = Myend - Myfirst;
    v9 = 0i64;
    if ( 0xFFFFFFFFFFFFFFFi64 - (v8 >> 1) >= v8 )
      v9 = v8 + (v8 >> 1);
    if ( v9 >= v7 )
      v7 = v9;
    std::vector<AgDelegate1<AgShutdownEvent const &,void>>::_Reallocate(this, v7);
  }
}

AgDelegate1<AgShutdownEvent const &,void> *__fastcall std::allocator<AgDelegate1<AgShutdownEvent const &,void>>::allocate(
        std::allocator<AgDelegate1<AgShutdownEvent const &,void> > *this,
        unsigned __int64 _Count)
{
  AgDelegate1<AgShutdownEvent const &,void> *result; // rax
  unsigned __int64 v3; // rdx
  void (__fastcall *v4)(detail::GenericClass *); // rax
  void (__fastcall *v5)(detail::GenericClass *); // rcx

  if ( !_Count )
    return 0i64;
  if ( _Count > 0xFFFFFFFFFFFFFFFi64 )
    std::_Xbad_alloc();
  v3 = 16 * _Count;
  if ( v3 < 0x1000 )
  {
    result = (AgDelegate1<AgShutdownEvent const &,void> *)operator new(v3);
    if ( !result )
      invalid_parameter_noinfo_noreturn();
  }
  else
  {
    if ( v3 + 39 <= v3 )
      std::_Xbad_alloc();
    v4 = (void (__fastcall *)(detail::GenericClass *))operator new(v3 + 39);
    v5 = v4;
    if ( !v4 )
      invalid_parameter_noinfo_noreturn();
    result = (AgDelegate1<AgShutdownEvent const &,void> *)(((unsigned __int64)v4 + 39) & 0xFFFFFFFFFFFFFFE0ui64);
    result[-1].m_Closure.m_pFunction = v5;
  }
  return result;
}

AgProgram *__fastcall AgProgram::getInstance()
{
  return AgProgram::ms_instance;
}

__int64 __fastcall AgProgram::getShutdownRequested(AgProgram *this)
{
  return (unsigned int)this->m_shutdownRequested;
}

_BOOL8 __fastcall AgProgram::getThreadIsRunning(AgProgram *this)
{
  return this->m_thread.m_ptr != 0i64;
}

void __fastcall AgProgram::run(AgProgram *this)
{
  this->onExecuteImpl(this);
}

void __fastcall ActorWeapon::ActionFlagCheck(_SETJMP_FLOAT128 *JumpBuffer)
{
  ;
}

void __fastcall AgProgram::onShutdown(AgProgram *this)
{
  this->m_shutdownRequested = 1;
}

void __fastcall std::vector<AgDelegate1<AgShutdownEvent const &,void>>::push_back(
        std::vector<AgDelegate1<AgShutdownEvent const &,void>> *this,
        const AgDelegate1<AgShutdownEvent const &,void> *_Val)
{
  AgDelegate1<AgShutdownEvent const &,void> *Mylast; // rax
  AgDelegate1<AgShutdownEvent const &,void> *Myfirst; // rcx
  signed __int64 v6; // rdi
  AgDelegate1<AgShutdownEvent const &,void> *v7; // rcx
  detail::GenericClass **v8; // rdi
  AgDelegate1<AgShutdownEvent const &,void> *v9; // rcx

  Mylast = this->_Mypair._Myval2._Mylast;
  if ( _Val >= Mylast || (Myfirst = this->_Mypair._Myval2._Myfirst, Myfirst > _Val) )
  {
    if ( Mylast == this->_Mypair._Myval2._Myend )
      std::vector<AgDelegate1<AgShutdownEvent const &,void>>::_Reserve(this, 1ui64);
    v9 = this->_Mypair._Myval2._Mylast;
    if ( v9 )
    {
      v9->m_Closure.m_pthis = 0i64;
      v9->m_Closure.m_pFunction = 0i64;
      v9->m_Closure.m_pFunction = _Val->m_Closure.m_pFunction;
      v9->m_Closure.m_pthis = _Val->m_Closure.m_pthis;
    }
  }
  else
  {
    v6 = (char *)_Val - (char *)Myfirst;
    if ( Mylast == this->_Mypair._Myval2._Myend )
      std::vector<AgDelegate1<AgShutdownEvent const &,void>>::_Reserve(this, 1ui64);
    v7 = this->_Mypair._Myval2._Mylast;
    v8 = (detail::GenericClass **)((char *)&this->_Mypair._Myval2._Myfirst->m_Closure.m_pthis
                                 + (v6 & 0xFFFFFFFFFFFFFFF0ui64));
    if ( v7 )
    {
      v7->m_Closure.m_pthis = 0i64;
      v7->m_Closure.m_pFunction = 0i64;
      v7->m_Closure.m_pFunction = (void (__fastcall *)(detail::GenericClass *))v8[1];
      v7->m_Closure.m_pthis = *v8;
    }
  }
  ++this->_Mypair._Myval2._Mylast;
}

void __fastcall AgEventDispatcherBase<AgShutdownEvent>::unbind(
        AgEventDispatcherBase<AgShutdownEvent> *this,
        AgDelegate1<AgShutdownEvent const &,void> *f)
{
  AgDelegate1<AgShutdownEvent const &,void> *Myfirst; // rax
  AgDelegate1<AgShutdownEvent const &,void> *Mylast; // r8
  void (__fastcall **p_m_pFunction)(detail::GenericClass *); // rdx

  EnterCriticalSection((LPCRITICAL_SECTION)this);
  Myfirst = this->m_bindings._Mypair._Myval2._Myfirst;
  Mylast = this->m_bindings._Mypair._Myval2._Mylast;
  if ( Myfirst != Mylast )
  {
    while ( f->m_Closure.m_pthis != Myfirst->m_Closure.m_pthis
         || f->m_Closure.m_pFunction != Myfirst->m_Closure.m_pFunction )
    {
      if ( ++Myfirst == Mylast )
        goto LABEL_10;
    }
    if ( &Myfirst[1] != Mylast )
    {
      p_m_pFunction = &Myfirst[1].m_Closure.m_pFunction;
      do
      {
        *(p_m_pFunction - 2) = *p_m_pFunction;
        *(p_m_pFunction - 3) = *(p_m_pFunction - 1);
        p_m_pFunction += 2;
      }
      while ( p_m_pFunction - 1 != (void (__fastcall **)(detail::GenericClass *))Mylast );
    }
    --this->m_bindings._Mypair._Myval2._Mylast;
  }
LABEL_10:
  LeaveCriticalSection((LPCRITICAL_SECTION)this);
}

