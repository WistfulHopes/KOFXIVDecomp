#include "program files (x86)/microsoft visual studio 14.0/vc/include/memory"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xmemory"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/thr/xthread"
#include "dev/kof/master/development/source/baseproject/jni/framework/memory/globalheapmemory.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/memory/fixmemory.h"
#include "dev/silverware/git/sdk/input/agsdlmappingparser.h"
#include "dev/kof/master/development/source/ps4project/toolkit/geommath/matrix4unaligned.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/scalar_cpp/quat_aos.h"
#include "dev/silverware/git/sdk/platforms/pc/system/agpcsysteminfo.h"
#include "dev/silverware/git/sdk/agreferencecountinl.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_refcount.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_memory.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_memoryheap.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_stats.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_timer.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/internal/internal_sse.h"
#include "dev/silverware/git/sdk/3rdparty/steam/steamclientpublic.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/internal/internal_types.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xatomic0.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/memory/variableheapmemorybase.h"
#include "dev/kof/master/development/source/ps4project/toolkit/geommath/vector2unaligned.h"
#include "dev/silverware/git/sdk/agmemorystream.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_sysalloc.h"
#include "dev/silverware/git/sdk/agmemorypool.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/internal/internal_functions.h"
#include "dev/silverware/git/sdk/input/agcontrollerbuttoncomponent.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_threads.h"
#include "dev/silverware/git/sdk/agpointerinl.h"
#include "dev/silverware/git/sdk/agstream.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/stdio.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_types.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/memory/physicalheapmemory.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wstdio.h"
#include "dev/silverware/git/sdk/agsemaphore.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_stdio_config.h"
#include "dev/silverware/git/sdk/agsemaphore.inl"
#include "dev/silverware/git/sdk/agconditionvariable.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/condition_variable"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/deque"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/sys/stat.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_allocinfo.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/scalar_cpp/boolinvec.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/time.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xtgmath.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xtr1common"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wstring.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/thread/jobmanager.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/stdlib.h"
#include "program files (x86)/windows kits/8.1/include/shared/guiddef.h"
#include "dev/kof/master/development/source/ps4project/toolkit/geommath/vector3unaligned.h"
#include "program files (x86)/windows kits/8.1/include/shared/stralign.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vcruntime_typeinfo.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/util/resourcemanager.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xfacet"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xutility"
#include "dev/silverware/git/sdk/3rdparty/steam/isteamhtmlsurface.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/vec_aos.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/list"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/boolinvec.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/string.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_memory.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_memcpy_s.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/scalar_cpp/vectormath_aos.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/wchar.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wconio.h"
#include "program files (x86)/windows kits/8.1/include/um/winnt.h"
#include "dev/silverware/git/sdk/agreferencedobjectinl.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/functional"
#include "dev/silverware/git/sdk/agpointer.h"
#include "program files (x86)/windows kits/8.1/include/shared/basetsd.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xstring"
#include "dev/silverware/git/sdk/agreferencedobject.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xmemory0"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wtime.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/heapmh/heapmh_sysallocmalloc.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/malloc.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/exception"
#include "dev/silverware/git/sdk/agconditionvariable.inl"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vcruntime_exception.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/scalar_cpp/mat_aos.h"
#include "dev/silverware/git/sdk/agthread.h"
#include "dev/silverware/git/sdk/agmutex.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/array"
#include "dev/silverware/git/sdk/agscopedlock.h"
#include "dev/silverware/git/sdk/3rdparty/steam/steam_api_internal.h"
#include "dev/kof/master/development/source/ps4project/baseproject/pcutil/pccontrolsmanager.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/algorithm"
#include "dev/silverware/git/sdk/input/aginputmanager.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/system_error"
#include "dev/silverware/git/sdk/agsingleton.h"
#include "dev/kof/master/development/source/ps4project/toolkit/geommath/vector4unaligned.h"
#include "dev/silverware/git/sdk/agmutex.inl"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/stdexcept"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/utility"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/vecidx_aos.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/iosfwd"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/map"
#include "program files (x86)/windows kits/8.1/include/um/winuser.h"
#include "dev/silverware/git/sdk/memory/agallocators.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/floatinvec.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xtree"
#include "dev/silverware/git/sdk/input/agcontrollercomponent.h"
#include "dev/silverware/git/sdk/3rdparty/steam/steam_api.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/tuple"
#include "dev/kof/master/development/source/ps4project/baseproject/pcutil/pcdummy.h"
#include "dev/silverware/git/sdk/util/agdelegate.h"
#include "dev/silverware/git/sdk/agreferencecount.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vcruntime_new.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/quat_aos.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/scalar_cpp/floatinvec.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vadefs.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xstddef"
#include "dev/silverware/git/sdk/agvector2.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/type_traits"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/internal/internal_vec64.h"
#include "dev/silverware/git/sdk/agmath.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_array.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_allocator.h"
#include "dev/silverware/git/sdk/input/agcontroller.h"
#include "dev/silverware/git/sdk/system/aguser.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/cmath"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_atomic.h"
#include "dev/silverware/git/sdk/agstring.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/math.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/internal/internal_math.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/mutex"
#include "dev/kof/master/development/source/ps4project/baseproject/extension/memory_allocator.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/string"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/chrono"
#include "dev/kof/master/development/source/baseproject/jni/framework/libcommon.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/scalar_cpp/vec_aos.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/limits"
#include "dev/silverware/git/sdk/3rdparty/steam/matchmakingtypes.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/ios"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xlocnum"
#include "dev/silverware/git/sdk/system/agsysteminfo.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xiosbase"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xlocale"
#include "program files (x86)/windows kits/8.1/include/um/winbase.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xlocinfo"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/mat_aos.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/debug/logging.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vector"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/ctype.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wio.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/memory/heapmemory.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/thread/mutex.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/thread"

class extension::memory::MemoryAllocatorImpl
{
private:
	Scaleform::SysAllocStatic * m_pAllocator; // 0x8
	void * m_pMemory; // 0x10
	unsigned long m_allocatorHeapSize; // 0x18
public:
	MemoryAllocatorImpl(const extension::memory::MemoryAllocatorImpl &);
	MemoryAllocatorImpl(void *, unsigned long, unsigned long);
	~MemoryAllocatorImpl();
	bool free(void *, unsigned long, unsigned long);
	void * memalign(unsigned long, unsigned long);
	void * reallocalign(void *, unsigned long, unsigned long, unsigned long);
	extension::memory::MemoryAllocatorImpl & operator=(const extension::memory::MemoryAllocatorImpl &);
};
std::piecewise_construct_t std::piecewise_construct; // 0x1408AF07C
extension::memory::MemoryAllocatorImpl::MemoryAllocatorImpl(void * pMemory, unsigned long memorySize, unsigned long blockMinSize); // 0x1402A7B80
bool extension::memory::MemoryAllocatorImpl::free(void * ptr, unsigned long size, unsigned long align); // 0x1402A7C70
void * extension::memory::MemoryAllocatorImpl::memalign(unsigned long size, unsigned long align); // 0x1402A7C90
void * extension::memory::MemoryAllocatorImpl::reallocalign(void * oldPtr, unsigned long oldSize, unsigned long newSize, unsigned long align); // 0x1402A7CA0
extension::MemoryAllocator::MemoryAllocator(void * pMemory, unsigned long memorySize, unsigned long blockMinSize); // 0x1402A7E10
bool extension::MemoryAllocator::free(void * ptr, unsigned long size, unsigned long align); // 0x1402A7EF0
void * extension::MemoryAllocator::memalign(unsigned long size, unsigned long align); // 0x1402A7F10
void * extension::MemoryAllocator::reallocalign(void * oldPtr, unsigned long oldSize, unsigned long newSize, unsigned long align); // 0x1402A7F20//decompilation failure at 1408AF07C!
void __fastcall extension::MemoryAllocator::MemoryAllocator(
        extension::MemoryAllocator *this,
        void *pMemory,
        unsigned int memorySize,
        unsigned int blockMinSize)
{
  extension::memory::MemoryAllocatorImpl *v8; // rax
  extension::memory::MemoryAllocatorImpl *v9; // [rsp+40h] [rbp+8h]

  this->__vftable = (extension::MemoryAllocator_vtbl *)&extension::MemoryAllocator::`vftable';
  v9 = (extension::memory::MemoryAllocatorImpl *)operator new(0x20ui64);
  extension::memory::MemoryAllocatorImpl::MemoryAllocatorImpl(v9, pMemory, memorySize, blockMinSize);
  this->m_pAllocator = v8;
  this->m_memorySize = memorySize;
}

void __fastcall extension::memory::MemoryAllocatorImpl::MemoryAllocatorImpl(
        extension::memory::MemoryAllocatorImpl *this,
        void *pMemory,
        unsigned int memorySize,
        unsigned int blockMinSize)
{
  Scaleform::SysAllocStatic *v7; // rcx
  unsigned int v8; // eax
  Scaleform::SysAllocStatic *v9; // rax
  __int64 v10; // rdi
  unsigned int v11; // ebp
  char *m_pMemory; // rdx
  char *v13; // rbx
  char *v14; // rsi
  char *v15; // rdi
  unsigned int v16[12]; // [rsp+30h] [rbp-68h] BYREF

  this->__vftable = (extension::memory::MemoryAllocatorImpl_vtbl *)&extension::memory::MemoryAllocatorImpl::`vftable';
  this->m_pAllocator = 0i64;
  this->m_pMemory = pMemory;
  v7 = (Scaleform::SysAllocStatic *)operator new(0x168ui64);
  v8 = 128;
  if ( blockMinSize > 0x80 )
    v8 = blockMinSize;
  Scaleform::SysAllocStatic::SysAllocStatic(v7, v8);
  this->m_pAllocator = v9;
  v10 = memorySize >> 2;
  v11 = v10;
  m_pMemory = (char *)this->m_pMemory;
  v13 = &m_pMemory[v10];
  v14 = &m_pMemory[(unsigned int)(2 * v10)];
  v15 = &m_pMemory[(unsigned int)(3 * v10)];
  Scaleform::SysAllocStatic::AddMemSegment(v9, m_pMemory, v11);
  Scaleform::SysAllocStatic::AddMemSegment(this->m_pAllocator, v13, v11);
  Scaleform::SysAllocStatic::AddMemSegment(this->m_pAllocator, v14, v11);
  Scaleform::SysAllocStatic::AddMemSegment(this->m_pAllocator, v15, v11);
  this->m_pAllocator->GetInfo(this->m_pAllocator, (Scaleform::SysAllocPaged::Info *)v16);
  this->m_allocatorHeapSize = v16[0];
}

bool __fastcall extension::MemoryAllocator::free(
        extension::MemoryAllocator *this,
        void *ptr,
        __int64 size,
        __int64 align)
{
  return !ptr || this->m_pAllocator->free(this->m_pAllocator, ptr, size, align);
}

bool __fastcall extension::memory::MemoryAllocatorImpl::free(
        extension::memory::MemoryAllocatorImpl *this,
        void *ptr,
        unsigned int size,
        unsigned int align)
{
  return this->m_pAllocator->Free(this->m_pAllocator, ptr, size, align);
}

void *__fastcall extension::MemoryAllocator::memalign(extension::MemoryAllocator *this, __int64 size, __int64 align)
{
  return this->m_pAllocator->memalign(this->m_pAllocator, size, align);
}

void *__fastcall extension::memory::MemoryAllocatorImpl::memalign(
        extension::memory::MemoryAllocatorImpl *this,
        unsigned int size,
        unsigned int align)
{
  return this->m_pAllocator->Alloc(this->m_pAllocator, size, align);
}

void *__fastcall extension::MemoryAllocator::reallocalign(
        extension::MemoryAllocator *this,
        void *oldPtr,
        unsigned int oldSize,
        unsigned int newSize)
{
  if ( oldSize == newSize )
    return oldPtr;
  else
    return (void *)((__int64 (__fastcall *)(extension::memory::MemoryAllocatorImpl *, void *))this->m_pAllocator->reallocalign)(
                     this->m_pAllocator,
                     oldPtr);
}

void *__fastcall extension::memory::MemoryAllocatorImpl::reallocalign(
        extension::memory::MemoryAllocatorImpl *this,
        void *oldPtr,
        unsigned int oldSize,
        unsigned int newSize,
        unsigned int align)
{
  unsigned int v7; // ebx
  void *v8; // r15
  float m_allocatorHeapSize; // xmm2_4
  float v11; // xmm1_4
  int v12; // ecx
  float v13; // xmm1_4
  int v14; // eax
  unsigned int v15; // ebp
  void *v16; // rax

  v7 = newSize;
  v8 = 0i64;
  m_allocatorHeapSize = (float)(int)this->m_allocatorHeapSize;
  v11 = (float)(int)oldSize / m_allocatorHeapSize;
  v12 = (int)v11;
  if ( (float)(int)v11 != v11 )
    ++v12;
  v13 = (float)(int)newSize / m_allocatorHeapSize;
  v14 = (int)v13;
  if ( (float)(int)v13 != v13 )
    ++v14;
  if ( v12 != v14 )
  {
    v15 = align;
    v16 = this->memalign(this, newSize, align);
    v8 = v16;
    if ( v16 )
    {
      if ( oldSize < v7 )
        v7 = oldSize;
      memmove(v16, oldPtr, v7);
    }
    goto LABEL_10;
  }
  v15 = align;
  if ( !this->m_pAllocator->ReallocInPlace(this->m_pAllocator, oldPtr, oldSize, newSize, align) )
  {
LABEL_10:
    this->free(this, oldPtr, oldSize, v15);
    return v8;
  }
  return oldPtr;
}

