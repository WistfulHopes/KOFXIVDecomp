#include "program files (x86)/microsoft visual studio 14.0/vc/include/xmemory"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/thr/xthread"
#include "dev/kof/master/development/source/baseproject/jni/framework/memory/globalheapmemory.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/memory/fixmemory.h"
#include "dev/silverware/git/sdk/input/agsdlmappingparser.h"
#include "dev/kof/master/development/source/ps4project/toolkit/geommath/matrix4unaligned.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/scalar_cpp/quat_aos.h"
#include "dev/silverware/git/sdk/platforms/pc/system/agpcsysteminfo.h"
#include "dev/silverware/git/sdk/agreferencecountinl.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_refcount.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_memory.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_memoryheap.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_stats.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_timer.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/internal/internal_sse.h"
#include "dev/silverware/git/sdk/3rdparty/steam/steamclientpublic.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/internal/internal_types.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xatomic0.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/memory/variableheapmemorybase.h"
#include "dev/kof/master/development/source/ps4project/toolkit/geommath/vector2unaligned.h"
#include "dev/silverware/git/sdk/agmemorystream.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_sysalloc.h"
#include "dev/silverware/git/sdk/agmemorypool.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/internal/internal_functions.h"
#include "dev/silverware/git/sdk/input/agcontrollerbuttoncomponent.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_threads.h"
#include "dev/silverware/git/sdk/agpointerinl.h"
#include "dev/silverware/git/sdk/agstream.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/stdio.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_types.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/memory/physicalheapmemory.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wstdio.h"
#include "dev/silverware/git/sdk/agsemaphore.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_stdio_config.h"
#include "dev/silverware/git/sdk/agsemaphore.inl"
#include "dev/silverware/git/sdk/agconditionvariable.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/condition_variable"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/deque"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/sys/stat.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_allocinfo.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/scalar_cpp/boolinvec.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/time.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xtgmath.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xtr1common"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wstring.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/thread/jobmanager.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/stdlib.h"
#include "program files (x86)/windows kits/8.1/include/shared/guiddef.h"
#include "dev/kof/master/development/source/ps4project/toolkit/geommath/vector3unaligned.h"
#include "program files (x86)/windows kits/8.1/include/shared/stralign.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vcruntime_typeinfo.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/util/resourcemanager.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xfacet"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xutility"
#include "dev/silverware/git/sdk/3rdparty/steam/isteamhtmlsurface.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/vec_aos.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/list"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/boolinvec.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/string.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_memory.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_memcpy_s.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/scalar_cpp/vectormath_aos.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/wchar.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wconio.h"
#include "program files (x86)/windows kits/8.1/include/um/winnt.h"
#include "dev/silverware/git/sdk/agreferencedobjectinl.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/functional"
#include "dev/silverware/git/sdk/agpointer.h"
#include "program files (x86)/windows kits/8.1/include/shared/basetsd.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xstring"
#include "dev/silverware/git/sdk/agreferencedobject.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xmemory0"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wtime.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/heapmh/heapmh_sysallocmalloc.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/malloc.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/exception"
#include "dev/silverware/git/sdk/agconditionvariable.inl"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vcruntime_exception.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/scalar_cpp/mat_aos.h"
#include "dev/silverware/git/sdk/agthread.h"
#include "dev/silverware/git/sdk/agmutex.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/array"
#include "dev/silverware/git/sdk/agscopedlock.h"
#include "dev/silverware/git/sdk/3rdparty/steam/steam_api_internal.h"
#include "dev/kof/master/development/source/ps4project/baseproject/pcutil/pccontrolsmanager.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/algorithm"
#include "dev/silverware/git/sdk/input/aginputmanager.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/system_error"
#include "dev/silverware/git/sdk/agsingleton.h"
#include "dev/kof/master/development/source/ps4project/toolkit/geommath/vector4unaligned.h"
#include "dev/silverware/git/sdk/agmutex.inl"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/stdexcept"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/utility"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/vecidx_aos.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/iosfwd"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/map"
#include "program files (x86)/windows kits/8.1/include/um/winuser.h"
#include "dev/silverware/git/sdk/memory/agallocators.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/floatinvec.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xtree"
#include "dev/silverware/git/sdk/input/agcontrollercomponent.h"
#include "dev/silverware/git/sdk/3rdparty/steam/steam_api.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/tuple"
#include "dev/kof/master/development/source/ps4project/baseproject/pcutil/pcdummy.h"
#include "dev/silverware/git/sdk/util/agdelegate.h"
#include "dev/silverware/git/sdk/agreferencecount.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vcruntime_new.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/quat_aos.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/scalar_cpp/floatinvec.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vadefs.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xstddef"
#include "dev/silverware/git/sdk/agvector2.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/type_traits"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/internal/internal_vec64.h"
#include "dev/silverware/git/sdk/agmath.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_array.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_allocator.h"
#include "dev/silverware/git/sdk/input/agcontroller.h"
#include "dev/silverware/git/sdk/system/aguser.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/cmath"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_atomic.h"
#include "dev/silverware/git/sdk/agstring.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/math.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/internal/internal_math.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/mutex"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/string"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/chrono"
#include "dev/kof/master/development/source/baseproject/jni/framework/libcommon.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/scalar_cpp/vec_aos.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/limits"
#include "dev/silverware/git/sdk/3rdparty/steam/matchmakingtypes.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/ios"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xlocnum"
#include "dev/silverware/git/sdk/system/agsysteminfo.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xiosbase"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xlocale"
#include "program files (x86)/windows kits/8.1/include/um/winbase.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xlocinfo"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/mat_aos.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/debug/logging.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vector"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/ctype.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wio.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/memory/heapmemory.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/thread/mutex.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/thread"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/memory"
#include "dev/kof/master/development/source/baseproject/jni/framework/thread/semaphore.cpp"
#include "dev/kof/master/development/source/baseproject/jni/framework/thread/mutex.cpp"
#include "dev/kof/master/development/source/baseproject/jni/framework/thread/threadsystem.cpp"
#include "dev/kof/master/development/source/baseproject/jni/framework/memory/heapmemory.cpp"
#include "dev/kof/master/development/source/baseproject/jni/framework/memory/replace.cpp"

std::piecewise_construct_t std::piecewise_construct; // 0x14088982F
Fw::cJobManager::~cJobManager(); // 0x140094B70
bool Fw::cJobManager::Startup(Fw::HeapMemory & rHeap, long jobMax, const char * threadName, unsigned long long * cpuAffinity); // 0x140094B90
void Fw::cJobManager::Shutdown(); // 0x140094CD0
void Fw::cJobManager::Execute(long jobNum); // 0x140094E60
void Fw::cJobManager::jobThread(void * pParam); // 0x140094F40//decompilation failure at 14088982F!
void __fastcall Fw::cJobManager::~cJobManager(Fw::cJobManager *this)
{
  Fw::cJobManager::Shutdown(this);
}

void __fastcall Fw::cJobManager::Execute(Fw::cJobManager *this, __int64 jobNum)
{
  int m_WorkNum; // ecx
  int v4; // edi
  Fw::cJobManager::cWork **v5; // rsi
  AgSemaphore *m_hSemaphore; // rcx
  void (__fastcall *m_pJobFunc)(void *); // rax
  int v8; // edi
  Fw::cJobManager::cWork **v9; // rsi
  AgSemaphore *v10; // r14

  m_WorkNum = 5;
  if ( this->m_WorkNum < 5 )
    m_WorkNum = this->m_WorkNum;
  if ( !this->m_RunningFlag )
  {
    v4 = 1;
    this->m_ExecuteWorkNum = m_WorkNum;
    if ( m_WorkNum > 1 )
    {
      v5 = &this->m_pWork[1];
      do
      {
        m_hSemaphore = (*v5)->m_SyncStart.m_hSemaphore;
        if ( !m_hSemaphore->m_data.m_aborted )
          ReleaseSemaphore(m_hSemaphore->m_data.m_sem, 1, 0i64);
        ++v4;
        ++v5;
      }
      while ( v4 < this->m_ExecuteWorkNum );
    }
    m_pJobFunc = this->m_pWork[0]->m_pJobFunc;
    if ( m_pJobFunc )
      ((void (__fastcall *)(void *, __int64))m_pJobFunc)(this->m_pWork[0]->m_pJobParam, jobNum);
    v8 = 1;
    if ( this->m_ExecuteWorkNum > 1 )
    {
      v9 = &this->m_pWork[1];
      do
      {
        v10 = (*v9)->m_SyncEnd.m_hSemaphore;
        if ( !v10->m_data.m_aborted )
          WaitForSingleObjectEx(v10->m_data.m_sem, 0xFFFFFFFF, 1);
        ++v8;
        ++v9;
      }
      while ( v8 < this->m_ExecuteWorkNum );
    }
    this->m_ExecuteWorkNum = 0;
  }
}

void __fastcall Fw::cJobManager::Shutdown(Fw::cJobManager *this)
{
  unsigned int m_Flag; // eax
  int v3; // ebp
  void **v4; // rbx
  __int64 v5; // rcx
  int v6; // edi
  unsigned int v7; // ecx
  Fw::ThreadSystem::cWork **v8; // rax
  AgThread **v9; // rdx
  _QWORD *v10; // rsi
  _QWORD *v11; // rdi
  void *v12; // rcx
  _QWORD *v13; // rdi
  _QWORD *v14; // rsi
  void *v15; // rcx

  m_Flag = this->m_Flag;
  if ( (m_Flag & 1) != 0 )
  {
    v3 = 1;
    this->m_Flag = m_Flag | 2;
    if ( this->m_WorkNum > 1 )
    {
      v4 = (void **)&this->m_pWork[1];
      do
      {
        v5 = *((_QWORD *)*v4 + 2);
        if ( !*(_DWORD *)v5 )
          ReleaseSemaphore(*(HANDLE *)(v5 + 8), 1, 0i64);
        v6 = *((_DWORD *)*v4 + 2);
        EnterCriticalSection((LPCRITICAL_SECTION)&Fw::ThreadSystem::m_Mutex);
        if ( v6 )
        {
          v7 = 0;
          if ( (_DWORD)Fw::ThreadSystem::m_WorkNum )
          {
            v8 = Fw::ThreadSystem::m_pWork;
            while ( 1 )
            {
              v9 = (AgThread **)*v8;
              if ( (*v8)->m_Handle == v6 )
                break;
              ++v7;
              ++v8;
              if ( v7 >= (unsigned int)Fw::ThreadSystem::m_WorkNum )
                goto LABEL_14;
            }
            if ( v9 )
              AgThread::join(v9[2]);
          }
        }
LABEL_14:
        LeaveCriticalSection((LPCRITICAL_SECTION)&Fw::ThreadSystem::m_Mutex);
        *((_DWORD *)*v4 + 2) = 0;
        v10 = *v4;
        v11 = (_QWORD *)*((_QWORD *)*v4 + 2);
        if ( v11 )
        {
          v12 = (void *)v11[1];
          if ( v12 )
            CloseHandle(v12);
          operator delete(v11, 0x10ui64);
        }
        v10[2] = 0i64;
        v13 = *v4;
        v14 = (_QWORD *)*((_QWORD *)*v4 + 3);
        if ( v14 )
        {
          v15 = (void *)v14[1];
          if ( v15 )
            CloseHandle(v15);
          operator delete(v14, 0x10ui64);
        }
        v13[3] = 0i64;
        if ( *v4 )
        {
          aligned_free(*v4);
          *v4 = 0i64;
        }
        ++v3;
        ++v4;
      }
      while ( v3 < this->m_WorkNum );
    }
    if ( this->m_pWork[0] )
    {
      aligned_free(this->m_pWork[0]);
      this->m_pWork[0] = 0i64;
    }
    *(_QWORD *)&this->m_WorkNum = 0i64;
  }
}

char __fastcall Fw::cJobManager::Startup(
        Fw::cJobManager *this,
        Fw::HeapMemory *rHeap,
        int jobMax,
        const char *threadName)
{
  __int64 v4; // rbx
  Fw::cJobManager::cWork *v6; // rax
  int v7; // ebp
  void **i; // r14
  _QWORD *v9; // rdi
  _QWORD *v10; // rbx
  _QWORD *v11; // rbx
  void (__fastcall *v12)(void *); // rcx
  const char *v13; // r8
  unsigned __int64 *v14; // r9
  Fw::THREAD_HANDLE v15; // eax
  unsigned int v17; // [rsp+20h] [rbp-28h]

  v4 = 0i64;
  while ( 1 )
  {
    v6 = (Fw::cJobManager::cWork *)aligned_malloc(0x30ui64, 0x20ui64);
    if ( v6 )
    {
      v6->m_SyncStart.m_hSemaphore = 0i64;
      v6->m_SyncEnd.m_hSemaphore = 0i64;
      v6->m_pJobFunc = 0i64;
      v6->m_pJobParam = 0i64;
    }
    else
    {
      v6 = 0i64;
    }
    this->m_pWork[v4] = v6;
    if ( !v6 )
      break;
    if ( ++v4 >= 5 )
    {
      this->m_WorkNum = 5;
      v7 = 1;
      *(_QWORD *)&this->m_Flag = 1i64;
      this->m_RunningFlag = 0;
      if ( this->m_WorkNum <= 1 )
        return 1;
      for ( i = (void **)&this->m_pWork[1]; ; ++i )
      {
        v9 = *i;
        *(_QWORD *)*i = this;
        v10 = operator new(0x10ui64);
        *(_DWORD *)v10 = 0;
        v10[1] = 0i64;
        v10[1] = CreateSemaphoreA(0i64, 0, 1, 0i64);
        v9[2] = v10;
        v11 = operator new(0x10ui64);
        *(_DWORD *)v11 = 0;
        v11[1] = 0i64;
        v11[1] = CreateSemaphoreA(0i64, 0, 1, 0i64);
        v9[3] = v11;
        v15 = Fw::ThreadSystem::Create(v12, *i, v13, v14, v17);
        *((_DWORD *)v9 + 2) = v15;
        if ( v15 == THREAD_HANDLE_INVALID )
          break;
        if ( ++v7 >= this->m_WorkNum )
          return 1;
      }
      break;
    }
  }
  Fw::cJobManager::Shutdown(this);
  return 0;
}

void __fastcall Fw::cJobManager::jobThread(void *pParam)
{
  __int64 v2; // rsi
  __int64 v3; // rdi
  void (__fastcall *v4)(_QWORD); // rax
  __int64 v5; // rcx
  unsigned __int64 CurrentId; // rdi
  __int64 v7; // rbx
  unsigned int i; // edx
  Fw::ThreadSystem::cWork *v9; // rcx
  Fw::ThreadSystem::cWork *v10; // rdx

  v2 = *(_QWORD *)pParam;
  while ( 1 )
  {
    v3 = *((_QWORD *)pParam + 2);
    if ( !*(_DWORD *)v3 )
      WaitForSingleObjectEx(*(HANDLE *)(v3 + 8), 0xFFFFFFFF, 1);
    if ( (*(_DWORD *)(v2 + 44) & 2) != 0 )
      break;
    v4 = (void (__fastcall *)(_QWORD))*((_QWORD *)pParam + 4);
    if ( v4 )
      v4(*((_QWORD *)pParam + 5));
    v5 = *((_QWORD *)pParam + 3);
    if ( !*(_DWORD *)v5 )
      ReleaseSemaphore(*(HANDLE *)(v5 + 8), 1, 0i64);
  }
  EnterCriticalSection((LPCRITICAL_SECTION)&Fw::ThreadSystem::m_Mutex);
  CurrentId = AgThread::getCurrentId();
  v7 = 0i64;
  for ( i = (unsigned int)Fw::ThreadSystem::m_WorkNum; (unsigned int)v7 < i; v7 = (unsigned int)(v7 + 1) )
  {
    v9 = Fw::ThreadSystem::m_pWork[v7];
    if ( v9->m_Handle )
    {
      if ( AgThread::getId(v9->m_ThreadId.m_ptr) == CurrentId )
      {
        v10 = Fw::ThreadSystem::m_pWork[v7];
        if ( v10 )
          v10->m_Handle = THREAD_HANDLE_INVALID;
        break;
      }
      i = (unsigned int)Fw::ThreadSystem::m_WorkNum;
    }
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)&Fw::ThreadSystem::m_Mutex);
}

