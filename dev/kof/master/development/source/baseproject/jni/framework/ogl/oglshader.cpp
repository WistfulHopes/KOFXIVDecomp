#include "program files (x86)/microsoft visual studio 14.0/vc/include/xmemory"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/thr/xthread"
#include "dev/kof/master/development/source/baseproject/jni/framework/memory/globalheapmemory.h"
#include "dev/silverware/git/sdk/agcondition.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/memory/fixmemory.h"
#include "dev/silverware/git/sdk/input/agsdlmappingparser.h"
#include "dev/kof/master/development/source/ps4project/toolkit/geommath/matrix4unaligned.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ogl/ogleffect.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/scalar_cpp/quat_aos.h"
#include "dev/silverware/git/sdk/platforms/pc/system/agpcsysteminfo.h"
#include "dev/silverware/git/sdk/filesystem/agfile.h"
#include "dev/silverware/git/sdk/filesystem/agpath.h"
#include "dev/silverware/git/sdk/agreferencecountinl.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ogl/ogllight.h"
#include "dev/silverware/git/sdk/filesystem/agmount.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ogl/oglcurve.h"
#include "dev/silverware/git/sdk/filesystem/agdirectory.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_refcount.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_memory.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_memoryheap.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_stats.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_timer.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/internal/internal_sse.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ogl/oglsprite.h"
#include "dev/silverware/git/sdk/3rdparty/steam/steamclientpublic.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/internal/internal_types.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ogl/oglrender.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xatomic0.h"
#include "dev/silverware/git/sdk/aghash.h"
#include "dev/silverware/git/sdk/agstringutils.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ogl/oglfog.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/memory/variableheapmemorybase.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/lib/etc/math.h"
#include "dev/kof/master/development/source/ps4project/toolkit/geommath/vector2unaligned.h"
#include "dev/silverware/git/sdk/agmemorystream.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_sysalloc.h"
#include "dev/silverware/git/sdk/agmemorypool.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/internal/internal_functions.h"
#include "dev/silverware/git/sdk/input/agcontrollerbuttoncomponent.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_threads.h"
#include "dev/silverware/git/sdk/agpointerinl.h"
#include "dev/silverware/git/sdk/agstream.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/stdio.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_types.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/memory/physicalheapmemory.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wstdio.h"
#include "dev/silverware/git/sdk/agcondition.inl"
#include "dev/silverware/git/sdk/agsemaphore.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_stdio_config.h"
#include "dev/silverware/git/sdk/agsemaphore.inl"
#include "dev/silverware/git/sdk/agconditionvariable.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/condition_variable"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/deque"
#include "dev/silverware/git/sdk/system/agusermanager.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/sys/stat.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_allocinfo.h"
#include "dev/silverware/git/sdk/util/agservice.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/scalar_cpp/boolinvec.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/time.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xtgmath.h"
#include "dev/silverware/git/sdk/agthreadpool.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xtr1common"
#include "dev/kof/master/development/source/baseproject/jni/framework/ogl/oglshader.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wstring.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/thread/jobmanager.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/stdlib.h"
#include "program files (x86)/windows kits/8.1/include/shared/guiddef.h"
#include "dev/kof/master/development/source/ps4project/toolkit/geommath/vector3unaligned.h"
#include "program files (x86)/windows kits/8.1/include/shared/stralign.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vcruntime_typeinfo.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/util/resourcemanager.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xfacet"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xutility"
#include "dev/silverware/git/sdk/3rdparty/steam/isteamhtmlsurface.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/vec_aos.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/list"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/boolinvec.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/string.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_memory.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_memcpy_s.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/scalar_cpp/vectormath_aos.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/wchar.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wconio.h"
#include "program files (x86)/windows kits/8.1/include/um/winnt.h"
#include "dev/silverware/git/sdk/agreferencedobjectinl.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/functional"
#include "dev/silverware/git/sdk/agpointer.h"
#include "program files (x86)/windows kits/8.1/include/shared/basetsd.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xstring"
#include "dev/silverware/git/sdk/agreferencedobject.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xmemory0"
#include "dev/kof/master/development/source/baseproject/jni/framework/ogl/oglmodel.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wtime.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/heapmh/heapmh_sysallocmalloc.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/atomic"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/malloc.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xatomic.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/exception"
#include "dev/silverware/git/sdk/agconditionvariable.inl"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vcruntime_exception.h"
#include "dev/silverware/git/sdk/agreferenceinl.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/scalar_cpp/mat_aos.h"
#include "dev/silverware/git/sdk/agthread.h"
#include "dev/silverware/git/sdk/agmutex.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/array"
#include "dev/silverware/git/sdk/agscopedlock.h"
#include "dev/silverware/git/sdk/3rdparty/steam/steam_api_internal.h"
#include "dev/kof/master/development/source/ps4project/baseproject/pcutil/pccontrolsmanager.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/algorithm"
#include "dev/silverware/git/sdk/input/aginputmanager.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/system_error"
#include "dev/silverware/git/sdk/agsingleton.h"
#include "dev/kof/master/development/source/ps4project/toolkit/geommath/vector4unaligned.h"
#include "dev/silverware/git/sdk/agmutex.inl"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/stdexcept"
#include "dev/kof/master/development/source/baseproject/jni/framework/ogl/oglbone.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/utility"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/vecidx_aos.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/iosfwd"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/map"
#include "program files (x86)/windows kits/8.1/include/um/winuser.h"
#include "dev/silverware/git/sdk/memory/agallocators.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/floatinvec.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xtree"
#include "dev/silverware/git/sdk/input/agcontrollercomponent.h"
#include "dev/silverware/git/sdk/3rdparty/steam/steam_api.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/tuple"
#include "dev/kof/master/development/source/ps4project/baseproject/pcutil/pcdummy.h"
#include "dev/silverware/git/sdk/util/agdelegate.h"
#include "dev/silverware/git/sdk/agreferencecount.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vcruntime_new.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/quat_aos.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/scalar_cpp/floatinvec.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vadefs.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xstddef"
#include "dev/kof/master/development/source/baseproject/jni/framework/ogl/oglmirror.h"
#include "dev/silverware/git/sdk/agvector2.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/type_traits"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/internal/internal_vec64.h"
#include "dev/silverware/git/sdk/agmath.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_array.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_allocator.h"
#include "dev/silverware/git/sdk/input/agcontroller.h"
#include "dev/silverware/git/sdk/system/aguser.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/cmath"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_atomic.h"
#include "dev/silverware/git/sdk/agstring.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/math.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/internal/internal_math.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/mutex"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/string"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/chrono"
#include "dev/kof/master/development/source/baseproject/jni/framework/libcommon.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/scalar_cpp/vec_aos.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/limits"
#include "dev/silverware/git/sdk/util/agservicecommand.h"
#include "dev/silverware/git/sdk/3rdparty/steam/matchmakingtypes.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/ios"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xxatomic"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xlocnum"
#include "dev/silverware/git/sdk/system/agsysteminfo.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xiosbase"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xlocale"
#include "dev/silverware/git/sdk/util/agdebugchannels.h"
#include "program files (x86)/windows kits/8.1/include/um/winbase.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xlocinfo"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/mat_aos.h"
#include "dev/silverware/git/sdk/util/agperformancecounter.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/debug/logging.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vector"
#include "dev/silverware/git/sdk/agclock.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/ctype.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wio.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/memory/heapmemory.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/thread/mutex.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/thread"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/memory"
#include "dev/kof/master/development/source/ps4project/baseproject/ag/kofshadermanager.cpp"
#include "dev/kof/master/development/source/baseproject/jni/framework/util/cfile.cpp"
#include "dev/kof/master/development/source/baseproject/jni/framework/memory/fixmemory.cpp"

unsigned char OGLShader::createShader(unsigned long vertShader, unsigned long fragShader, unsigned char crypt, long attribNum, const _SHADER_INFO * shaderAttrib, long uniformNum, const _SHADER_INFO * uniformAttrib, unsigned char * pData); // 0x1400900C0
unsigned char OGLShader::createShader(unsigned long vertShader, unsigned long fragSlot, const char * fragFile, unsigned char crypt, long attribNum, const _SHADER_INFO * shaderAttrib, long uniformNum, const _SHADER_INFO * uniformAttrib, unsigned char * pData); // 0x140090240
unsigned char OGLShader::createComputeShader(const char * _compFile, unsigned char crypt, long attribNum, const _SHADER_INFO * shaderAttrib, long uniformNum, const _SHADER_INFO * uniformAttrib, unsigned char * pData); // 0x1400903B0
unsigned char OGLShader::createShader(unsigned long _vertShader, unsigned long fragSlot, const char * fragFile, bool crypt, long attribNum, const _SHADER_INFO * shaderAttrib, long uniformNum, const _SHADER_INFO * uniformAttrib, void * instancing, const unsigned long numElementsInInstancingData, unsigned char * pData); // 0x140090590
unsigned char OGLShader::compileShader(unsigned long * slot, unsigned long type, const char * filename, unsigned char crypt, unsigned char * pData, long fileSize); // 0x140090740
unsigned char OGLShader::getAttribLocations(long num, const _SHADER_INFO * shaderAttrib); // 0x140090A00
unsigned char OGLShader::getUniformLocations(long num, const _SHADER_INFO * shaderUniform); // 0x140090AB0
struct glsl_type_set
{
	unsigned long type; // 0x0
	const char * name; // 0x8
};
glsl_type_set type_set[106]; // 0x140A5A270
std::piecewise_construct_t std::piecewise_construct; // 0x1408895DD//decompilation failure at 140A5A270!
//decompilation failure at 1408895DD!
unsigned __int8 __fastcall OGLShader::compileShader(
        unsigned int *slot,
        unsigned int type,
        const char *filename,
        const char *crypt,
        unsigned __int8 *pData,
        int fileSize)
{
  char v6; // r12
  unsigned int v8; // edi
  char *v10; // rsi
  unsigned __int8 *v11; // r14
  unsigned __int8 *v12; // rcx
  int v13; // er8
  unsigned __int64 v14; // rdx
  AgFile *m_ptr; // rdi
  int v16; // eax
  const char *v17; // rcx
  int v18; // eax
  unsigned int v19; // ebx
  char **fNameIndex; // rbx
  AgReferenceCount *m_ref; // rax
  unsigned int *v22; // rbx
  unsigned int Shader; // eax
  int v24; // er8
  unsigned __int64 v25; // rdx
  char *v27; // [rsp+30h] [rbp-A8h] BYREF
  int v28; // [rsp+38h] [rbp-A0h] BYREF
  int v29; // [rsp+3Ch] [rbp-9Ch] BYREF
  CFile v30; // [rsp+40h] [rbp-98h] BYREF
  AgPointer<KOFApplication> v31; // [rsp+90h] [rbp-48h] BYREF
  __int64 v32; // [rsp+A0h] [rbp-38h]

  v32 = -2i64;
  v6 = (char)crypt;
  v8 = type;
  v27 = 0i64;
  v10 = 0i64;
  v11 = pData;
  if ( pData )
  {
    v12 = pData;
    v27 = (char *)pData;
    v13 = fileSize;
    LODWORD(pData) = fileSize;
    goto LABEL_25;
  }
  memset(&v30.pFileName, 0, 28);
  memset(&v30, 0, 28);
  v31 = 0i64;
  AgPointer<AgUser>::~AgPointer<AgUser>(&v31);
  if ( CFile::copen(&v30, filename, 0, 1) )
  {
    m_ptr = v30.m_file.m_ptr;
    if ( v30.m_file.m_ptr )
      v16 = v30.m_file.m_ptr->getSize(v30.m_file.m_ptr);
    else
      v16 = 0;
    v30.m_iSeek = 0;
    LODWORD(pData) = v16;
    if ( v16 > 0 )
    {
      CFixMemory::GetInstance();
      v10 = (char *)operator new[]((unsigned int)((_DWORD)pData + 1));
      v17 = v10;
      v27 = v10;
      v18 = (int)pData;
      v19 = (unsigned int)pData;
      if ( m_ptr )
      {
        m_ptr->setPosition(m_ptr, 0i64);
        v30.m_iSeekPos = 0;
        m_ptr->read(m_ptr, (unsigned __int8 *)v10, v19);
        v17 = v27;
        v18 = (int)pData;
      }
      v30.m_iSeek = v19;
      v17[v18] = 0;
      fNameIndex = v30.fNameIndex;
      if ( v30.fNameIndex )
      {
        operator delete(v30.fNameIndex, v14);
        fNameIndex = 0i64;
        v30.fNameIndex = 0i64;
      }
      if ( m_ptr )
      {
        m_ref = v30.m_file.m_ref;
        v30.m_file = 0i64;
        v31.m_ref = m_ref;
        v31.m_ptr = (KOFApplication *)m_ptr;
        AgPointer<AgUser>::~AgPointer<AgUser>(&v31);
      }
      *(_QWORD *)&v30.m_iSeekPos = 0i64;
      v8 = type;
      goto LABEL_18;
    }
    v8 = type;
  }
  else
  {
    v30.m_iSeek = 0;
    LODWORD(pData) = 0;
  }
  fNameIndex = v30.fNameIndex;
LABEL_18:
  if ( !v27 )
  {
    if ( fNameIndex )
    {
      operator delete(fNameIndex, v14);
      v30.fNameIndex = 0i64;
    }
    AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)&v30);
    return 0;
  }
  if ( fNameIndex )
  {
    operator delete(fNameIndex, v14);
    v30.fNameIndex = 0i64;
  }
  AgPointer<AgUser>::~AgPointer<AgUser>((AgPointer<KOFApplication> *)&v30);
  v12 = (unsigned __int8 *)v27;
  v13 = (int)pData;
LABEL_25:
  if ( v6 )
    CFile::decrypt(v12, type, v13, crypt);
  v22 = (unsigned int *)&v28;
  if ( *slot )
  {
    _glewShaderSource(*slot, 1, (const char *const *)&v27, (const int *)&pData);
    v22 = slot;
  }
  else
  {
    Shader = KOFShaderManager::createShader((KOFShaderManager *)AgSingleton<KOFShaderManager>::ms_instance, v8);
    v25 = Shader;
    *slot = Shader;
    v28 = (int)AgSingleton<KOFShaderManager>::ms_instance[4 * Shader + 360451].__vftable;
    if ( !v28 )
    {
$_ERROR_7:
      if ( *v22 )
      {
        _glewDeleteShader(*v22);
        *v22 = 0;
      }
      if ( !v11 && v10 )
        operator delete(v10, v25);
      return 0;
    }
    KOFShaderManager::loadShader(
      (KOFShaderManager *)AgSingleton<KOFShaderManager>::ms_instance,
      Shader,
      v24,
      (const char **)&v27,
      (const int *)&pData,
      filename);
  }
  _glewCompileShader(*v22);
  _glewGetShaderiv(*v22, 0x8B81u, &v29);
  if ( !v29 )
    goto $_ERROR_7;
  if ( !v11 )
  {
    if ( v10 )
      operator delete(v10, v25);
  }
  return 1;
}

unsigned __int8 __fastcall OGLShader::createComputeShader(
        OGLShader *this,
        const char *_compFile,
        unsigned __int8 crypt,
        int attribNum,
        const _SHADER_INFO *shaderAttrib,
        int uniformNum,
        const _SHADER_INFO *uniformAttrib)
{
  const char *v8; // rax
  signed __int64 v10; // rdx
  char v11; // cl
  __int64 v12; // rdx
  unsigned __int64 v13; // rdx
  KOFShaderManager *v14; // rsi
  unsigned int v15; // eax
  KOFShaderManager *v16; // rcx
  KOFShaderManager *v17; // rcx
  int Program; // eax
  KOFShaderManager *v19; // r11
  int *glValue; // rcx
  int *m_piGLUniform; // rcx
  unsigned int slot[4]; // [rsp+30h] [rbp-78h] BYREF
  char filename[64]; // [rsp+40h] [rbp-68h] BYREF

  v8 = _compFile;
  v10 = filename - _compFile;
  do
  {
    v11 = *v8;
    v8[v10] = *v8;
    ++v8;
  }
  while ( v11 );
  v12 = -1i64;
  do
    ++v12;
  while ( _compFile[v12] );
  filename[(int)v12 - 2] = 99;
  filename[(int)v12 - 1] = 115;
  filename[(int)v12] = 104;
  if ( (unsigned __int64)((int)v12 + 1) >= 0x40 )
  {
    _report_rangecheckfailure((int)v12 + 1, v12);
    JUMPOUT(0x14009058Ci64);
  }
  filename[(int)v12 + 1] = 0;
  slot[0] = 0;
  if ( OGLShader::compileShader(slot, 0x91B9u, filename, 0i64, 0i64, 0)
    && (v14 = (KOFShaderManager *)AgSingleton<KOFShaderManager>::ms_instance,
        v15 = KOFShaderManager::createProgram(
                (KOFShaderManager *)AgSingleton<KOFShaderManager>::ms_instance,
                &this->m_programSlot),
        (this->m_Program = v15) != 0) )
  {
    KOFShaderManager::attachShaderSlot(v14, this->m_programSlot, slot[0]);
    v17 = (KOFShaderManager *)((char *)v14 + 88 * KOFShaderManager::findProgram(v16, this->m_Program));
    v17->m_program[0].m_uniformNum = uniformNum;
    v17->m_program[0].m_uniformAttrib = uniformAttrib;
    v17->m_program[0].m_isLinked = 0;
    v17->m_program[0].m_pOglShader = this;
    v17->m_program[0].m_attribNum = 0;
    v17->m_program[0].m_shaderAttrib = 0i64;
    Program = KOFShaderManager::findProgram(v17, this->m_Program);
    KOFShaderManager::link(v19, &v19->m_program[Program]);
    _glewDeleteShader((unsigned int)AgSingleton<KOFShaderManager>::ms_instance[4 * slot[0] + 360451].__vftable);
    return 1;
  }
  else
  {
    if ( this->m_Program )
    {
      _glewDeleteProgram(this->m_Program);
      this->m_Program = 0;
    }
    glValue = this->m_piGLAttrib.glValue;
    if ( glValue )
    {
      operator delete(glValue, v13);
      this->m_piGLAttrib.glValue = 0i64;
    }
    m_piGLUniform = this->m_piGLUniform;
    this->m_iGLAttribNum = 0;
    if ( m_piGLUniform )
    {
      operator delete(m_piGLUniform, v13);
      this->m_piGLUniform = 0i64;
    }
    this->m_iGLUniformNum = 0;
    return 0;
  }
}

unsigned __int8 __fastcall OGLShader::createShader(
        OGLShader *this,
        unsigned __int64 vertShader,
        unsigned int fragShader,
        unsigned __int8 crypt,
        int attribNum,
        const _SHADER_INFO *shaderAttrib,
        int uniformNum,
        const _SHADER_INFO *uniformAttrib)
{
  __int64 v9; // r15
  unsigned int m_Program; // ecx
  __int64 v11; // r12
  int *glValue; // rcx
  int *m_piGLUniform; // rcx
  AgSingleton<KOFShaderManager> *v14; // rbp
  KOFShaderManager *v15; // rcx
  unsigned int Program; // eax
  unsigned __int64 v17; // rdx
  int *v18; // rcx
  int *v19; // rcx
  unsigned __int8 result; // al
  AgSingleton<KOFShaderManager> *v21; // rdi
  __int64 v22; // rcx
  AgSingleton<KOFShaderManager> *v23; // rdi
  KOFShaderManager *v24; // rcx
  AgSingleton<KOFShaderManager> *v25; // rcx

  v9 = (int)fragShader;
  m_Program = this->m_Program;
  v11 = (int)vertShader;
  if ( m_Program )
  {
    _glewDeleteProgram(m_Program);
    this->m_Program = 0;
  }
  glValue = this->m_piGLAttrib.glValue;
  if ( glValue )
  {
    operator delete(glValue, vertShader);
    this->m_piGLAttrib.glValue = 0i64;
  }
  m_piGLUniform = this->m_piGLUniform;
  this->m_iGLAttribNum = 0;
  if ( m_piGLUniform )
  {
    operator delete(m_piGLUniform, vertShader);
    this->m_piGLUniform = 0i64;
  }
  v14 = AgSingleton<KOFShaderManager>::ms_instance;
  v15 = (KOFShaderManager *)AgSingleton<KOFShaderManager>::ms_instance;
  this->m_iGLUniformNum = 0;
  Program = KOFShaderManager::createProgram(v15, &this->m_programSlot);
  this->m_Program = Program;
  if ( Program )
  {
    v21 = &v14[11 * this->m_programSlot];
    _glewAttachShader((unsigned int)v21[1].__vftable, (unsigned int)v14[4 * v11 + 360451].__vftable);
    v22 = SHIDWORD(v14[4 * v11 + 360451].__vftable);
    *((_DWORD *)&v21[1].__vftable + v22 + 1) = v14[4 * v11 + 360451].__vftable;
    *((_DWORD *)&v21[3].__vftable + v22 + 1) = v11;
    v23 = &v14[11 * this->m_programSlot];
    _glewAttachShader((unsigned int)v23[1].__vftable, (unsigned int)v14[4 * v9 + 360451].__vftable);
    v24 = (KOFShaderManager *)SHIDWORD(v14[4 * v9 + 360451].__vftable);
    *((_DWORD *)&v23[1].__vftable + (_QWORD)v24 + 1) = v14[4 * v9 + 360451].__vftable;
    *((_DWORD *)&v23[3].__vftable + (_QWORD)v24 + 1) = v9;
    v25 = &v14[11 * KOFShaderManager::findProgram(v24, this->m_Program)];
    v25[9].__vftable = (AgSingleton<KOFShaderManager>_vtbl *)commonAttrib;
    LODWORD(v25[10].__vftable) = uniformNum;
    v25[11].__vftable = (AgSingleton<KOFShaderManager>_vtbl *)uniformAttrib;
    result = 1;
    LOBYTE(v25[6].__vftable) = 0;
    v25[7].__vftable = (AgSingleton<KOFShaderManager>_vtbl *)this;
    LODWORD(v25[8].__vftable) = 7;
  }
  else
  {
    v18 = this->m_piGLAttrib.glValue;
    if ( v18 )
    {
      operator delete(v18, v17);
      this->m_piGLAttrib.glValue = 0i64;
    }
    v19 = this->m_piGLUniform;
    this->m_iGLAttribNum = 0;
    if ( v19 )
    {
      operator delete(v19, v17);
      this->m_piGLUniform = 0i64;
    }
    this->m_iGLUniformNum = 0;
    return 0;
  }
  return result;
}

unsigned __int8 __fastcall OGLShader::createShader(
        OGLShader *this,
        unsigned __int64 vertShader,
        unsigned int fragSlot,
        const char *fragFile)
{
  __int64 v5; // r15
  unsigned int m_Program; // ecx
  __int64 v7; // r12
  int *glValue; // rcx
  int *m_piGLUniform; // rcx
  AgSingleton<KOFShaderManager> *v11; // rbp
  KOFShaderManager *v12; // rcx
  unsigned int Program; // eax
  unsigned __int64 v14; // rdx
  int *v15; // rcx
  int *v16; // rcx
  AgSingleton<KOFShaderManager> *v18; // rdi
  __int64 v19; // rcx
  KOFShaderManager *v20; // rcx
  __int64 v21; // rax

  v5 = (int)fragSlot;
  m_Program = this->m_Program;
  v7 = (int)vertShader;
  if ( m_Program )
  {
    _glewDeleteProgram(m_Program);
    this->m_Program = 0;
  }
  glValue = this->m_piGLAttrib.glValue;
  if ( glValue )
  {
    operator delete(glValue, vertShader);
    this->m_piGLAttrib.glValue = 0i64;
  }
  m_piGLUniform = this->m_piGLUniform;
  this->m_iGLAttribNum = 0;
  if ( m_piGLUniform )
  {
    operator delete(m_piGLUniform, vertShader);
    this->m_piGLUniform = 0i64;
  }
  v11 = AgSingleton<KOFShaderManager>::ms_instance;
  v12 = (KOFShaderManager *)AgSingleton<KOFShaderManager>::ms_instance;
  this->m_iGLUniformNum = 0;
  this->m_fragFile = fragFile;
  Program = KOFShaderManager::createProgram(v12, &this->m_programSlot);
  this->m_Program = Program;
  if ( Program )
  {
    v18 = &v11[11 * this->m_programSlot];
    _glewAttachShader((unsigned int)v18[1].__vftable, (unsigned int)v11[4 * v7 + 360451].__vftable);
    v19 = SHIDWORD(v11[4 * v7 + 360451].__vftable);
    *((_DWORD *)&v18[1].__vftable + v19 + 1) = v11[4 * v7 + 360451].__vftable;
    *((_DWORD *)&v18[3].__vftable + v19 + 1) = v7;
    v20 = (KOFShaderManager *)(22i64 * this->m_programSlot);
    *((_DWORD *)&v11[3].__vftable + (_QWORD)v20 + SHIDWORD(v11[4 * v5 + 360451].__vftable) + 1) = v5;
    v21 = 11i64 * KOFShaderManager::findProgram(v20, this->m_Program);
    v11[v21 + 9].__vftable = (AgSingleton<KOFShaderManager>_vtbl *)commonAttrib;
    v11[v21 + 11].__vftable = (AgSingleton<KOFShaderManager>_vtbl *)commonUniform;
    LOBYTE(v11[v21 + 6].__vftable) = 0;
    v11[v21 + 7].__vftable = (AgSingleton<KOFShaderManager>_vtbl *)this;
    LODWORD(v11[v21 + 8].__vftable) = 7;
    LODWORD(v11[v21 + 10].__vftable) = 173;
    return 1;
  }
  else
  {
    v15 = this->m_piGLAttrib.glValue;
    if ( v15 )
    {
      operator delete(v15, v14);
      this->m_piGLAttrib.glValue = 0i64;
    }
    v16 = this->m_piGLUniform;
    this->m_iGLAttribNum = 0;
    if ( v16 )
    {
      operator delete(v16, v14);
      this->m_piGLUniform = 0i64;
    }
    this->m_iGLUniformNum = 0;
    return 0;
  }
}

unsigned __int8 __fastcall OGLShader::createShader(
        OGLShader *this,
        unsigned __int64 _vertShader,
        unsigned int fragSlot,
        const char *fragFile,
        bool crypt,
        int attribNum,
        const _SHADER_INFO *shaderAttrib,
        int uniformNum,
        const _SHADER_INFO *uniformAttrib,
        void *instancing)
{
  __int64 v11; // r15
  unsigned int m_Program; // ecx
  __int64 v13; // r12
  int *glValue; // rcx
  int *m_piGLUniform; // rcx
  AgSingleton<KOFShaderManager> *v17; // rbp
  KOFShaderManager *v18; // rcx
  unsigned int Program; // eax
  unsigned __int64 v20; // rdx
  int *v21; // rcx
  int *v22; // rcx
  AgSingleton<KOFShaderManager> *v24; // rdi
  __int64 v25; // rcx
  KOFShaderManager *v26; // rcx
  __int64 v27; // rax
  unsigned __int8 *v28; // rax

  v11 = (int)fragSlot;
  m_Program = this->m_Program;
  v13 = (int)_vertShader;
  if ( m_Program )
  {
    _glewDeleteProgram(m_Program);
    this->m_Program = 0;
  }
  glValue = this->m_piGLAttrib.glValue;
  if ( glValue )
  {
    operator delete(glValue, _vertShader);
    this->m_piGLAttrib.glValue = 0i64;
  }
  m_piGLUniform = this->m_piGLUniform;
  this->m_iGLAttribNum = 0;
  if ( m_piGLUniform )
  {
    operator delete(m_piGLUniform, _vertShader);
    this->m_piGLUniform = 0i64;
  }
  v17 = AgSingleton<KOFShaderManager>::ms_instance;
  v18 = (KOFShaderManager *)AgSingleton<KOFShaderManager>::ms_instance;
  this->m_iGLUniformNum = 0;
  this->m_fragFile = fragFile;
  Program = KOFShaderManager::createProgram(v18, &this->m_programSlot);
  this->m_Program = Program;
  if ( Program )
  {
    v24 = &v17[11 * this->m_programSlot];
    _glewAttachShader((unsigned int)v24[1].__vftable, (unsigned int)v17[4 * v13 + 360451].__vftable);
    v25 = SHIDWORD(v17[4 * v13 + 360451].__vftable);
    *((_DWORD *)&v24[1].__vftable + v25 + 1) = v17[4 * v13 + 360451].__vftable;
    *((_DWORD *)&v24[3].__vftable + v25 + 1) = v13;
    v26 = (KOFShaderManager *)(22i64 * this->m_programSlot);
    *((_DWORD *)&v17[3].__vftable + (_QWORD)v26 + SHIDWORD(v17[4 * v11 + 360451].__vftable) + 1) = v11;
    v27 = 11i64 * KOFShaderManager::findProgram(v26, this->m_Program);
    v17[v27 + 9].__vftable = (AgSingleton<KOFShaderManager>_vtbl *)effectAttrib;
    v17[v27 + 11].__vftable = (AgSingleton<KOFShaderManager>_vtbl *)commonUniform;
    LOBYTE(v17[v27 + 6].__vftable) = 0;
    v17[v27 + 7].__vftable = (AgSingleton<KOFShaderManager>_vtbl *)this;
    LODWORD(v17[v27 + 8].__vftable) = 15;
    LODWORD(v17[v27 + 10].__vftable) = 173;
    if ( instancing )
    {
      v28 = (unsigned __int8 *)operator new[](0xFui64);
      this->m_piGLAttrib.divisor = v28;
      *(_QWORD *)v28 = *(_QWORD *)instancing;
      *((_DWORD *)v28 + 2) = *((_DWORD *)instancing + 2);
      *((_WORD *)v28 + 6) = *((_WORD *)instancing + 6);
      v28[14] = *((_BYTE *)instancing + 14);
    }
    return 1;
  }
  else
  {
    v21 = this->m_piGLAttrib.glValue;
    if ( v21 )
    {
      operator delete(v21, v20);
      this->m_piGLAttrib.glValue = 0i64;
    }
    v22 = this->m_piGLUniform;
    this->m_iGLAttribNum = 0;
    if ( v22 )
    {
      operator delete(v22, v20);
      this->m_piGLUniform = 0i64;
    }
    this->m_iGLUniformNum = 0;
    return 0;
  }
}

unsigned __int8 __fastcall OGLShader::getAttribLocations(OGLShader *this, int num, const _SHADER_INFO *shaderAttrib)
{
  signed __int64 v4; // rsi
  int *v6; // rax
  int AttribLocation; // eax
  __int64 index; // rdx

  v4 = num;
  _glewGetProgramiv(this->m_Program, 0x8B89u, &this->m_iGLAttribNum);
  if ( !(_DWORD)v4 )
  {
LABEL_5:
    LOBYTE(v6) = 1;
    return (unsigned __int8)v6;
  }
  v6 = (int *)operator new[](saturated_mul(v4, 4ui64));
  this->m_piGLAttrib.glValue = v6;
  if ( v6 )
  {
    if ( v4 > 0 )
    {
      do
      {
        AttribLocation = _glewGetAttribLocation(this->m_Program, shaderAttrib->name);
        index = shaderAttrib->index;
        ++shaderAttrib;
        this->m_piGLAttrib.glValue[index] = AttribLocation;
        --v4;
      }
      while ( v4 );
    }
    goto LABEL_5;
  }
  return (unsigned __int8)v6;
}

unsigned __int8 __fastcall OGLShader::getUniformLocations(OGLShader *this, int num, const _SHADER_INFO *shaderUniform)
{
  unsigned __int64 v4; // rdi
  int *v6; // rax
  int *m_piGLUniform; // rcx
  int i; // eax
  __int64 index; // rdx
  int Program; // eax

  v4 = num;
  _glewGetProgramiv(this->m_Program, 0x8B86u, &this->m_iGLUniformNum);
  if ( !(_DWORD)v4 )
  {
LABEL_6:
    LOBYTE(v6) = 1;
    return (unsigned __int8)v6;
  }
  v6 = (int *)operator new[](saturated_mul(v4, 4ui64));
  this->m_piGLUniform = v6;
  if ( v6 )
  {
    for ( i = 0; i < (int)v4; ++i )
    {
      index = shaderUniform->index;
      ++shaderUniform;
      m_piGLUniform = this->m_piGLUniform;
      m_piGLUniform[index] = i;
    }
    Program = KOFShaderManager::findProgram((KOFShaderManager *)m_piGLUniform, this->m_Program);
    KOFShaderManager::setProgramUniformsSlot(
      (KOFShaderManager *)AgSingleton<KOFShaderManager>::ms_instance,
      Program,
      v4);
    goto LABEL_6;
  }
  return (unsigned __int8)v6;
}

int fprintf(_iobuf *const _Stream, const char *const _Format, ...)
{
  unsigned __int64 *v4; // rax
  va_list va; // [rsp+60h] [rbp+18h] BYREF

  va_start(va, _Format);
  v4 = _local_stdio_printf_options();
  return _stdio_common_vfprintf(*v4, _Stream, _Format, 0i64, va);
}

