#include "program files (x86)/microsoft visual studio 14.0/vc/include/xmemory"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/thr/xthread"
#include "dev/kof/master/development/source/baseproject/jni/framework/memory/globalheapmemory.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/memory/fixmemory.h"
#include "dev/silverware/git/sdk/input/agsdlmappingparser.h"
#include "dev/kof/master/development/source/ps4project/toolkit/geommath/matrix4unaligned.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/scalar_cpp/quat_aos.h"
#include "dev/silverware/git/sdk/platforms/pc/system/agpcsysteminfo.h"
#include "dev/silverware/git/sdk/agreferencecountinl.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_refcount.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_memory.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_memoryheap.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_stats.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_timer.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/internal/internal_sse.h"
#include "dev/silverware/git/sdk/3rdparty/steam/steamclientpublic.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/internal/internal_types.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xatomic0.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/memory/variableheapmemorybase.h"
#include "dev/kof/master/development/source/ps4project/toolkit/geommath/vector2unaligned.h"
#include "dev/silverware/git/sdk/agmemorystream.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_sysalloc.h"
#include "dev/silverware/git/sdk/agmemorypool.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/internal/internal_functions.h"
#include "dev/silverware/git/sdk/input/agcontrollerbuttoncomponent.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_threads.h"
#include "dev/silverware/git/sdk/agpointerinl.h"
#include "dev/silverware/git/sdk/agstream.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/stdio.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_types.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/network/matchingsystem.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/memory/physicalheapmemory.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wstdio.h"
#include "dev/silverware/git/sdk/agsemaphore.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_stdio_config.h"
#include "dev/silverware/git/sdk/agsemaphore.inl"
#include "dev/silverware/git/sdk/agconditionvariable.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/condition_variable"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/deque"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/sys/stat.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_allocinfo.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/scalar_cpp/boolinvec.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/time.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xtgmath.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xtr1common"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wstring.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/thread/jobmanager.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/stdlib.h"
#include "program files (x86)/windows kits/8.1/include/shared/guiddef.h"
#include "dev/kof/master/development/source/ps4project/toolkit/geommath/vector3unaligned.h"
#include "program files (x86)/windows kits/8.1/include/shared/stralign.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vcruntime_typeinfo.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/util/resourcemanager.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xfacet"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xutility"
#include "dev/silverware/git/sdk/3rdparty/steam/isteamhtmlsurface.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/vec_aos.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/list"
#include "dev/kof/master/development/source/baseproject/jni/framework/network/titlestoragesystem.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/boolinvec.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/string.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_memory.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_memcpy_s.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/scalar_cpp/vectormath_aos.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/wchar.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wconio.h"
#include "program files (x86)/windows kits/8.1/include/um/winnt.h"
#include "dev/silverware/git/sdk/agreferencedobjectinl.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/functional"
#include "dev/silverware/git/sdk/agpointer.h"
#include "program files (x86)/windows kits/8.1/include/shared/basetsd.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xstring"
#include "dev/silverware/git/sdk/agreferencedobject.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xmemory0"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wtime.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/heapmh/heapmh_sysallocmalloc.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/malloc.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/exception"
#include "dev/silverware/git/sdk/agconditionvariable.inl"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vcruntime_exception.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/scalar_cpp/mat_aos.h"
#include "dev/silverware/git/sdk/agthread.h"
#include "dev/silverware/git/sdk/agmutex.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/array"
#include "dev/silverware/git/sdk/agscopedlock.h"
#include "dev/silverware/git/sdk/3rdparty/steam/steam_api_internal.h"
#include "dev/kof/master/development/source/ps4project/baseproject/pcutil/pccontrolsmanager.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/algorithm"
#include "dev/silverware/git/sdk/input/aginputmanager.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/system_error"
#include "dev/silverware/git/sdk/agsingleton.h"
#include "dev/kof/master/development/source/ps4project/toolkit/geommath/vector4unaligned.h"
#include "dev/silverware/git/sdk/agmutex.inl"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/stdexcept"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/utility"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/vecidx_aos.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/iosfwd"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/map"
#include "program files (x86)/windows kits/8.1/include/um/winuser.h"
#include "dev/silverware/git/sdk/memory/agallocators.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/floatinvec.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xtree"
#include "dev/silverware/git/sdk/input/agcontrollercomponent.h"
#include "dev/silverware/git/sdk/3rdparty/steam/steam_api.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/tuple"
#include "dev/kof/master/development/source/ps4project/baseproject/pcutil/pcdummy.h"
#include "dev/silverware/git/sdk/util/agdelegate.h"
#include "dev/silverware/git/sdk/agreferencecount.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vcruntime_new.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/quat_aos.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/scalar_cpp/floatinvec.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vadefs.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xstddef"
#include "dev/silverware/git/sdk/agvector2.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/type_traits"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/internal/internal_vec64.h"
#include "dev/silverware/git/sdk/agmath.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_array.h"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_allocator.h"
#include "dev/silverware/git/sdk/input/agcontroller.h"
#include "dev/silverware/git/sdk/system/aguser.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/cmath"
#include "dev/kof/master/development/source/middleware/autodesk/scaleform/gfx_sdk/src/kernel/sf_atomic.h"
#include "dev/silverware/git/sdk/agstring.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/math.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/internal/internal_math.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/mutex"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/string"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/chrono"
#include "dev/kof/master/development/source/baseproject/jni/framework/libcommon.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/scalar_cpp/vec_aos.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/limits"
#include "dev/silverware/git/sdk/3rdparty/steam/matchmakingtypes.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/ios"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xlocnum"
#include "dev/silverware/git/sdk/system/agsysteminfo.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xiosbase"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xlocale"
#include "program files (x86)/windows kits/8.1/include/um/winbase.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/xlocinfo"
#include "dev/kof/master/development/source/baseproject/jni/framework/ag/3rdparty/vectormath/cpp/mat_aos.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/debug/logging.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/vector"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/ctype.h"
#include "program files (x86)/windows kits/10/include/10.0.10240.0/ucrt/corecrt_wio.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/memory/heapmemory.h"
#include "dev/kof/master/development/source/baseproject/jni/framework/thread/mutex.h"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/thread"
#include "program files (x86)/microsoft visual studio 14.0/vc/include/memory"
#include "dev/kof/master/development/source/baseproject/jni/framework/network/tusreadps4.cpp"
#include "dev/kof/master/development/source/baseproject/jni/framework/network/tuswriteworkpc.cpp"
#include "dev/kof/master/development/source/baseproject/jni/framework/network/tuswriteps4.cpp"
#include "dev/kof/master/development/source/baseproject/jni/framework/network/tusreadworkpc.cpp"

std::piecewise_construct_t std::piecewise_construct; // 0x140889499
void Fw::TitleStorageTarget::Update(); // 0x14004F3F0
Fw::TS_RESULT Fw::TitleStorageTarget::GetResult(Fw::TS_HANDLE handle); // 0x14004F480
Fw::TS_RESULT Fw::TitleStorageTarget::GetTusResult(Fw::cTusResult * & rResultPtr, Fw::TS_HANDLE handle); // 0x14004F520
Fw::TS_RESULT Fw::TitleStorageTarget::ReleaseHandle(Fw::TS_HANDLE handle); // 0x14004F610//decompilation failure at 140889499!
__int64 __fastcall Fw::TitleStorageTarget::GetResult(Fw::TS_HANDLE handle)
{
  unsigned int v3; // ecx
  int v4; // er8
  Fw::cTusWriteWork *v5; // rax
  Fw::cTusWriteWork *v6; // rdx
  Fw::cTusReadWork *v7; // rax

  if ( (handle & 0xFF000000) != 0x1000000 )
  {
    if ( (handle & 0xFF000000) != 0x2000000 )
      return 4i64;
    if ( handle )
    {
      v3 = 0;
      v4 = 0;
      v5 = Fw::TusWrite::m_pWork;
      while ( v5->m_WorkHandle != handle )
      {
        ++v4;
        if ( (__int64)++v5 >= (__int64)&Fw::VoiceChat::m_bufferWritten )
          return 4;
      }
      v6 = &Fw::TusWrite::m_pWork[v4];
      if ( v6 )
      {
        if ( v6->m_Rno == RNO_NONE )
          return (unsigned int)v6->m_Result;
        return v3;
      }
    }
    return 4;
  }
  if ( handle == TS_HANDLE_INVALID )
    return 4;
  v7 = Fw::TusRead::m_pWorkFirst;
  if ( !Fw::TusRead::m_pWorkFirst )
    return 4;
  while ( v7->m_WorkHandle != handle )
  {
    v7 = v7->m_pNext;
    if ( !v7 )
      return 4i64;
  }
  if ( v7->m_Rno )
    return 0i64;
  else
    return (unsigned int)v7->m_Result;
}

__int64 __fastcall Fw::TitleStorageTarget::GetTusResult(Fw::cTusResult **rResultPtr, Fw::TS_HANDLE handle)
{
  int v2; // ecx
  Fw::cTusWriteWork *v3; // rax
  __int64 result; // rax
  Fw::cTusReadWork *v5; // rbx

  if ( (handle & 0xFF000000) == 0x1000000 )
  {
    if ( handle && (v5 = Fw::TusRead::m_pWorkFirst) != 0i64 )
    {
      while ( v5->m_WorkHandle != handle )
      {
        v5 = v5->m_pNext;
        if ( !v5 )
          return 4i64;
      }
      if ( Fw::cTusReadWork::getReadResultAlloc(v5, rResultPtr) )
      {
        return 1i64;
      }
      else if ( v5->m_Rno || v5->m_Result != TS_RESULT_CANCEL )
      {
        return 3i64;
      }
      else
      {
        return 2i64;
      }
    }
    else
    {
      return 4i64;
    }
  }
  else
  {
    if ( (handle & 0xFF000000) != 0x2000000 || handle == TS_HANDLE_INVALID )
      return 4i64;
    v2 = 0;
    v3 = Fw::TusWrite::m_pWork;
    while ( v3->m_WorkHandle != handle )
    {
      ++v2;
      if ( (__int64)++v3 >= (__int64)&Fw::VoiceChat::m_bufferWritten )
        return 4i64;
    }
    result = 1i64;
    if ( !&Fw::TusWrite::m_pWork[v2] )
      return 4i64;
  }
  return result;
}

__int64 __fastcall Fw::TitleStorageTarget::ReleaseHandle(Fw::TS_HANDLE handle)
{
  unsigned __int32 v2; // ecx
  int v3; // edx
  Fw::cTusWriteWork *v4; // rcx
  Fw::cTusWriteWork *v6; // rcx
  Fw::cTusReadWork *v7; // rcx

  v2 = handle & 0xFF000000;
  if ( v2 == 0x1000000 )
  {
    if ( handle )
    {
      v7 = Fw::TusRead::m_pWorkFirst;
      if ( Fw::TusRead::m_pWorkFirst )
      {
        while ( v7->m_WorkHandle != handle )
        {
          v7 = v7->m_pNext;
          if ( !v7 )
            return 4i64;
        }
        Fw::TusRead::ReleaseWork(v7);
        return 1i64;
      }
    }
    return 4i64;
  }
  if ( v2 != 0x2000000 || handle == TS_HANDLE_INVALID )
    return 4i64;
  v3 = 0;
  v4 = Fw::TusWrite::m_pWork;
  while ( v4->m_WorkHandle != handle )
  {
    ++v3;
    if ( (__int64)++v4 >= (__int64)&Fw::VoiceChat::m_bufferWritten )
      return 4i64;
  }
  v6 = &Fw::TusWrite::m_pWork[v3];
  if ( !v6 )
    return 4i64;
  if ( v6->m_Rno == RNO_NONE )
  {
    *(_QWORD *)&v6->m_WorkHandle = 0i64;
    return 1i64;
  }
  return 1i64;
}

void __fastcall Fw::TitleStorageTarget::Update(__int64 a1, Scaleform::Render::RenderTargetData *a2)
{
  Fw::cTusReadWork *i; // rbx
  Fw::cTusWriteWork::RNO *p_m_Rno; // rbx

  for ( i = Fw::TusRead::m_pWorkFirst; i; i = i->m_pNext )
  {
    while ( ((bool (__fastcall *)(Scaleform::Render::Texture *, Scaleform::Render::RenderTargetData *))Fw::cTusReadWork::m_pUpdateFunc[i->m_Rno])(
              (Scaleform::Render::Texture *)i,
              a2) )
      ;
  }
  p_m_Rno = &Fw::TusWrite::m_pWork[0].m_Rno;
  do
  {
    if ( *p_m_Rno )
    {
      while ( ((bool (__fastcall *)(Scaleform::Render::Texture *, Scaleform::Render::RenderTargetData *))Fw::cTusWriteWork::m_pUpdateFunc[*(int *)p_m_Rno])(
                (Scaleform::Render::Texture *)(p_m_Rno - 1),
                a2) )
        ;
    }
    p_m_Rno += 14;
  }
  while ( (__int64)p_m_Rno < (__int64)&Fw::VoiceChat::m_bMutedSpeakers );
}

